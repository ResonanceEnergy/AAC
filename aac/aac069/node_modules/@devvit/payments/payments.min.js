var Bh=Object.create;var qc=Object.defineProperty;var Uh=Object.getOwnPropertyDescriptor;var Oh=Object.getOwnPropertyNames;var Lh=Object.getPrototypeOf,Wh=Object.prototype.hasOwnProperty;var Jc=r=>{throw TypeError(r)};var vr=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Hh=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Oh(e))!Wh.call(r,s)&&s!==t&&qc(r,s,{get:()=>e[s],enumerable:!(i=Uh(e,s))||i.enumerable});return r};var Zc=(r,e,t)=>(t=r!=null?Bh(Lh(r)):{},Hh(e||!r||!r.__esModule?qc(t,"default",{value:r,enumerable:!0}):t,r));var Qc=(r,e,t)=>e.has(r)||Jc("Cannot "+t);var ht=(r,e,t)=>(Qc(r,e,"read from private field"),t?t.call(r):e.get(r)),ri=(r,e,t)=>e.has(r)?Jc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),js=(r,e,t,i)=>(Qc(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);var Ya=vr((Jb,yl)=>{var gm=Object.prototype.toString;yl.exports=function(e){if(e===void 0)return"undefined";if(e===null)return"null";var t=typeof e;if(t==="boolean")return"boolean";if(t==="string")return"string";if(t==="number")return"number";if(t==="symbol")return"symbol";if(t==="function")return km(e)?"generatorfunction":"function";if(wm(e))return"array";if(Cm(e))return"buffer";if(Em(e))return"arguments";if(bm(e))return"date";if(ym(e))return"error";if(vm(e))return"regexp";switch(wl(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(_m(e))return"generator";switch(t=gm.call(e),t){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")};function wl(r){return typeof r.constructor=="function"?r.constructor.name:null}function wm(r){return Array.isArray?Array.isArray(r):r instanceof Array}function ym(r){return r instanceof Error||typeof r.message=="string"&&r.constructor&&typeof r.constructor.stackTraceLimit=="number"}function bm(r){return r instanceof Date?!0:typeof r.toDateString=="function"&&typeof r.getDate=="function"&&typeof r.setDate=="function"}function vm(r){return r instanceof RegExp?!0:typeof r.flags=="string"&&typeof r.ignoreCase=="boolean"&&typeof r.multiline=="boolean"&&typeof r.global=="boolean"}function km(r,e){return wl(r)==="GeneratorFunction"}function _m(r){return typeof r.throw=="function"&&typeof r.return=="function"&&typeof r.next=="function"}function Em(r){try{if(typeof r.length=="number"&&typeof r.callee=="function")return!0}catch(e){if(e.message.indexOf("callee")!==-1)return!0}return!1}function Cm(r){return r.constructor&&typeof r.constructor.isBuffer=="function"?r.constructor.isBuffer(r):!1}});var kl=vr((Zb,vl)=>{"use strict";var bl=Symbol.prototype.valueOf,Fm=Ya();function Am(r,e){switch(Fm(r)){case"array":return r.slice();case"object":return Object.assign({},r);case"date":return new r.constructor(Number(r));case"map":return new Map(r);case"set":return new Set(r);case"buffer":return Sm(r);case"symbol":return xm(r);case"arraybuffer":return Im(r);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return Tm(r);case"regexp":return Pm(r);case"error":return Object.create(r);default:return r}}function Pm(r){let e=r.flags!==void 0?r.flags:/\w+$/.exec(r)||void 0,t=new r.constructor(r.source,e);return t.lastIndex=r.lastIndex,t}function Im(r){let e=new r.constructor(r.byteLength);return new Uint8Array(e).set(new Uint8Array(r)),e}function Tm(r,e){return new r.constructor(r.buffer,r.byteOffset,r.length)}function Sm(r){let e=r.length,t=Buffer.allocUnsafe?Buffer.allocUnsafe(e):Buffer.from(e);return r.copy(t),t}function xm(r){return bl?Object(bl.call(r)):{}}vl.exports=Am});var El=vr((Qb,_l)=>{"use strict";_l.exports=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1}});var Al=vr((Xb,Fl)=>{"use strict";var Rm=El();function Cl(r){return Rm(r)===!0&&Object.prototype.toString.call(r)==="[object Object]"}Fl.exports=function(e){var t,i;return!(Cl(e)===!1||(t=e.constructor,typeof t!="function")||(i=t.prototype,Cl(i)===!1)||i.hasOwnProperty("isPrototypeOf")===!1)}});var Il=vr((Yb,Pl)=>{"use strict";var Mm=kl(),Nm=Ya(),Dm=Al();function ec(r,e){switch(Nm(r)){case"object":return Bm(r,e);case"array":return Um(r,e);default:return Mm(r)}}function Bm(r,e){if(typeof e=="function")return e(r);if(e||Dm(r)){let t=new r.constructor;for(let i in r)t[i]=ec(r[i],e);return t}return r}function Um(r,e){let t=new r.constructor(r.length);for(let i=0;i<r.length;i++)t[i]=ec(r[i],e);return t}Pl.exports=ec});var vh=vr(Kn=>{"use strict";Kn.byteLength=hp;Kn.toByteArray=mp;Kn.fromByteArray=wp;var et=[],He=[],up=typeof Uint8Array<"u"?Uint8Array:Array,Uc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(sr=0,yh=Uc.length;sr<yh;++sr)et[sr]=Uc[sr],He[Uc.charCodeAt(sr)]=sr;var sr,yh;He[45]=62;He[95]=63;function bh(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function hp(r){var e=bh(r),t=e[0],i=e[1];return(t+i)*3/4-i}function fp(r,e,t){return(e+t)*3/4-t}function mp(r){var e,t=bh(r),i=t[0],s=t[1],n=new up(fp(r,i,s)),o=0,c=s>0?i-4:i,l;for(l=0;l<c;l+=4)e=He[r.charCodeAt(l)]<<18|He[r.charCodeAt(l+1)]<<12|He[r.charCodeAt(l+2)]<<6|He[r.charCodeAt(l+3)],n[o++]=e>>16&255,n[o++]=e>>8&255,n[o++]=e&255;return s===2&&(e=He[r.charCodeAt(l)]<<2|He[r.charCodeAt(l+1)]>>4,n[o++]=e&255),s===1&&(e=He[r.charCodeAt(l)]<<10|He[r.charCodeAt(l+1)]<<4|He[r.charCodeAt(l+2)]>>2,n[o++]=e>>8&255,n[o++]=e&255),n}function pp(r){return et[r>>18&63]+et[r>>12&63]+et[r>>6&63]+et[r&63]}function gp(r,e,t){for(var i,s=[],n=e;n<t;n+=3)i=(r[n]<<16&16711680)+(r[n+1]<<8&65280)+(r[n+2]&255),s.push(pp(i));return s.join("")}function wp(r){for(var e,t=r.length,i=t%3,s=[],n=16383,o=0,c=t-i;o<c;o+=n)s.push(gp(r,o,o+n>c?c:o+n));return i===1?(e=r[t-1],s.push(et[e>>2]+et[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],s.push(et[e>>10]+et[e>>4&63]+et[e<<2&63]+"=")),s.join("")}});import{OrderResultStatus as Xc}from"@devvit/protos/types/devvit/ui/effect_types/v1alpha/create_order.js";var Yc=(i=>(i[i.Cancelled=0]="Cancelled",i[i.Success=1]="Success",i[i.Error=2]="Error",i))(Yc||{});function ed(r){switch(r){case Xc.STATUS_SUCCESS:return 1;case Xc.STATUS_ERROR:return 2;default:return 0}}var pe={APP:0,USER:1,UNSPECIFIED:2};import{Scope as Cp}from"@devvit/protos/json/reddit/devvit/app_permission/v1/app_permission.js";function u(r,e){if(r==null)throw Error(e??"Expected nonnullish value.")}import*as _ from"@devvit/protos";import{Scope as Ii}from"@devvit/protos/json/reddit/devvit/app_permission/v1/app_permission.js";var Gs=class{constructor(e){}};var jh=/\.[a-zA-Z]{2,}$/;function td(r){if(r.length>25)throw new Error("The size of requestedFetchDomains is limited to 25 domains.")}function rd(r){let e=new Set;for(let t of r)try{if(!jh.test(t))throw new Error("The domain does not have a valid top-level domain.");t.includes("://")||(t="http://"+t);let s=new URL(t).hostname.replace(/^www\./,"");e.add(s)}catch(i){throw new Error(`Failed to determine hostname from requested domain: '${t}'. ${i}`)}return Array.from(e)}import"@devvit/protos/json/devvit/events/v1alpha/events.js";import{DeletionReason as ug,EventSource as hg}from"@devvit/protos/json/devvit/events/v1alpha/events.js";import{CrowdControlLevel as mg,DistinguishType as pg}from"@devvit/protos/json/devvit/reddit/v2alpha/postv2.js";import{SubredditRating as wg,SubredditType as yg}from"@devvit/protos/json/devvit/reddit/v2alpha/subredditv2.js";var ft;(function(r){r.Installation="installation",r.App="app"})(ft||(ft={}));function mt(r,e){if(!r)throw Error(e)}var id;(function(r){r.COMMENT="t1_",r.ACCOUNT="t2_",r.LINK="t3_",r.MESSAGE="t4_",r.SUBREDDIT="t5_",r.AWARD="t6_"})(id||(id={}));function Mt(r,e=new Set){for(let t of r){if(t.type==="group"){Mt(t.fields,e);continue}let i=t.name;if(e.has(i))throw new Error(`Duplicate field name: ${i}`);e.add(i)}Gh(r)}function Gh(r){for(let e of r)if(e.type==="string"&&e.isSecret&&e.scope!==ft.App)throw`Invalid setting: only app settings can be secrets. Add "scope: SettingScope.App" to field "${e.name}"`}var pt=Object.freeze({INTERVAL:0,FORM:1,STATE:2,CHANNEL:3,WEB_VIEW:4});import{DeletionReason as Wg,EventSource as Hg}from"@devvit/protos";import{AppSettingsDefinition as Ef,GetFieldsResponse as Cf}from"@devvit/protos";import{FormFieldType as Be}from"@devvit/protos";function it(r){return r.map(e=>{switch(e.type){case"string":return Vh(e);case"image":return $h(e);case"paragraph":return zh(e);case"number":return Kh(e);case"select":return qh(e);case"boolean":return Jh(e);case"group":return Zh(e);default:throw new Error("Unknown field type.")}})}function Vh(r){return{defaultValue:{fieldType:Be.STRING,stringValue:r.defaultValue},disabled:r.disabled,fieldConfig:{stringConfig:{placeholder:r.placeholder}},fieldId:r.name,fieldType:Be.STRING,helpText:r.helpText,label:r.label,required:r.required,isSecret:r.isSecret}}function $h(r){return{disabled:r.disabled,fieldId:r.name,fieldType:Be.IMAGE,helpText:r.helpText,label:r.label,required:r.required}}function zh(r){return{defaultValue:{fieldType:Be.PARAGRAPH,stringValue:r.defaultValue},disabled:r.disabled,fieldConfig:{paragraphConfig:{lineHeight:r.lineHeight,placeholder:r.placeholder}},fieldId:r.name,fieldType:Be.PARAGRAPH,helpText:r.helpText,label:r.label,required:r.required}}function Kh(r){return{defaultValue:{fieldType:Be.NUMBER,numberValue:r.defaultValue},disabled:r.disabled,fieldConfig:{numberConfig:{}},fieldId:r.name,fieldType:Be.NUMBER,helpText:r.helpText,label:r.label,required:r.required}}function qh(r){return{defaultValue:{fieldType:Be.SELECTION,selectionValue:{values:r.defaultValue??[]}},disabled:r.disabled,fieldConfig:{selectionConfig:{choices:r.options,multiSelect:r.multiSelect}},fieldId:r.name,fieldType:Be.SELECTION,helpText:r.helpText,label:r.label,required:r.required}}function Jh(r){return{defaultValue:{fieldType:Be.BOOLEAN,boolValue:r.defaultValue},disabled:r.disabled,fieldId:r.name,fieldType:Be.BOOLEAN,helpText:r.helpText,label:r.label}}function Zh(r){return{fieldId:"",fieldType:Be.GROUP,fieldConfig:{groupConfig:{fields:it(r.fields)}},label:r.label,helpText:r.helpText}}function O(r,e){a.prototype[r]=e}import{ValidateFormResponse as _f}from"@devvit/protos";import{RealtimeSubscriptionStatus as nd}from"@devvit/protos";var A=Object.freeze({Actor:"devvit-actor",App:"devvit-app",AppDependencies:"devvit-app-dependencies",AppUser:"devvit-app-user",AppViewerAuthToken:"devvit-app-viewer-authorization",Canary:"devvit-canary",Context:"devvit-context",Debug:"devvit-debug",GQLHost:"devvit-gql-host",Installation:"devvit-installation",ModPermissions:"devvit-mod-permissions",Post:"devvit-post",PostAuthor:"devvit-post-author",PostData:"devvit-post-data",R2Auth:"devvit-sec-authorization",R2Host:"devvit-r2-host",RemoteHostname:"devvit-remote-hostname",SettingsUri:"devvit-sec-settings-uri",StreamID:"devvit-stream-id",Subreddit:"devvit-subreddit",SubredditName:"devvit-subreddit-name",TraceID:"devvit-trace-id",User:"devvit-user",Username:"devvit-user-name",UserSnoovatarUrl:"devvit-user-snoovatar-url",UserAgent:"devvit-user-agent",Version:"devvit-version",Language:"devvit-accept-language",Timezone:"devvit-accept-timezone",Traceparent:"traceparent"});var sd;(function(r){r.Blocks="blocks",r.EmitSnapshots="emitSnapshots",r.EmitState="emitState",r.Realtime="realtime",r.Runtime="runtime",r.Surface="surface",r.UseAsync="useAsync",r.Payments="payments",r.Bootstrap="bootstrap",r.WebView="webView"})(sd||(sd={}));var Ie;(function(r){r[r.Unknown=0]="Unknown",r[r.Connecting=1]="Connecting",r[r.Connected=2]="Connected",r[r.Disconnecting=3]="Disconnecting",r[r.Disconnected=4]="Disconnected"})(Ie||(Ie={}));function od(r){function e(t){let s=r.currentHookIndex,n=r.getCurrentComponentState(),o=r.getPreviousComponentState(),c=r.metadata[A.App]?.values[0];u(c,"useChannel - app is missing from Context");let l=r.metadata[A.Installation]?.values[0];u(l,"useChannel - installation is missing from Context");async function f(te){let G=n[s].channel;if(n[s].active)if(n[s].connected)await r.realtime.send(G,te);else throw Error(`Failed to send to channel '${G}'; it is active but not yet connected`);else throw Error(`Cannot send a message over inactive channel: ${G}`)}function v(){if(!n[s].active){let te=n[s].channel;n[s].active=!0,r.addRealtimeChannel(te)}}function y(){if(n[s].active){let te=n[s].channel;n[s].active=!1,r.removeRealtimeChannel(te)}}function P(te){return async()=>{let G;switch(te.status){case nd.REALTIME_SUBSCRIBED:n[s].connected=!0,G=t.onSubscribed?.();break;case nd.REALTIME_UNSUBSCRIBED:n[s].connected=!1,G=t.onUnsubscribed?.();break;default:G=t.onMessage(te.event?.data?.msg);break}await G}}let T={channel:`${c}:${l}:${t.name}`,active:!1,connected:!1,preventCallback:!1,type:pt.CHANNEL};s in n?T=n[s]:s in o&&(T=o[s]);let ee=r.realtimeEvent;r.isInitialRender?T.active=!1:ee&&T.active&&ee.event.channel===T.channel&&(T.preventCallback||r.runHook(P(ee)),r.rerenderIn(0)),n[s]=T,r.currentHookIndex++;let B=Ie.Unknown;return T.active&&T.connected?B=Ie.Connected:T.active&&!T.connected?B=Ie.Connecting:!T.active&&T.connected?B=Ie.Disconnecting:!T.active&&!T.connected&&(B=Ie.Disconnected),{subscribe:v,unsubscribe:y,send:f,status:B}}return e}import{FormFieldType as kr}from"@devvit/protos";function Fa(r){switch(r.fieldType){case kr.STRING:return r.stringValue;case kr.IMAGE:return r.stringValue;case kr.PARAGRAPH:return r.stringValue;case kr.NUMBER:return r.numberValue;case kr.BOOLEAN:return r.boolValue;case kr.SELECTION:return r.selectionValue?.values??[];default:return}}function gt(r){return Object.keys(r).reduce((e,t)=>{let i=Fa(r[t]);return i!==void 0&&(e[t]=i),e},{})}function ad(r){function e(t,i){let s=r.currentHookIndex,n=r.getCurrentComponentKey(),o=r.getCurrentComponentState(),c=r.getPreviousComponentState(),l=`form.hook.${n}.${s}`,f={formKey:l,preventSubmit:!1,type:pt.FORM};s in o?f=o[s]:s in c&&(f=c[s]),o[s]=f,r.forms.set(l,t);let v=r.formSubmittedEvent;return v&&!f.preventSubmit&&v.formId===l&&r.runHook(async()=>{let y=i(gt(v.results));y&&y instanceof Promise&&await y,r.rerenderIn(0)}),o[s].preventSubmit=!1,r.currentHookIndex++,l}return e}function cd(r){function e(t,i){let s=r.currentHookIndex,n=r.getCurrentComponentState(),o=r.getPreviousComponentState(),c=100,l=Math.max(c,i),f={lastRun:void 0,running:!1,preventCallback:!1,type:pt.INTERVAL};s in n?f=n[s]:s in o&&(f=o[s]);function v(){i<c&&console.error(`useInterval delay must be at least ${c}ms. Your interval of ${i}ms was automatically extended.`);for(let[P,T]of Object.entries(n))if(P!==s.toString()&&T?.type===pt.INTERVAL&&T?.running)throw new Error("Only one useInterval hook may be running at a time");n[s]={running:!0,lastRun:n[s]?.lastRun??Date.now(),preventCallback:!1,type:pt.INTERVAL},r.rerenderIn(l)}function y(){n[s].running=!1,n[s].lastRun=void 0,n[s].preventCallback=!1}return r.isEffectRender&&f.running&&(f.preventCallback||(f.lastRun===void 0||f.lastRun+l<Date.now())&&r.runHook(async()=>{let P=t();P&&P instanceof Promise&&await P,f.lastRun=Date.now()}),r.rerenderIn(l)),f.preventCallback=!1,n[s]=f,r.currentHookIndex++,{start:v,stop:y}}return e}function dd(r){function e(t){let i=r.currentHookIndex,s=r.getCurrentComponentState(),n=r.getPreviousComponentState();if(i in s)return r.currentHookIndex++,[s[i],o];if(r.isInitialRender||!(i in n)){let c=t instanceof Function?t():t;if(c instanceof Promise)throw(async()=>{s[i]=await c,r.currentHookIndex=0})();s[i]=c}else s[i]=n[i];function o(c){if(r.isRendering)throw new Error("Cannot call setState while rendering.");s[i]=c instanceof Function?c(s[i]):c}return r.currentHookIndex++,[s[i],o]}return e}var Vs=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},$=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Ue,Nt,Dt,Ve,ii,yd,bd,ld,ud,hd,fd,Pa,vd,Ia={now(){return new Date}};function md(r){return`__autocache__${r}`}function pd(r){return`__lock__${r}`}var Qh=300,Xh=1e3,$s=5e3,Aa=3,gd=.1,wd=1e3,Yh=3e4;function kd(r){if(r.error)throw new Error(r.error);return r.value}var zs=class{constructor(e,t,i=Ia){Ue.add(this),Nt.set(this,void 0),Dt.set(this,{}),Ve.set(this,void 0),ii.set(this,void 0),Vs(this,Nt,e,"f"),Vs(this,ii,t,"f"),Vs(this,Ve,i,"f")}async cache(e,t){Vs(this,Dt,$(this,ii,"f").__cache=$(this,ii,"f").__cache??{},"f"),$(this,Ue,"m",vd).call(this,t);let i=$(this,Ue,"m",yd).call(this,t.key);if(i!==void 0)return i;let s=await $(this,Ue,"m",Pa).call(this,t.key),n=await $(this,Ue,"m",bd).call(this,t,s,e);return kd(n)}};Nt=new WeakMap,Dt=new WeakMap,Ve=new WeakMap,ii=new WeakMap,Ue=new WeakSet,yd=function(e){let t=$(this,Dt,"f")[e];if(t){let i=$(this,Ve,"f").now().getTime(),s=t?.error&&t?.errorTime&&t.errorCount<Aa&&Math.random()<gd&&t.errorTime+wd<i;if(t?.expires&&t.expires<i&&t.checkedAt+wd<i||s){delete $(this,Dt,"f")[e];return}else return kd(t)}},bd=async function(e,t,i){let s=t?.expires,n=s?$(this,Ue,"m",fd).call(this,s):1;return!t||t?.error&&t.errorCount<Aa&&gd>Math.random()||n>Math.random()?$(this,Ue,"m",ld).call(this,e,t,i):t},ld=async function(e,t,i){let s=pd(e.key),n=$(this,Ve,"f").now().getTime(),o=new Date(n+e.ttl/2);if(await $(this,Nt,"f").set(s,"1",{expiration:o,nx:!0}))return $(this,Ue,"m",hd).call(this,e.key,t,i,e.ttl);if(t)return t;{let l=$(this,Ve,"f").now();return $(this,Ue,"m",ud).call(this,l,e.key,e.ttl)}},ud=async function r(e,t,i){let s=Math.min(i,Xh),n=await $(this,Ue,"m",Pa).call(this,t);if(n)return n;if($(this,Ve,"f").now().getTime()-e.getTime()>=s)throw new Error(`Cache request timed out trying to get data at key: ${t}`);return await new Promise(o=>setTimeout(o,Qh)),$(this,Ue,"m",r).call(this,e,t,i)},hd=async function(e,t,i,s){let n=$(this,Ve,"f").now().getTime()+s;t=t??{value:null,expires:n,errorCount:0,error:null,errorTime:null,checkedAt:0};try{t.value=await i(),t.error=null,t.errorCount=0,t.errorTime=null}catch(o){t.value=null,t.error=o.message??"Unknown error",t.errorTime=$(this,Ve,"f").now().getTime(),t.errorCount++}return $(this,Dt,"f")[e]=t,await $(this,Nt,"f").set(md(e),JSON.stringify(t),{expiration:new Date(n+Yh)}),t.error&&t.errorCount<Aa&&await $(this,Nt,"f").del(pd(e)),t},fd=function(e){let t=$(this,Ve,"f").now().getTime(),i=e-t;return i<0?1:i<1e3?.1:i<2e3?.01:i<3e3?.001:0},Pa=async function(e){let t=await $(this,Nt,"f").get(md(e));if(t){let i=JSON.parse(t);return i.checkedAt=$(this,Ve,"f").now().getTime(),$(this,Dt,"f")[e]=i,i}},vd=function(e){e.ttl<$s&&(console.warn(`Cache TTL cannot be less than ${$s} milliseconds! Updating ttl value of ${e.ttl} to ${$s}.`),e.ttl=$s)};function _d(r,e,t=Ia){let i=new zs(r,e,t);return i.cache.bind(i)}var ef=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},qs=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Ks,si,Cd,Fd;function Ed(r){new URL(r.slice(0,r.indexOf(",")))}var _r=class{constructor(){Ks.add(this),si.set(this,{}),ef(this,si,a.webViewAssets,"f")}getURL(e,t){return typeof e=="string"?qs(this,Ks,"m",Cd).call(this,e,t??{webView:!1}):qs(this,Ks,"m",Fd).call(this,e,t??{webView:!1})}};si=new WeakMap,Ks=new WeakSet,Cd=function(e,t){let i=t.webView?qs(this,si,"f")[e]:a.assets[e];if(i)return i;try{return Ed(e),e}catch{return""}},Fd=function(e,t){let i={},s=[],n=t.webView?qs(this,si,"f"):a.assets;if(n)for(let o of e)if(n[o])i[o]=n[o];else try{Ed(o),i[o]=o}catch{s.push(o)}else s=e;if(s.length>0)throw new Error(`The following assets were missing from the assets list: ${s.join(", ")}`);return i};var tf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Js=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Bt,Er=class{constructor(e){Bt.set(this,void 0),tf(this,Bt,e,"f")}async get(e){let{messages:t}=await a.kvStorePlugin.Get({keys:[e]},Js(this,Bt,"f"));try{if(t[e])return JSON.parse(t[e])}catch{return}}async put(e,t){let i={};i[e]=JSON.stringify(t),await a.kvStorePlugin.Put({messages:i},Js(this,Bt,"f"))}async delete(e){await a.kvStorePlugin.Del({keys:[e]},Js(this,Bt,"f"))}async list(){let{keys:e}=await a.kvStorePlugin.List({filter:"*"},Js(this,Bt,"f"));return e}};Bt=new WeakMap;var rf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},sf=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Zs,Cr=class{constructor(e){Zs.set(this,void 0),rf(this,Zs,e,"f")}async upload(e){let t=await a.mediaPlugin.Upload(e,sf(this,Zs,"f"));if(!t.mediaId)throw new Error("unable to get mediaId via uploads");return{mediaId:t.mediaId,mediaUrl:t.mediaUrl}}};Zs=new WeakMap;var nf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},of=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Qs,Fr=class{constructor(e){Qs.set(this,void 0),nf(this,Qs,e,"f")}async send(e,t){await a.realtimePlugin.Send({channel:e,data:{msg:t}},of(this,Qs,"f"))}};Qs=new WeakMap;import"@devvit/protos";var ge;(function(r){r.COMMENT="t1_",r.ACCOUNT="t2_",r.LINK="t3_",r.MESSAGE="t4_",r.SUBREDDIT="t5_",r.AWARD="t6_"})(ge||(ge={}));function wt(r){return r.startsWith(ge.COMMENT)}function Xs(r){return r.startsWith(ge.ACCOUNT)}function Ut(r){return r.startsWith(ge.LINK)}function Ad(r){return r.startsWith(ge.MESSAGE)}function Pd(r){return r.startsWith(ge.SUBREDDIT)}function Id(r){return r.startsWith(ge.AWARD)}function af(r){mt(wt(r),`Expected comment id to start with ${ge.COMMENT}, got ${r}}`)}function cf(r){mt(Xs(r),`Expected account id to start with ${ge.ACCOUNT}, got ${r}}`)}function df(r){mt(Ut(r),`Expected link id to start with ${ge.LINK}, got ${r}}`)}function lf(r){mt(Ad(r),`Expected message id to start with ${ge.MESSAGE}, got ${r}}`)}function uf(r){mt(Pd(r),`Expected subreddit id to start with ${ge.SUBREDDIT}, got ${r}}`)}function hf(r){mt(Id(r),`Expected award id to start with ${ge.AWARD}, got ${r}}`)}function Ar(r){return af(r),r}function we(r){return cf(r),r}function Te(r){return df(r),r}function ff(r){return lf(r),r}function se(r){return uf(r),r}function mf(r){return hf(r),r}function Oe(r){if(wt(r))return Ar(r);if(Xs(r))return we(r);if(Ut(r))return Te(r);if(Ad(r))return ff(r);if(Pd(r))return se(r);if(Id(r))return mf(r);throw new Error(`Expected thing id to start with ${Object.values(ge).join(", ")} got ${r}}`)}function Ta(r){return wt(r)}var Ys=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},h=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},m,en,ni,oi,Pr=class{constructor(e){m.set(this,void 0),en.set(this,void 0),ni.set(this,void 0),oi.set(this,void 0),Ys(this,m,e,"f"),Ys(this,en,new rn(e),"f")}get modMail(){return h(this,en,"f")}getSubredditById(e){return Se.getById(Oe(e),h(this,m,"f"))}getSubredditInfoById(e){return Sd(e,h(this,m,"f"))}getSubredditByName(e){return Se.getByName(e,h(this,m,"f"))}getSubredditInfoByName(e){return xd(e,h(this,m,"f"))}addSubredditRemovalReason(e,t){return Se.addRemovalReason(e,t.title,t.message,h(this,m,"f"))}getSubredditRemovalReasons(e){return Se.getRemovalReasons(e,h(this,m,"f"))}async getCurrentSubredditName(){let e=h(this,m,"f")?.[A.SubredditName]?.values[0];if(e)return e;let t=h(this,m,"f")?.[A.Subreddit]?.values[0],i=await Sa(se(t),h(this,m,"f"));if(!i)throw new Error("Couldn't get current subreddit's name");return i}async getCurrentSubreddit(){let e=await Se.getFromMetadata(h(this,m,"f"));if(!e)throw new Error("Couldn't get current subreddit");return e}getPostById(e){return X.getById(Oe(e),h(this,m,"f"))}submitPost(e){return X.submit(e,h(this,m,"f"))}crosspost(e){return X.crosspost(e,h(this,m,"f"))}getUserById(e){return C.getById(Oe(e),h(this,m,"f"))}getUserByUsername(e){return C.getByUsername(e,h(this,m,"f"))}async getCurrentUsername(){return Ys(this,oi,h(this,oi,"f")??Td(h(this,m,"f")),"f"),h(this,oi,"f")}async getCurrentUser(){return Ys(this,ni,h(this,ni,"f")??this.getCurrentUsername().then(e=>e?C.getByUsername(e,h(this,m,"f")):void 0),"f"),h(this,ni,"f")}getAppUser(){return C.getFromMetadata(A.AppUser,h(this,m,"f"))}async getSnoovatarUrl(e){let t=await this.getCurrentUsername();if(t&&e===t){let i=h(this,m,"f")?.[A.UserSnoovatarUrl]?.values[0];if(i)return i}return C.getSnoovatarUrl(e,h(this,m,"f"))}getCommentById(e){return ne.getById(Oe(e),h(this,m,"f"))}getComments(e){return ne.getComments(e,h(this,m,"f"))}getCommentsByUser(e){return ne.getCommentsByUser(e,h(this,m,"f"))}submitComment(e){return ne.submit({...e,id:Oe(e.id)},h(this,m,"f"))}getControversialPosts(e){return X.getControversialPosts(e,h(this,m,"f"))}getTopPosts(e){return X.getTopPosts(e,h(this,m,"f"))}getHotPosts(e){return X.getHotPosts(e,h(this,m,"f"))}getNewPosts(e){return X.getNewPosts(e,h(this,m,"f"))}getRisingPosts(e){return X.getRisingPosts(e,h(this,m,"f"))}getPostsByUser(e){return X.getPostsByUser(e,h(this,m,"f"))}getCommentsAndPostsByUser(e){return C.getOverview(e,h(this,m,"f"))}getUserKarmaFromCurrentSubreddit(e){return C.getUserKarmaFromCurrentSubreddit(e,h(this,m,"f"))}getModerationLog(e){return tn(e,h(this,m,"f"))}getApprovedUsers(e){return C.getSubredditUsersByType({type:"contributors",...e},h(this,m,"f"))}approveUser(e,t){return C.createRelationship({username:e,subredditName:t,type:"contributor"},h(this,m,"f"))}removeUser(e,t){return C.removeRelationship({username:e,subredditName:t,type:"contributor"},h(this,m,"f"))}getWikiContributors(e){return C.getSubredditUsersByType({type:"wikicontributors",...e},h(this,m,"f"))}addWikiContributor(e,t){return C.createRelationship({username:e,subredditName:t,type:"wikicontributor"},h(this,m,"f"))}removeWikiContributor(e,t){return C.removeRelationship({username:e,subredditName:t,type:"wikicontributor"},h(this,m,"f"))}getBannedUsers(e){return C.getSubredditUsersByType({type:"banned",...e},h(this,m,"f"))}banUser(e){return C.createRelationship({username:e.username,subredditName:e.subredditName,type:"banned",banReason:e.reason,banMessage:e.message,note:e.note,duration:e.duration,banContext:e.context},h(this,m,"f"))}unbanUser(e,t){return C.removeRelationship({username:e,subredditName:t,type:"banned"},h(this,m,"f"))}getBannedWikiContributors(e){return C.getSubredditUsersByType({type:"wikibanned",...e},h(this,m,"f"))}banWikiContributor(e){return C.createRelationship({...e,type:"wikibanned"},h(this,m,"f"))}unbanWikiContributor(e,t){return C.removeRelationship({username:e,subredditName:t,type:"wikibanned"},h(this,m,"f"))}getModerators(e){return C.getSubredditUsersByType({type:"moderators",...e},h(this,m,"f"))}inviteModerator(e){return C.createRelationship({type:"moderator_invite",subredditName:e.subredditName,username:e.username,permissions:e.permissions??[]},h(this,m,"f"))}revokeModeratorInvite(e,t){return C.removeRelationship({username:e,subredditName:t,type:"moderator_invite"},h(this,m,"f"))}removeModerator(e,t){return C.removeRelationship({type:"moderator",subredditName:t,username:e},h(this,m,"f"))}setModeratorPermissions(e,t,i){return C.setModeratorPermissions(e,t,i,h(this,m,"f"))}getMutedUsers(e){return C.getSubredditUsersByType({type:"muted",...e},h(this,m,"f"))}muteUser(e){return C.createRelationship({...e,type:"muted"},h(this,m,"f"))}unmuteUser(e,t){return C.removeRelationship({username:e,subredditName:t,type:"muted"},h(this,m,"f"))}getModNotes(e){return Le.get(e,h(this,m,"f"))}deleteModNote(e){return Le.delete(e,h(this,m,"f"))}addModNote(e){let t={...e,redditId:e.redditId?Oe(e.redditId):void 0};return Le.add(t,h(this,m,"f"))}addRemovalNote(e){return Le.addRemovalNote(e,h(this,m,"f"))}async sendPrivateMessage(e){return Ot.send(e,h(this,m,"f"))}async sendPrivateMessageAsSubreddit(e){return Ot.sendAsSubreddit(e,h(this,m,"f"))}async approve(e){if(wt(e))return ne.approve(e,h(this,m,"f"));if(Ut(e))return X.approve(e,h(this,m,"f"));throw new Error("id must start with either t1_ or t3_")}async remove(e,t){if(wt(e))return ne.remove(e,t,h(this,m,"f"));if(Ut(e))return X.remove(e,t,h(this,m,"f"));throw new Error("id must start with either t1_ or t3_")}async getPostFlairTemplates(e){return ye.getPostFlairTemplates(e,h(this,m,"f"))}async getUserFlairTemplates(e){return ye.getUserFlairTemplates(e,h(this,m,"f"))}async createPostFlairTemplate(e){return ye.createPostFlairTemplate(e,h(this,m,"f"))}async createUserFlairTemplate(e){return ye.createUserFlairTemplate(e,h(this,m,"f"))}async editFlairTemplate(e){return ye.editFlairTemplate(e,h(this,m,"f"))}async deleteFlairTemplate(e,t){return ye.deleteFlairTemplate(e,t,h(this,m,"f"))}async setUserFlair(e){return Ee.setUserFlair(e,h(this,m,"f"))}async setUserFlairBatch(e,t){return Ee.setUserFlairBatch(e,t,h(this,m,"f"))}async removeUserFlair(e,t){return Ee.removeUserFlair(e,t,h(this,m,"f"))}async setPostFlair(e){return Ee.setPostFlair(e,h(this,m,"f"))}async removePostFlair(e,t){return Ee.removePostFlair(e,Te(t),h(this,m,"f"))}async getWidgets(e){return fe.getWidgets(e,h(this,m,"f"))}async deleteWidget(e,t){return fe.delete(e,t,h(this,m,"f"))}async addWidget(e){return fe.add(e,h(this,m,"f"))}async updateWidget(e){return fe.patch(e,h(this,m,"f"))}async reorderWidgets(e,t){return fe.reorder(e,t,h(this,m,"f"))}async getWikiPage(e,t,i){return xe.getPage(e,t,i,h(this,m,"f"))}async getWikiPages(e){return xe.getPages(e,h(this,m,"f"))}async createWikiPage(e){return xe.createPage(e,h(this,m,"f"))}async updateWikiPage(e){return xe.updatePage(e,h(this,m,"f"))}getWikiPageRevisions(e){return xe.getPageRevisions(e,h(this,m,"f"))}async revertWikiPage(e,t,i){return xe.revertPage(e,t,i,h(this,m,"f"))}async getWikiPageSettings(e,t){return xe.getPageSettings(e,t,h(this,m,"f"))}async updateWikiPageSettings(e){return xe.updatePageSettings(e,h(this,m,"f"))}async addEditorToWikiPage(e,t,i){return xe.addEditor(e,t,i,h(this,m,"f"))}async removeEditorFromWikiPage(e,t,i){return xe.removeEditor(e,t,i,h(this,m,"f"))}getMessages(e){return Ot.getMessages(e,h(this,m,"f"))}markAllMessagesAsRead(){return Ot.markAllAsRead(h(this,m,"f"))}report(e,t){return a.redditAPIPlugins.LinksAndComments.Report({reason:t.reason,thingId:e.id,srName:e.subredditName,usernames:e.authorName},h(this,m,"f"))}getModQueue(e){return Se.aboutLocation({...e,location:Re.Modqueue},h(this,m,"f"))}getReports(e){return Se.aboutLocation({...e,location:Re.Reports},h(this,m,"f"))}getSpam(e){return Se.aboutLocation({...e,location:Re.Spam},h(this,m,"f"))}getUnmoderated(e){return Se.aboutLocation({...e,location:Re.Unmoderated},h(this,m,"f"))}getEdited(e){return Se.aboutLocation({...e,location:Re.Edited},h(this,m,"f"))}getVaultByAddress(e){return Nd(e,h(this,m,"f"))}getVaultByUserId(e){return Dd(Oe(e),h(this,m,"f"))}getSubredditLeaderboard(e){return Rd(e,h(this,m,"f"))}getSubredditStyles(e){return Md(e,h(this,m,"f"))}async subscribeToCurrentSubreddit(){let e=await this.getCurrentSubreddit();await a.redditAPIPlugins.Subreddits.Subscribe({action:"sub",actionSource:"",srName:e.name,sr:"",skipInitialDefaults:!0},h(this,m,"f"))}async unsubscribeFromCurrentSubreddit(){let e=await this.getCurrentSubreddit();await a.redditAPIPlugins.Subreddits.Subscribe({action:"unsub",actionSource:"",srName:e.name,sr:"",skipInitialDefaults:!1},h(this,m,"f"))}};m=new WeakMap,en=new WeakMap,ni=new WeakMap,oi=new WeakMap;import{BitfieldOverflowBehavior as xa,RedisKeyScope as Ra}from"@devvit/protos";var di=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},d=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},R,M,N,S,ci;function ai(r){return r&&typeof r=="object"&&"message"in r&&r.message!==void 0&&typeof r.message=="string"?r.message.includes("redis: nil"):!1}var Ma=class{constructor(e,t,i){R.set(this,void 0),M.set(this,void 0),N.set(this,void 0),di(this,R,e,"f"),di(this,M,t,"f"),di(this,N,i,"f")}async get(e){return await d(this,R,"f").Get({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async multi(){await d(this,R,"f").Multi(d(this,M,"f"),d(this,N,"f"))}async set(e,t,i){let s;return i?.expiration&&(s=Math.floor((i.expiration.getTime()-Date.now())/1e3),s<1&&(s=1)),await d(this,R,"f").Set({key:e,value:t,nx:i?.nx===!0,xx:i?.xx===!0,expiration:s||0,transactionId:d(this,M,"f")},d(this,N,"f")),this}async del(...e){return await d(this,R,"f").Del({keys:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async type(e){return await d(this,R,"f").Type({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async exec(){let e=await d(this,R,"f").Exec(d(this,M,"f"),d(this,N,"f")),t=[];for(let i of e.response)i.members?t.push(i.members):i.nil!==void 0?t.push(null):i.num!==void 0?t.push(i.num):i.values!==void 0?t.push(i.values.values):i.str!==void 0?t.push(i.str):i.dbl!==void 0?t.push(i.dbl):i.bool!==void 0&&t.push(i.bool);return t}async discard(){await d(this,R,"f").Discard(d(this,M,"f"),d(this,N,"f"))}async watch(...e){return await d(this,R,"f").Watch({keys:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async unwatch(){return await d(this,R,"f").Unwatch(d(this,M,"f"),d(this,N,"f")),this}async getRange(e,t,i){return await d(this,R,"f").GetRange({key:e,start:t,end:i,transactionId:d(this,M,"f")},d(this,N,"f")),this}async setRange(e,t,i){return await d(this,R,"f").SetRange({key:e,offset:t,value:i,transactionId:d(this,M,"f")},d(this,N,"f")),this}async strlen(e){return this.strLen(e)}async strLen(e){return await d(this,R,"f").Strlen({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async mget(e){return this.mGet(e)}async mGet(e){return await d(this,R,"f").MGet({keys:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async mset(e){return this.mSet(e)}async mSet(e){let t=Object.entries(e).map(([i,s])=>({key:i,value:s}));return await d(this,R,"f").MSet({kv:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async incrBy(e,t){return await d(this,R,"f").IncrBy({key:e,value:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async expire(e,t){return await d(this,R,"f").Expire({key:e,seconds:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async expireTime(e){return await d(this,R,"f").ExpireTime({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async zAdd(e,...t){return await d(this,R,"f").ZAdd({key:e,members:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async zScore(e,t){return await d(this,R,"f").ZScore({key:{key:e,transactionId:d(this,M,"f")},member:t},d(this,N,"f")),this}async zRank(e,t){return await d(this,R,"f").ZRank({key:{key:e,transactionId:d(this,M,"f")},member:t},d(this,N,"f")),this}async zIncrBy(e,t,i){return await d(this,R,"f").ZIncrBy({key:e,member:t,value:i,transactionId:d(this,M,"f")},d(this,N,"f")),this}async zScan(e,t,i,s){let n={key:e,cursor:t,pattern:i,count:s,transactionId:d(this,M,"f")};return await d(this,R,"f").ZScan(n,d(this,N,"f")),this}async zCard(e){return await d(this,R,"f").ZCard({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async zRange(e,t,i,s){let n={rev:!1,byLex:!1,byScore:!1,offset:0,count:1e3};if(s?.reverse&&(n.rev=s.reverse),s?.by==="lex"?n.byLex=!0:s?.by==="score"&&(n.byScore=!0),s?.limit)if(n.byLex||n.byScore)n.offset=s.limit.offset,n.count=s.limit.count;else throw new Error("zRange parsing error: 'limit' only allowed when 'options.by' is 'lex' or 'score'");return await d(this,R,"f").ZRange({key:{key:e,transactionId:d(this,M,"f")},start:t+"",stop:i+"",...n},d(this,N,"f")),this}async zRem(e,t){return await d(this,R,"f").ZRem({key:{key:e,transactionId:d(this,M,"f")},members:t},d(this,N,"f")),this}async zRemRangeByLex(e,t,i){return await d(this,R,"f").ZRemRangeByLex({key:{key:e,transactionId:d(this,M,"f")},min:t,max:i},d(this,N,"f")),this}async zRemRangeByRank(e,t,i){return await d(this,R,"f").ZRemRangeByRank({key:{key:e,transactionId:d(this,M,"f")},start:t,stop:i},d(this,N,"f")),this}async zRemRangeByScore(e,t,i){return await d(this,R,"f").ZRemRangeByScore({key:{key:e,transactionId:d(this,M,"f")},min:t,max:i},d(this,N,"f")),this}async hgetall(e){return this.hGetAll(e)}async hGetAll(e){return await d(this,R,"f").HGetAll({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hget(e,t){return this.hGet(e,t)}async hGet(e,t){return await d(this,R,"f").HGet({key:e,field:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hMGet(e,t){return await d(this,R,"f").HMGet({key:e,fields:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hset(e,t){return this.hSet(e,t)}async hSet(e,t){let i=Object.entries(t).map(([s,n])=>({field:s,value:n}));return await d(this,R,"f").HSet({key:e,fv:i,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hincrby(e,t,i){return this.hIncrBy(e,t,i)}async hIncrBy(e,t,i){return await d(this,R,"f").HIncrBy({key:e,field:t,value:i,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hdel(e,t){return this.hDel(e,t)}async hDel(e,t){return await d(this,R,"f").HDel({key:e,fields:t,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hscan(e,t,i,s){return this.hScan(e,t,i,s)}async hScan(e,t,i,s){let n={key:e,cursor:t,pattern:i,count:s,transactionId:d(this,M,"f")};return await d(this,R,"f").HScan(n,d(this,N,"f")),this}async hkeys(e){return this.hKeys(e)}async hKeys(e){return await d(this,R,"f").HKeys({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}async hlen(e){return this.hLen(e)}async hLen(e){return await d(this,R,"f").HLen({key:e,transactionId:d(this,M,"f")},d(this,N,"f")),this}};R=new WeakMap,M=new WeakMap,N=new WeakMap;var Ir=class r{constructor(e,t=void 0,i=Ra.INSTALLATION){S.set(this,void 0),ci.set(this,void 0),di(this,S,e,"f"),di(this,ci,t,"f"),this.scope=i,this.global=i===Ra.INSTALLATION?new r(d(this,S,"f"),d(this,ci,"f"),Ra.GLOBAL):this}get storage(){return d(this,ci,"f")||a.redisPlugin}async watch(...e){let t=await this.storage.Watch({keys:e},d(this,S,"f"));return new Ma(this.storage,t,d(this,S,"f"))}async get(e){try{let t=await this.storage.Get({key:e,scope:this.scope},{...d(this,S,"f"),"throw-redis-nil":{values:["true"]}});return t!==null?t.value??void 0:t}catch(t){if(ai(t))return;throw t}}async getBuffer(e){try{let t=await this.storage.GetBytes({key:e,scope:this.scope},{...d(this,S,"f"),"throw-redis-nil":{values:["true"]}});return t!==null?Buffer.from(t.value):t}catch(t){if(ai(t))return;throw t}}async set(e,t,i){let s;return i?.expiration&&(s=Math.floor((i.expiration.getTime()-Date.now())/1e3),s<1&&(s=1)),(await this.storage.Set({key:e,value:t,nx:i?.nx===!0&&!i.xx,xx:i?.xx===!0&&!i.nx,expiration:s||0,scope:this.scope},d(this,S,"f"))).value}async exists(...e){return(await this.storage.Exists({keys:e,scope:this.scope},d(this,S,"f"))).existingKeys}async del(...e){await this.storage.Del({keys:e,scope:this.scope},d(this,S,"f"))}async incrBy(e,t){return(await this.storage.IncrBy({key:e,value:t,scope:this.scope},d(this,S,"f"))).value}async getRange(e,t,i){let s=await this.storage.GetRange({key:e,start:t,end:i,scope:this.scope},d(this,S,"f"));return s!==null?s.value:s}async setRange(e,t,i){return(await this.storage.SetRange({key:e,offset:t,value:i,scope:this.scope},d(this,S,"f"))).value}async strlen(e){return this.strLen(e)}async strLen(e){return(await this.storage.Strlen({key:e,scope:this.scope},d(this,S,"f"))).value}async expire(e,t){await this.storage.Expire({key:e,seconds:t,scope:this.scope},d(this,S,"f"))}async expireTime(e){return(await this.storage.ExpireTime({key:e,scope:this.scope},d(this,S,"f"))).value}async zAdd(e,...t){return(await this.storage.ZAdd({key:e,members:t,scope:this.scope},d(this,S,"f"))).value}async zRange(e,t,i,s){let n={rev:!1,byLex:!1,byScore:!1,offset:0,count:1e3};if(s?.reverse&&(n.rev=s.reverse),s?.by==="lex"?n.byLex=!0:s?.by==="score"?n.byScore=!0:(n.offset=0,n.count=0),s?.limit)if(n.byLex||n.byScore)n.offset=s.limit.offset,n.count=s.limit.count;else throw new Error("zRange parsing error: 'limit' only allowed when 'options.by' is 'lex' or 'score'");return(await this.storage.ZRange({key:{key:e},start:t+"",stop:i+"",...n,scope:this.scope},d(this,S,"f"))).members}async zRem(e,t){return(await this.storage.ZRem({key:{key:e},members:t,scope:this.scope},d(this,S,"f"))).value}async zRemRangeByLex(e,t,i){return(await this.storage.ZRemRangeByLex({key:{key:e},min:t,max:i,scope:this.scope},d(this,S,"f"))).value}async zRemRangeByRank(e,t,i){return(await this.storage.ZRemRangeByRank({key:{key:e},start:t,stop:i,scope:this.scope},d(this,S,"f"))).value}async zRemRangeByScore(e,t,i){return(await this.storage.ZRemRangeByScore({key:{key:e},min:t,max:i,scope:this.scope},d(this,S,"f"))).value}async zScore(e,t){try{let i=await this.storage.ZScore({key:{key:e},member:t,scope:this.scope},{...d(this,S,"f"),"throw-redis-nil":{values:["true"]}});return i!==null?i.value:i}catch(i){if(ai(i))return;throw i}}async zRank(e,t){try{let i=await this.storage.ZRank({key:{key:e},member:t,scope:this.scope},{...d(this,S,"f"),"throw-redis-nil":{values:["true"]}});return i!==null?i.value:i}catch(i){if(ai(i))return;throw i}}async zIncrBy(e,t,i){let s=await this.storage.ZIncrBy({key:e,member:t,value:i,scope:this.scope},d(this,S,"f"));return s!==null?s.value:s}async mget(e){return this.mGet(e)}async mGet(e){let t=await this.storage.MGet({keys:e,scope:this.scope},d(this,S,"f"));return t!==null?t.values.map(i=>i||null):t}async mset(e){return this.mSet(e)}async mSet(e){let t=Object.entries(e).map(([i,s])=>({key:i,value:s}));await this.storage.MSet({kv:t,scope:this.scope},d(this,S,"f"))}async zCard(e){let t=await this.storage.ZCard({key:e,scope:this.scope},d(this,S,"f"));return t!==null?t.value:t}async zScan(e,t,i,s){let n={key:e,cursor:t,pattern:i,count:s,scope:this.scope};return await this.storage.ZScan(n,d(this,S,"f"))}async type(e){let t=await this.storage.Type({key:e,scope:this.scope},d(this,S,"f"));return t!==null?t.value:t}async rename(e,t){return(await this.storage.Rename({key:e,newKey:t,scope:this.scope},d(this,S,"f"))).result}async hget(e,t){return this.hGet(e,t)}async hGet(e,t){try{let i=await this.storage.HGet({key:e,field:t,scope:this.scope},{...d(this,S,"f"),"throw-redis-nil":{values:["true"]}});return i!==null?i.value??void 0:i}catch(i){if(ai(i))return;throw i}}async hMGet(e,t){let i=await this.storage.HMGet({key:e,fields:t,scope:this.scope},d(this,S,"f"));return i!==null?i.values.map(s=>s||null):i}async hset(e,t){return this.hSet(e,t)}async hSet(e,t){let i=Object.entries(t).map(([n,o])=>({field:n,value:o}));return(await this.storage.HSet({key:e,fv:i,scope:this.scope},d(this,S,"f"))).value}async hSetNX(e,t,i){return(await this.storage.HSetNX({key:e,field:t,value:i,scope:this.scope},d(this,S,"f"))).success}async hgetall(e){return this.hGetAll(e)}async hGetAll(e){let t=await this.storage.HGetAll({key:e,scope:this.scope},d(this,S,"f"));return t!==null?t.fieldValues:t}async hdel(e,t){return this.hDel(e,t)}async hDel(e,t){return(await this.storage.HDel({key:e,fields:t,scope:this.scope},d(this,S,"f"))).value}async hscan(e,t,i,s){return this.hScan(e,t,i,s)}async hScan(e,t,i,s){let n={key:e,cursor:t,pattern:i,count:s,scope:this.scope};return await this.storage.HScan(n,d(this,S,"f"))}async hkeys(e){return this.hKeys(e)}async hKeys(e){let t=await this.storage.HKeys({key:e,scope:this.scope},d(this,S,"f"));return t!==null?t.keys:t}async hincrby(e,t,i){return this.hIncrBy(e,t,i)}async hIncrBy(e,t,i){return(await this.storage.HIncrBy({key:e,field:t,value:i,scope:this.scope},d(this,S,"f"))).value}async hlen(e){return this.hLen(e)}async hLen(e){return(await this.storage.HLen({key:e,scope:this.scope})).value}async bitfield(e,...t){let i=[];for(let n=0;n<t.length;){let o=t[n],c={};switch(o){case"get":{if(n+2>=t.length)throw Error("bitfield command parse failed; not enough arguments for 'get' command");c.get={encoding:t[n+1],offset:t[n+2].toString()},n+=3;break}case"set":{if(n+3>=t.length)throw Error("bitfield command parse failed; not enough arguments for 'set' command");c.set={encoding:t[n+1],offset:t[n+2].toString(),value:t[n+3].toString()},n+=4;break}case"incrBy":{if(n+3>=t.length)throw Error("bitfield command parse failed; not enough arguments for 'incrBy' command");c.incrBy={encoding:t[n+1],offset:t[n+2].toString(),increment:t[n+3].toString()},n+=4;break}case"overflow":{if(n+1>=t.length)throw Error("bitfield command parse failed; not enough arguments for 'overflow' command");let l=t[n+1].toString();c.overflow={behavior:pf(l)},n+=2;break}default:throw Error(`bitfield command parse failed; ${o} unrecognized (must be 'get', 'set', 'incrBy', or 'overflow')`)}i.push(c)}return(await this.storage.Bitfield({key:e,commands:i,scope:this.scope})).results}};S=new WeakMap,ci=new WeakMap;function pf(r){let e=r.toLowerCase();switch(e){case"wrap":return xa.BITFIELD_OVERFLOW_BEHAVIOR_WRAP;case"sat":return xa.BITFIELD_OVERFLOW_BEHAVIOR_SAT;case"fail":return xa.BITFIELD_OVERFLOW_BEHAVIOR_FAIL;default:throw Error(`unknown bitfield overflow behavior: ${e}`)}}var gf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Na=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Tr,Sr=class{constructor(e){Tr.set(this,void 0),gf(this,Tr,e,"f")}async runJob(e){return(await a.schedulerPlugin.Schedule({action:{type:e.name,data:e.data},cron:"cron"in e?e.cron:void 0,when:"runAt"in e?e.runAt:void 0},Na(this,Tr,"f"))).id}async cancelJob(e){await a.schedulerPlugin.Cancel({id:e},Na(this,Tr,"f"))}async listJobs(){return(await a.schedulerPlugin.List({after:new Date(0),before:new Date(Date.now()+31536e7)},Na(this,Tr,"f"))).actions.map(t=>(u(t.request?.action,"Scheduled job is malformed"),"when"in t.request&&t.request.when!=null?{id:t.id,name:t.request.action.type,runAt:t.request.when,data:t.request.action.data}:{id:t.id,name:t.request.action.type,cron:t.request.cron??"",data:t.request.action.data}))}};Tr=new WeakMap;import{FormFieldType as sn}from"@devvit/protos";var wf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},yf=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},nn,xr=class{constructor(e){nn.set(this,void 0),wf(this,nn,e,"f")}async get(e){return(await this.getAll())[e]}async getAll(){let t=await a.settingsPlugin.GetSettings({},yf(this,nn,"f"));if(!t.installationSettings)throw new Error("Could not get installation settings");if(!t.appSettings)throw new Error("Could not get app settings");return bf(t),{...Bd(t.installationSettings.settings,a.installationSettings),...Bd(t.appSettings.settings,a.appSettings)}}};nn=new WeakMap;function bf(r){if(!r.appSettings)throw new Error("Could not get app settings");for(let[e,t]of Object.entries(r.appSettings.settings)){let i=a.appSettings?.find(s=>s.type!=="group"&&s.name===e);i&&(i.type==="boolean"&&t.fieldType===sn.STRING&&t.boolValue==null&&t.stringValue!=null?(t.fieldType=sn.BOOLEAN,t.boolValue=!!t.stringValue,delete t.stringValue):i.type==="number"&&t.fieldType===sn.STRING&&t.numberValue==null&&t.stringValue!=null&&(t.fieldType=sn.NUMBER,t.numberValue=Number(t.stringValue),delete t.stringValue))}}function Bd(r,e){let t=Object.keys(r).reduce((i,s)=>(i[s]=Fa(r[s]),i),{});return e&&Ud(t,e),t}function Ud(r,e){for(let t of e)t.type==="group"?Ud(r,t.fields):!(t.name in r)&&"defaultValue"in t&&(r[t.name]=t.defaultValue)}import{EffectType as on,ToastAppearance as Ld}from"@devvit/protos";var Od=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},st=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Lt,li,an,Da,cn=class{constructor(e){Lt.set(this,[]),li.set(this,void 0),an.set(this,void 0),Da.set(this,(t,i)=>{let s=i!==void 0?t:"",n=i!==void 0?i:t;st(this,Lt,"f").push({type:on.EFFECT_WEB_VIEW,webView:{postMessage:{webViewId:s,app:{message:n}}}})}),Od(this,li,e,"f"),Od(this,an,{postMessage:st(this,Da,"f")},"f")}get webView(){return st(this,an,"f")}showForm(e,t){return this.showFormInternal(e,t)}showFormInternal(e,t,i){let s=a.formDefinitions?.get(e);if(!s&&st(this,li,"f")){let c=st(this,li,"f").forms.get(e);c&&(s={form:c,onSubmit:()=>{}})}if(!s)throw new Error("Form does not exist. Make sure you have added it using Devvit.createForm at the root of your app.");let n=i??(s.form instanceof Function?s.form(t??{}):s.form),o={fields:[],id:e,title:n.title,acceptLabel:n.acceptLabel,cancelLabel:n.cancelLabel,shortDescription:n.description};Mt(n.fields),o.fields=it(n.fields),st(this,Lt,"f").push({type:on.EFFECT_SHOW_FORM,showForm:{form:o}})}showToast(e){let t;e instanceof Object?t={text:e.text,appearance:e.appearance==="success"?Ld.SUCCESS:Ld.NEUTRAL}:t={text:e},st(this,Lt,"f").push({type:on.EFFECT_SHOW_TOAST,showToast:{toast:t}})}navigateTo(e){let t=typeof e=="string"?e:e.url;if(!URL.canParse(t))throw new TypeError(`Invalid URL: ${t}`);let i=new URL(t).toString();st(this,Lt,"f").push({type:on.EFFECT_NAVIGATE_TO_URL,navigateToUrl:{url:i}})}get __effects(){return st(this,Lt,"f")}};Lt=new WeakMap,li=new WeakMap,an=new WeakMap,Da=new WeakMap;function be({metadata:r,ui:e,hooks:t,reconciler:i}){let s=new Er(r),n=new Ir(r),o=_d(n,i?i.state:{}),c=new Pr(r),l=new Sr(r),f=new xr(r),v=e?new cn(i):void 0,y=new Cr(r),P=new _r,T=new Fr(r),ee=t&&i?dd(i):void 0,B=t&&i?cd(i):void 0,te=t&&i?ad(i):void 0,G=t&&i?od(i):void 0;return{kvStore:s,redis:n,reddit:c,scheduler:l,settings:f,media:y,assets:P,realtime:T,get useForm(){return te??(()=>{throw new Error("useForm() is unavailable")})},get cache(){return o??(()=>{throw new Error("cache() is unavailable")})},get useState(){return ee??(()=>{throw new Error("useState() is unavailable")})},get useInterval(){return B??(()=>{throw new Error("useInterval() is unavailable")})},get useChannel(){return G??(()=>{throw new Error("useChannel() is unavailable")})},get ui(){if(!v)throw new Error("ui client is not available");return v}}}var Wd={name:"@devvit/public-api",version:"0.12.12-dev",license:"BSD-3-Clause",repository:{type:"git",url:"https://developers.reddit.com/"},type:"module",exports:{".":"./dist/index.js","./package.json":"./package.json","./*":"./dist/*"},main:"./dist/index.js",files:["dist/**"],scripts:{build:"yarn build:icon-types && yarn build:semantic-colors && tsc && cp -af devvit.tsconfig.json dist/ && yarn build:min","build:icon-types":"make-icons src/types/icons.ts","build:min":"esbuild --bundle --sourcemap=linked --target=es2020 --format=esm  --metafile=dist/meta.min.json --outfile=dist/public-api.min.js --external:@devvit/protos --minify src/index.ts","build:semantic-colors":"node scripts/make-semantic-colors.js",clean:"rm -rf .turbo coverage dist src/devvit/internals/semanticColors.ts src/types/icons.ts || :",clobber:"yarn clean && rm -rf node_modules","dev:build":"chokidar ./src ../shared-types/dist --command 'yarn build' --ignore './src/types/icons.ts' --ignore './src/devvit/internals/semanticColors.ts'",lint:"redlint .","lint:fix":"yarn lint --fix",prepublishOnly:"publish-package-json",test:"yarn test:unit && yarn test:types && yarn test:size","test:size":"filesize","test:types":"tsc --noEmit","test:unit":"vitest run","test:unit-with-coverage":"vitest run --coverage"},types:"./dist/index.d.ts",dependencies:{"@devvit/metrics":"0.12.12-dev","@devvit/protos":"0.12.12-dev","@devvit/shared":"0.12.12-dev","@devvit/shared-types":"0.12.12-dev","base64-js":"1.5.1","clone-deep":"4.0.1",moderndash:"4.0.0"},devDependencies:{"@ampproject/filesize":"4.3.0","@devvit/repo-tools":"0.12.12-dev","@devvit/tsconfig":"0.12.12-dev","@reddit/faceplate-ui":"18.2.2","@reddit/rpl-styles":"1.0.2","@types/clone-deep":"4.0.1","@types/node":"20.14.12","chokidar-cli":"3.0.0",esbuild:"0.25.9",eslint:"9.11.1",typescript:"5.8.3",vitest:"4.0.15"},publishConfig:{directory:"dist"},filesize:{"dist/public-api.min.js":{gzip:"65 KB",none:"225 KB"}},source:"./src/index.ts"};function ue(r,e,t){let i=r[A.Subreddit]?.values[0];u(i,"subreddit is missing from Context");let s=r[A.SubredditName]?.values[0],n,o=r[A.PostData]?.values[0];o&&(n=JSON.parse(o).developerData);let c=r[A.AppUser]?.values[0],l=r[A.App]?.values[0],f=r[A.Version]?.values[0],v=r[A.UserSnoovatarUrl]?.values[0],y=r[A.Username]?.values[0],P=r[A.User]?.values[0],T=kf(r);return{get appAccountId(){return u(c,"appAccountId is missing from Context"),c},subredditId:i,subredditName:s,userId:P,postId:e,postData:n,commentId:t,appName:l,appSlug:l,appVersion:f,snoovatar:v,username:y,debug:T,metadata:r,toJSON(){return{appAccountId:c,appName:l,appSlug:l,appVersion:f,subredditId:i,subredditName:s,userId:P,postId:e,postData:n,commentId:t,snoovatar:v,username:y,debug:T,metadata:r}}}}function kf(r){var e;let t={blocks:void 0,emitSnapshots:void 0,emitState:void 0,realtime:void 0,runtime:void 0,surface:void 0,useAsync:void 0,payments:void 0,bootstrap:void 0,webView:void 0},i={};for(let n in t)i[n.toLowerCase()]=n;let s={};for(let n of(r[A.Debug]?.values??[]).join().split(",")){let[o,c]=n.split("=");o&&(o=o.trim(),c=c?.trim(),o.toLowerCase()in i&&(o=i[o.toLowerCase()]),s[e=o]??(s[e]=c||"true"))}return r[A.Debug]&&console.info(`[api] @devvit/public-api v${Wd.version} ${Object.entries(s).map(([n,o])=>`${n}=${o}`).join(" ")}`),{...s,metadata:r}}function Hd(r){return r.flatMap(e=>e.type==="group"?Hd(e.fields):e)}async function dn(r,e,t){if(!e)throw new Error("Settings were not defined.");let i={success:!0,errors:{}},s=gt(r.fieldValues),n=Hd(e);return await Promise.all(n.map(async o=>{let c=o.name;if(c&&o.onValidate){let l=s[c],f=o.onValidate,v=Object.assign(be({metadata:t}),ue(t)),y=await f({value:l,isEditing:r.editing},v);y&&(i.success=!1,i.errors[c]=y)}})),_f.fromJSON(i)}async function Ff(){return Cf.fromJSON({fields:{fields:it(a.appSettings??[])}})}async function Af(r,e){return dn(r,a.appSettings,e)}function jd(r){r.provides(Ef),O("GetAppSettingsFields",Ff),O("ValidateAppForm",Af)}import{CustomPostDefinition as Bf,RenderPostResponse as Uf}from"@devvit/protos";import{BlockRenderEventType as Ja,EffectType as il}from"@devvit/protos";function Rr(r){return r.__effects}function Gd(){let r=new Set;return e=>{let t=e,i=1;for(;r.has(t);)t=`${e}.${i++}`;return r.add(t),t}}import{BlockActionType as qa,BlockAvatarBackground as Yd,BlockAvatarFacing as el,BlockAvatarSize as yt,BlockBorderWidth as fn,BlockButtonAppearance as bt,BlockButtonSize as Wa,BlockGap as mn,BlockHorizontalAlignment as Ha,BlockIconSize as pn,BlockImageResizeMode as ui,BlockPadding as hi,BlockRadius as fi,BlockSpacerShape as ja,BlockSpacerSize as gn,BlockStackDirection as Ga,BlockTextOutline as Va,BlockTextOverflow as $a,BlockTextSize as Nr,BlockTextStyle as za,BlockTextWeight as tl,BlockType as qe,BlockVerticalAlignment as Ka}from"@devvit/protos";var Ba={"alienblue-100":"#DCE2FB","alienblue-200":"#B8C5FC","alienblue-25":"#F7F8FD","alienblue-300":"#90A9FD","alienblue-400":"#648EFC","alienblue-50":"#EEF0FB","alienblue-500":"#1870F4","alienblue-600":"#115BCA","alienblue-700":"#0A449B","alienblue-75":"#E6E9FB","alienblue-800":"#0A2F6C","alienblue-900":"#0A1A3F","alienblue-950":"#07102B","berrypurple-100":"#F3DAFB","berrypurple-200":"#EAB3FD","berrypurple-25":"#FBF6FD","berrypurple-300":"#DE8BFF","berrypurple-400":"#CF5FFF","berrypurple-50":"#F8EDFC","berrypurple-500":"#BC0EFF","berrypurple-600":"#9B00D4","berrypurple-700":"#7600A3","berrypurple-75":"#F6E4FB","berrypurple-800":"#520472","berrypurple-900":"#300643","berrypurple-950":"#20042A",black:"#000000","black-opacity-0":"#00000000","black-opacity-10":"#00000019","black-opacity-15":"#00000026","black-opacity-20":"#00000033","black-opacity-25":"#0000003F","black-opacity-33":"#00000054","black-opacity-5":"#0000000C","black-opacity-50":"#0000007F","black-opacity-60":"#00000099","black-opacity-67":"#000000AA","black-opacity-80":"#000000CC","black-opacity-90":"#000000E5","brand-secondary-bananayellow_base":"#FFBF0B","brand-secondary-bananayellow_highlight":"#FFDE55","brand-secondary-bananayellow_shade":"#F27300","brand-secondary-bananayellow_tint":"#FFF3C0","brand-secondary-guavapink_base":"#FF5FC2","brand-secondary-guavapink_highlight":"#FF9FDF","brand-secondary-guavapink_shade":"#D3168B","brand-secondary-guavapink_tint":"#FFE6F9","brand-secondary-juniperblue_base":"#00E2B7","brand-secondary-juniperblue_highlight":"#92FFEA","brand-secondary-juniperblue_shade":"#08A59D","brand-secondary-juniperblue_tint":"#E6FFFA","brand-secondary-limegreen_base":"#AEEF0F","brand-secondary-limegreen_highlight":"#E4FF45","brand-secondary-limegreen_shade":"#65B200","brand-secondary-limegreen_tint":"#F0FFB3","brand-secondary-orangered_base":"#FF4500","brand-secondary-orangered_highlight":"#FF8864","brand-secondary-orangered_shade":"#D82400","brand-secondary-orangered_tint":"#FFDAD7","brown-100":"#F1DFCF","brown-200":"#E9BE95","brown-25":"#FBF7F4","brown-300":"#DC9D5D","brown-400":"#BA854E","brown-50":"#F7EFE9","brown-500":"#9A6D3F","brown-600":"#7B5631","brown-700":"#5D4023","brown-75":"#F4E7DC","brown-800":"#3F2C19","brown-900":"#221A11","brown-950":"#15100A","coolgray-100":"#DBE4E9","coolgray-150":"#C9D7DE","coolgray-200":"#B7CAD4","coolgray-25":"#F6F8F9","coolgray-250":"#A4BDCA","coolgray-300":"#97AFBC","coolgray-350":"#8BA2AD","coolgray-400":"#7F949F","coolgray-450":"#748791","coolgray-50":"#EEF1F3","coolgray-500":"#667780","coolgray-525":"#576F76","coolgray-550":"#5C6C74","coolgray-600":"#536168","coolgray-650":"#48545B","coolgray-700":"#3D494E","coolgray-75":"#E5EBEE","coolgray-750":"#333D42","coolgray-800":"#2A3236","coolgray-850":"#21272A","coolgray-900":"#181C1F","coolgray-950":"#0E1113","global-black":{light:"#000000",dark:"#000000"},"global-brand-orangered":{light:"#FF4500",dark:"#FF4500"},"global-white":{light:"#FFFFFF",dark:"#FFFFFF"},"kiwigreen-100":"#A8F5A0","kiwigreen-200":"#58E15B","kiwigreen-25":"#EBFDE7","kiwigreen-300":"#00C61C","kiwigreen-400":"#01A816","kiwigreen-50":"#DDF8D7","kiwigreen-500":"#008A10","kiwigreen-600":"#016E0B","kiwigreen-700":"#005306","kiwigreen-75":"#CAF5C2","kiwigreen-800":"#033902","kiwigreen-900":"#0D2005","kiwigreen-950":"#081404","lightblue-100":"#CAE7FB","lightblue-200":"#87D0FD","lightblue-25":"#F3F9FD","lightblue-300":"#02B9FB","lightblue-400":"#029DD5","lightblue-50":"#E6F3FC","lightblue-500":"#007FAE","lightblue-600":"#01668D","lightblue-700":"#014D6B","lightblue-75":"#D9EDFB","lightblue-800":"#03354B","lightblue-900":"#051E2B","lightblue-950":"#04131A","lime-100":"#B7F28E","lime-200":"#90DA58","lime-25":"#EEFDDC","lime-300":"#6DBF01","lime-400":"#5BA200","lime-50":"#E0F8C8","lime-500":"#4A8500","lime-600":"#3A6A00","lime-700":"#2A5000","lime-75":"#CEF5AD","lime-800":"#1E3702","lime-900":"#151E05","lime-950":"#0D1304","mintgreen-100":"#9BF5D9","mintgreen-200":"#00E2B7","mintgreen-25":"#E7FDF5","mintgreen-300":"#00C29D","mintgreen-400":"#01A484","mintgreen-50":"#D7F8EC","mintgreen-500":"#01876D","mintgreen-600":"#006C56","mintgreen-700":"#015140","mintgreen-75":"#C0F5E3","mintgreen-800":"#00382B","mintgreen-900":"#032019","mintgreen-950":"#03140F","orangered-100":"#FCDBCF","orangered-200":"#FDB498","orangered-25":"#FDF6F4","orangered-300":"#FF895D","orangered-400":"#FF4500","orangered-50":"#FCEEE8","orangered-500":"#D93900","orangered-600":"#AE2C00","orangered-700":"#842100","orangered-75":"#FBE5DC","orangered-800":"#591B02","orangered-900":"#2F1405","orangered-950":"#1C0D04","periwinkle-100":"#E6DFFB","periwinkle-200":"#CDBEFD","periwinkle-25":"#F9F7FD","periwinkle-300":"#B29FFF","periwinkle-400":"#9580FF","periwinkle-50":"#F2EFFC","periwinkle-500":"#6A5CFF","periwinkle-600":"#523DFF","periwinkle-700":"#4001EA","periwinkle-75":"#ECE7FB","periwinkle-800":"#250AA6","periwinkle-900":"#160E5B","periwinkle-950":"#0C083F","poopbrown-100":"#FEEEDD","poopbrown-200":"#F6DDC3","poopbrown-300":"#EECCAA","poopbrown-400":"#CAA075","poopbrown-50":"#FEF7EE","poopbrown-500":"#9A6D3F","poopbrown-600":"#6E4924","poopbrown-700":"#54371A","poopbrown-800":"#3B2510","poopbrown-900":"#29190A","poopbrown-950":"#110B04","puregray-100":"#F2F2F2","puregray-150":"#EBEBEB","puregray-200":"#E4E4E4","puregray-250":"#DDDDDD","puregray-300":"#D6D6D6","puregray-350":"#C3C3C3","puregray-400":"#ACACAC","puregray-450":"#919191","puregray-50":"#F8F8F8","puregray-500":"#767676","puregray-550":"#5C5C5C","puregray-600":"#434343","puregray-650":"#393939","puregray-700":"#303030","puregray-750":"#272727","puregray-800":"#1E1E1E","puregray-850":"#181818","puregray-900":"#131313","puregray-950":"#080808","red-100":"#FBDBD4","red-200":"#FDB3A4","red-25":"#FDF6F5","red-300":"#FF8773","red-400":"#FF4F40","red-50":"#FCEEEA","red-500":"#EB001F","red-600":"#BC0117","red-700":"#90000F","red-75":"#FBE4DF","red-800":"#650405","red-900":"#340F05","red-950":"#1F0B04","sakurapink-100":"#FBD9EB","sakurapink-200":"#FDAEDA","sakurapink-25":"#FDF6F9","sakurapink-300":"#FF7ECA","sakurapink-400":"#FF38BB","sakurapink-50":"#FCEDF4","sakurapink-500":"#DE019F","sakurapink-600":"#B2007F","sakurapink-700":"#880060","sakurapink-75":"#FBE3EF","sakurapink-800":"#5F0443","sakurapink-900":"#380626","sakurapink-950":"#250419",transparent:"transparent",white:"#ffffff","white-opacity-0":"#FFFFFF00","white-opacity-10":"#FFFFFF19","white-opacity-15":"#FFFFFF26","white-opacity-20":"#FFFFFF33","white-opacity-25":"#FFFFFF3F","white-opacity-5":"#FFFFFF0C","white-opacity-50":"#FFFFFF7F","yellow-100":"#FFE284","yellow-200":"#FFBF0B","yellow-25":"#FFF9E0","yellow-300":"#D8A100","yellow-400":"#B78800","yellow-50":"#FFF3C0","yellow-500":"#977000","yellow-600":"#785800","yellow-700":"#5B4200","yellow-75":"#FFEAA2","yellow-800":"#3F2D00","yellow-900":"#231A03","yellow-950":"#161003","yelloworange-100":"#FCDCC8","yelloworange-200":"#FDB586","yelloworange-25":"#FDF7F3","yelloworange-300":"#FF8A35","yelloworange-400":"#E46C00","yelloworange-50":"#FCEEE6","yelloworange-500":"#BD5800","yelloworange-600":"#974500","yelloworange-700":"#733300","yelloworange-75":"#FBE5D7","yelloworange-800":"#4E2402","yelloworange-900":"#2A1705","yelloworange-950":"#1A0E04","action-downvote":{light:"#6A5CFF",dark:"#6A5CFF"},"action-upvote":{light:"#D93900",dark:"#D93900"},"ai-background-weaker":{light:"#E7FDF5",dark:"#00382B"},"ai-plain":{light:"#006C56",dark:"#01A484"},"ai-plain-hover":{light:"#015140",dark:"#00C29D"},"alert-caution":{light:"#977000",dark:"#977000"},"avatar-gradient":{light:"",dark:""},"avatar-media-gradient":{light:"",dark:""},"brand-background":{light:"#D93900",dark:"#D93900"},"brand-background-hover":{light:"#AE2C00",dark:"#AE2C00"},"brand-gradient-active":{light:"",dark:""},"brand-gradient-active-highlight":{light:"",dark:""},"brand-gradient-default":{light:"",dark:""},"brand-gradient-default-highlight":{light:"",dark:""},"brand-gradient-hover":{light:"",dark:""},"brand-gradient-hover-highlight":{light:"",dark:""},"brand-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"category-live":{light:"#D93900",dark:"#D93900"},"category-nsfw":{light:"#DE019F",dark:"#DE019F"},"category-spoiler":{light:"#131313",dark:"#F2F2F2"},"caution-background":{light:"#FFBF0B",dark:"#D8A100"},"caution-background-hover":{light:"#D8A100",dark:"#FFBF0B"},"caution-onBackground":{light:"#000000",dark:"#000000"},"caution-plain":{light:"#785800",dark:"#FFBF0B"},"caution-plain-hover":{light:"#5B4200",dark:"#FFE284"},"danger-background":{light:"#EB001F",dark:"#BC0117"},"danger-background-disabled":{light:"#FDB3A4",dark:"#340F05"},"danger-background-hover":{light:"#BC0117",dark:"#EB001F"},"danger-background-weaker":{light:"#FBDBD4",dark:"#650405"},"danger-content":{light:"#BC0117",dark:"#FF4F40"},"danger-content-default":{light:"#ffffff",dark:"#ffffff"},"danger-content-hover":{light:"#90000F",dark:"#FF8773"},"danger-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"danger-plain":{light:"#BC0117",dark:"#FF8773"},"danger-plain-hover":{light:"#90000F",dark:"#FDB3A4"},"downvote-background":{light:"#6A5CFF",dark:"#6A5CFF"},"downvote-background-disabled":{light:"#6a5cff4d",dark:"#6a5cff4d"},"downvote-background-hover":{light:"#523DFF",dark:"#523DFF"},"downvote-content":{light:"#523DFF",dark:"#9580FF"},"downvote-content-weak":{light:"#6A5CFF",dark:"#6A5CFF"},"downvote-disabled":{light:"#523DFF4c",dark:"#9580FF4c"},"downvote-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"downvote-onStrongScrim":{light:"#B29FFF",dark:"#B29FFF"},"downvote-onStrongScrim-disabled":{light:"#b29fff4d",dark:"#b29fff4d"},"downvote-onStrongScrim-weaker":{light:"#9580FF",dark:"#9580FF"},"downvote-plain":{light:"#523DFF",dark:"#9580FF"},"downvote-plain-disabled":{light:"#523dff4d",dark:"#9580ff4d"},"downvote-plain-weaker":{light:"#6A5CFF",dark:"#6A5CFF"},"elevation-large1":{light:"#0000003F",dark:"#0000007F"},"elevation-large2":{light:"#00000026",dark:"#00000033"},"elevation-medium1":{light:"#0000003F",dark:"#0000007F"},"elevation-medium2":{light:"#00000019",dark:"#00000033"},"elevation-small":{light:"#00000026",dark:"#00000054"},"elevation-xsmall":{light:"#0000003F",dark:"#000000AA"},favorite:{light:"#977000",dark:"#B78800"},"global-admin":{light:"#D93900",dark:"#D93900"},"global-alienblue":{light:"#1870F4",dark:"#1870F4"},"global-darkblue":{light:"#2A3236",dark:"#2A3236"},"global-focus":{light:"Highlight",dark:"Highlight"},"global-gold":{light:"#B78800",dark:"#D8A100"},"global-moderator":{light:"#008A10",dark:"#008A10"},"global-nsfw":{light:"#DE019F",dark:"#DE019F"},"global-offline":{light:"#667780",dark:"#667780"},"global-online":{light:"#00C61C",dark:"#00C61C"},"global-orangered":{light:"#FF4500",dark:"#FF4500"},"global-stars":{light:"#977000",dark:"#D8A100"},"gradient-media":{light:"",dark:""},"gradient-media-strong":{light:"",dark:""},"identity-admin":{light:"#D93900",dark:"#D93900"},"identity-coins":{light:"#B78800",dark:"#B78800"},"identity-moderator":{light:"#008A10",dark:"#008A10"},"identity-self":{light:"#01876D",dark:"#01876D"},"interactive-background-disabled":{light:"#0000000C",dark:"#FFFFFF0C"},"interactive-content-disabled":{light:"#0000003F",dark:"#FFFFFF3F"},"interactive-focused":{light:"#007FAE",dark:"#007FAE"},"interactive-pressed":{light:"#00000026",dark:"#FFFFFF26"},"inverted-interactive-background-disabled":{light:"#FFFFFF0C",dark:"#0000000C"},"inverted-interactive-content-disabled":{light:"#FFFFFF3F",dark:"#0000003F"},"inverted-interactive-pressed":{light:"#FFFFFF26",dark:"#00000026"},"inverted-neutral-background":{light:"#0E1113",dark:"#FFFFFF"},"inverted-neutral-background-hover":{light:"#181C1F",dark:"#F6F8F9"},"inverted-neutral-border":{light:"#FFFFFF33",dark:"#00000033"},"inverted-neutral-content":{light:"#B7CAD4",dark:"#333D42"},"inverted-neutral-content-strong":{light:"#EEF1F3",dark:"#181C1F"},"inverted-secondary-background":{light:"#2A3236",dark:"#E5EBEE"},"inverted-secondary-background-hover":{light:"#333D42",dark:"#DBE4E9"},"inverted-secondary-background-selected":{light:"#3D494E",dark:"#C9D7DE"},"inverted-secondary-onBackground":{light:"#FFFFFF",dark:"#000000"},"inverted-secondary-plain":{light:"#DBE4E9",dark:"#181C1F"},"inverted-secondary-plain-hover":{light:"#FFFFFF",dark:"#000000"},"media-background":{light:"#00000099",dark:"#00000099"},"media-background-hover":{light:"#000000cc",dark:"#000000cc"},"media-background-selected":{light:"#000000cc",dark:"#000000cc"},"media-border-selected":{light:"#FFFFFF",dark:"#FFFFFF"},"media-border-weak":{light:"#FFFFFF19",dark:"#FFFFFF19"},"media-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"media-onBackground-disabled":{light:"#FFFFFF3F",dark:"#FFFFFF3F"},"media-onBackground-weak":{light:"#E5EBEE",dark:"#E5EBEE"},"media-onbackground":{light:"#ffffff",dark:"#ffffff"},"media-onbackground-disabled":{light:"#ffffff3f",dark:"#ffffff3f"},"media-onbackground-weak":{light:"#B7CAD4",dark:"#B7CAD4"},"neutral-background":{light:"#FFFFFF",dark:"#0E1113"},"neutral-background-container":{light:"#F6F8F9",dark:"#181C1F"},"neutral-background-container-hover":{light:"#EEF1F3",dark:"#21272A"},"neutral-background-container-strong":{light:"#EEF1F3",dark:"#21272A"},"neutral-background-container-strong-hover":{light:"#E5EBEE",dark:"#2A3236"},"neutral-background-gilded":{light:"#FFF9E0",dark:"#181C1F"},"neutral-background-gilded-hover":{light:"#FFF3C0",dark:"#21272A"},"neutral-background-highlighted":{light:"#F6F8F9",dark:"#181C1F"},"neutral-background-highlighted-strong":{light:"#FFF9E0",dark:"#2A3236"},"neutral-background-hover":{light:"#F6F8F9",dark:"#181C1F"},"neutral-background-medium":{light:"#F8F8F8",dark:"#131313"},"neutral-background-pinned":{light:"#FFFFFF",dark:"#0E1113"},"neutral-background-selected":{light:"#E5EBEE",dark:"#2A3236"},"neutral-background-strong":{light:"#FFFFFF",dark:"#181C1F"},"neutral-background-strong-hover":{light:"#F6F8F9",dark:"#21272A"},"neutral-background-weak":{light:"#F6F8F9",dark:"#000000"},"neutral-background-weak-hover":{light:"#EEF1F3",dark:"#0E1113"},"neutral-border":{light:"#00000033",dark:"#FFFFFF33"},"neutral-border-medium":{light:"#0000007F",dark:"#FFFFFF7F"},"neutral-border-strong":{light:"#181C1F",dark:"#F6F8F9"},"neutral-border-weak":{light:"#00000019",dark:"#FFFFFF19"},"neutral-content":{light:"#333D42",dark:"#B7CAD4"},"neutral-content-disabled":{light:"#D6D6D6",dark:"#303030"},"neutral-content-strong":{light:"#181C1F",dark:"#EEF1F3"},"neutral-content-weak":{light:"#5C6C74",dark:"#8BA2AD"},offline:{light:"#767676",dark:"#767676"},online:{light:"#01A816",dark:"#01A816"},"opacity-08":{light:"#13131314",dark:"#13131314"},"opacity-50":{light:"#0000007f",dark:"#F2F2F27f"},"opacity-highlight":{light:"",dark:""},pizzaRed:{light:"#ef5350",dark:"#c62828"},primary:{light:"#115BCA",dark:"#648EFC"},"primary-background":{light:"#0A449B",dark:"#115BCA"},"primary-background-hover":{light:"#0A2F6C",dark:"#1870F4"},"primary-background-selected":{light:"#0A1A3F",dark:"#648EFC"},"primary-border":{light:"#0A449B",dark:"#648EFC"},"primary-border-hover":{light:"#0A2F6C",dark:"#90A9FD"},"primary-hover":{light:"#0A449B",dark:"#90A9FD"},"primary-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"primary-onBackground-selected":{light:"#FFFFFF",dark:"#000000"},"primary-plain":{light:"#0A449B",dark:"#648EFC"},"primary-plain-hover":{light:"#0A2F6C",dark:"#90A9FD"},"primary-plain-visited":{light:"#7600A3",dark:"#CF5FFF"},"primary-visited":{light:"#9B00D4",dark:"#CF5FFF"},scrim:{light:"#00000099",dark:"#00000099"},"scrim-background":{light:"#00000099",dark:"#00000099"},"scrim-background-strong":{light:"#000000CC",dark:"#000000CC"},"scrim-gradient":{light:"",dark:""},"scrim-strong":{light:"#000000cc",dark:"#000000cc"},secondary:{light:"#21272A",dark:"#DBE4E9"},"secondary-background":{light:"#E5EBEE",dark:"#2A3236"},"secondary-background-hover":{light:"#DBE4E9",dark:"#333D42"},"secondary-background-selected":{light:"#C9D7DE",dark:"#3D494E"},"secondary-hover":{light:"#000000",dark:"#ffffff"},"secondary-onBackground":{light:"#000000",dark:"#FFFFFF"},"secondary-plain":{light:"#181C1F",dark:"#DBE4E9"},"secondary-plain-hover":{light:"#000000",dark:"#FFFFFF"},"secondary-plain-weak":{light:"#5C6C74",dark:"#8BA2AD"},"secondary-weak":{light:"#576F76",dark:"#748791"},"success-background":{light:"#008A10",dark:"#016E0B"},"success-background-hover":{light:"#016E0B",dark:"#008A10"},"success-content":{light:"#016E0B",dark:"#01A816"},"success-hover":{light:"#005306",dark:"#00C61C"},"success-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"success-plain":{light:"#016E0B",dark:"#00C61C"},"success-plain-hover":{light:"#005306",dark:"#58E15B"},"tone-1":{light:"#131313",dark:"#F2F2F2"},"tone-2":{light:"#434343",dark:"#ACACAC"},"tone-3":{light:"#ACACAC",dark:"#434343"},"tone-4":{light:"#E4E4E4",dark:"#303030"},"tone-5":{light:"#F2F2F2",dark:"#1E1E1E"},"tone-6":{light:"#F8F8F8",dark:"#131313"},"tone-7":{light:"#ffffff",dark:"#080808"},"transparent-background-hover":{light:"#74879119",dark:"#66778019"},"ui-canvas":{light:"#F2F2F2",dark:"#080808"},"ui-modalbackground":{light:"#FFFFFF",dark:"#181C1F"},"upvote-background":{light:"#D93900",dark:"#D93900"},"upvote-background-disabled":{light:"#d939004d",dark:"#d939004d"},"upvote-background-hover":{light:"#AE2C00",dark:"#AE2C00"},"upvote-content":{light:"#AE2C00",dark:"#FF4500"},"upvote-content-weak":{light:"#FF4500",dark:"#FF4500"},"upvote-disabled":{light:"#AE2C004c",dark:"#FF45004c"},"upvote-onBackground":{light:"#FFFFFF",dark:"#FFFFFF"},"upvote-onStrongScrim":{light:"#FF895D",dark:"#FF895D"},"upvote-onStrongScrim-disabled":{light:"#ff895d4d",dark:"#ff895d4d"},"upvote-onStrongScrim-weaker":{light:"#FF4500",dark:"#FF4500"},"upvote-plain":{light:"#AE2C00",dark:"#FF895D"},"upvote-plain-disabled":{light:"#ae2c004d",dark:"#ff895d4d"},"upvote-plain-weaker":{light:"#FF4500",dark:"#FF4500"},"warning-background":{light:"#B78800",dark:"#B78800"},"warning-background-hover":{light:"#977000",dark:"#D8A100"},"warning-content":{light:"#785800",dark:"#B78800"},"warning-content-hover":{light:"#5B4200",dark:"#D8A100"},"warning-onBackground":{light:"#000000",dark:"#000000"}};var Vd={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",transparent:"#FFFFFF00",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},$d=r=>!!r.match(/^(#[0-9a-fA-F]{3,8}).*/),zd=r=>r in Ba,Ua=r=>r in Vd,Kd=r=>!!r.match(/^rgba?\(.*/),qd=r=>!!r.match(/^hsla?\(.*/),Jd=(r,e="light")=>{if(Ua(r))return ln(r);let i=Ba[r];return typeof i=="string"?i:i[e]},ln=r=>Vd[r]??r,Zd=r=>{let[e,t,i,s]=r.replace(/^rgba?\(|\s+|\)$/g,"").split(",");if(!e||!t||!i)return r;let o=[...[e,t,i].map(l=>parseFloat(l))];if(s){let l=parseFloat(s),f=Math.round(l*255);o.push(f)}return`#${o.map(l=>l.toString(16).padStart(2,"0")).join("")}`};import{BlockStackDirection as un}from"@devvit/protos";var Oa={stackParentLayout:{hasHeight:!0,hasWidth:!0,direction:un.UNRECOGNIZED,alignment:void 0}},Ke;(function(r){r[r.NONE=0]="NONE",r[r.HORIZONTAL=1]="HORIZONTAL",r[r.VERTICAL=2]="VERTICAL"})(Ke||(Ke={}));function Xd(r,e,t){if(!e)return{hasHeight:!1,hasWidth:!1};let{growDirection:i,stretchDirection:s}=Pf(r?.grow,e.direction,e.alignment),n=t?.height?.value?.value||t?.height?.min?.value||Qd(Ke.VERTICAL,i,s,e.hasHeight),o=t?.width?.value?.value||t?.width?.min?.value||Qd(Ke.HORIZONTAL,i,s,e.hasWidth);return{hasHeight:!!n,hasWidth:!!o}}function Qd(r,e,t,i){return e===r&&i||t===r&&i}function Pf(r,e,t){let i=e===un.STACK_VERTICAL||e===un.UNRECOGNIZED,s=e===un.STACK_HORIZONTAL,n=Ke.NONE;s&&r?n=Ke.HORIZONTAL:i&&r&&(n=Ke.VERTICAL);let o=t===void 0||t.horizontal===void 0,c=t===void 0||t.vertical===void 0,l=s?!!c:i?!!o:!1,f=Ke.NONE;return s&&l?f=Ke.VERTICAL:i&&l&&(f=Ke.HORIZONTAL),{growDirection:n,stretchDirection:f}}import{BlockSizeUnit as Wt,BlockStackDirection as hn}from"@devvit/protos";function Mr(r){if(r==null)return;if(typeof r=="number")return{value:r,unit:Wt.SIZE_UNIT_PERCENT};let e=r.match(/^(\d+(?:\.\d+)?)(px|%)?$/);if(e==null)return;let t=Wt.SIZE_UNIT_PERCENT;return e.at(2)==="px"&&(t=Wt.SIZE_UNIT_PIXELS),{value:Number.parseFloat(e[1]),unit:t}}function If(r,e){return(r.width?.value?.unit===Wt.SIZE_UNIT_PERCENT||r.width?.min?.unit===Wt.SIZE_UNIT_PERCENT)&&(e.direction===hn.STACK_HORIZONTAL||e.direction===hn.STACK_DEPTH)&&(e.hasWidth||(r.width=void 0)),(r.height?.value?.unit===Wt.SIZE_UNIT_PERCENT||r.height?.min?.unit===Wt.SIZE_UNIT_PERCENT)&&(e.direction===hn.STACK_VERTICAL||e.direction===hn.STACK_DEPTH)&&(e.hasHeight||(r.height=void 0)),r}function La(r,e){if(r){let t=r.width!=null||r.minWidth!=null||r.maxWidth!=null,i=r.height!=null||r.minHeight!=null||r.maxHeight!=null;if(t||i||r.grow!=null){let s={width:t?{value:Mr(r.width),min:Mr(r.minWidth),max:Mr(r.maxWidth)}:void 0,height:i?{value:Mr(r.height),min:Mr(r.minHeight),max:Mr(r.maxHeight)}:void 0,grow:r.grow};return e.stackParentLayout&&(s=If(s,e.stackParentLayout)),s}}}var Tf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Sf=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},wn,rl="data-",xf=new Set(["onPress","onMessage"]),Rf=new Map([["onPress",qa.ACTION_CLICK],["onMessage",qa.ACTION_WEBVIEW]]),Dr=class{constructor(e=()=>{}){wn.set(this,void 0),Tf(this,wn,e,"f")}createBlocksElementOrThrow({type:e,props:t,children:i}){let s=this.createBlocksElement({type:e,props:t,children:i},Oa);if(!s)throw new Error(`Could not create block of type ${e}`);return s}createBlocksElement({type:e,props:t,children:i},s){switch(e){case"blocks":return this.makeRoot(t,...i);case"hstack":return this.makeHStack(t,s,...i);case"vstack":return this.makeVStack(t,s,...i);case"zstack":return this.makeZStack(t,s,...i);case"text":return this.makeText(t,s,...i);case"button":return this.makeButton(t,s,...i);case"image":return this.makeImage(t,s);case"spacer":return this.makeSpacer(t,s);case"icon":return this.makeIcon(t,s);case"avatar":return this.makeAvatar(t,s);case"webview":return this.makeWebView(t,s);case"__fragment":throw new Error("root fragment is not supported - use 'blocks' instead")}}makeRootHeight(e){switch(e){case"regular":return 320;case"tall":return 512}}makeBlockPadding(e){switch(e){case"none":return hi.PADDING_NONE;case"xsmall":return hi.PADDING_XSMALL;case"small":return hi.PADDING_SMALL;case"medium":return hi.PADDING_MEDIUM;case"large":return hi.PADDING_LARGE}}makeBlockRadius(e){switch(e){case"none":return fi.RADIUS_NONE;case"small":return fi.RADIUS_SMALL;case"medium":return fi.RADIUS_MEDIUM;case"large":return fi.RADIUS_LARGE;case"full":return fi.RADIUS_FULL}}makeBlockGap(e){switch(e){case"none":return mn.GAP_NONE;case"small":return mn.GAP_SMALL;case"medium":return mn.GAP_MEDIUM;case"large":return mn.GAP_LARGE}}makeBlockAlignment(e){if(e===void 0)return;let t,i;if(e.includes("top")?t=Ka.ALIGN_TOP:e.includes("middle")?t=Ka.ALIGN_MIDDLE:e.includes("bottom")&&(t=Ka.ALIGN_BOTTOM),e.includes("start")?i=Ha.ALIGN_START:e.includes("center")?i=Ha.ALIGN_CENTER:e.includes("end")&&(i=Ha.ALIGN_END),t!==void 0||i!==void 0)return{vertical:t,horizontal:i}}makeBlockBorder(e,t,i,s){if(!e&&!t)return;let n;switch(e){case"none":n=fn.BORDER_WIDTH_NONE;break;case"thin":n=fn.BORDER_WIDTH_THIN;break;case"thick":n=fn.BORDER_WIDTH_THICK;break;default:n=fn.BORDER_WIDTH_THIN;break}let o=t??"neutral-border-weak",c=this.getThemedColors(o,i,s);return{width:n,color:c?.light,colors:c}}makeBlockTextSize(e){switch(e){case"xsmall":return Nr.TEXT_SIZE_XSMALL;case"small":return Nr.TEXT_SIZE_SMALL;case"medium":return Nr.TEXT_SIZE_MEDIUM;case"large":return Nr.TEXT_SIZE_LARGE;case"xlarge":return Nr.TEXT_SIZE_XLARGE;case"xxlarge":return Nr.TEXT_SIZE_XXLARGE}}makeBlockTextStyle(e){switch(e){case"body":return za.TEXT_STYLE_BODY;case"metadata":return za.TEXT_STYLE_METADATA;case"heading":return za.TEXT_STYLE_HEADING}}makeBlockTextOutline(e){switch(e){case"none":return Va.TEXT_OUTLINE_NONE;case"thin":return Va.TEXT_OUTLINE_THIN;case"thick":return Va.TEXT_OUTLINE_THICK}}makeBlockTextWeight(e){switch(e){case"regular":return tl.TEXT_WEIGHT_REGULAR;case"bold":return tl.TEXT_WEIGHT_BOLD}}makeBlockTextOverflow(e){switch(e){case"clip":return $a.TEXT_OVERFLOW_CLIP;case"ellipsis":return $a.TEXT_OVERFLOW_ELLIPSE}return $a.TEXT_OVERFLOW_ELLIPSE}makeBlockButtonAppearance(e){switch(e){case"secondary":return bt.BUTTON_APPEARANCE_SECONDARY;case"primary":return bt.BUTTON_APPEARANCE_PRIMARY;case"plain":return bt.BUTTON_APPEARANCE_PLAIN;case"bordered":return bt.BUTTON_APPEARANCE_BORDERED;case"media":return bt.BUTTON_APPEARANCE_MEDIA;case"destructive":return bt.BUTTON_APPEARANCE_DESTRUCTIVE;case"caution":return bt.BUTTON_APPEARANCE_CAUTION;case"success":return bt.BUTTON_APPEARANCE_SUCCESS}}makeBlockButtonSize(e){switch(e){case"small":return Wa.BUTTON_SIZE_SMALL;case"medium":return Wa.BUTTON_SIZE_MEDIUM;case"large":return Wa.BUTTON_SIZE_LARGE}}makeBlockImageResizeMode(e){switch(e){case"none":return ui.IMAGE_RESIZE_NONE;case"fit":return ui.IMAGE_RESIZE_FIT;case"fill":return ui.IMAGE_RESIZE_FILL;case"cover":return ui.IMAGE_RESIZE_COVER;case"scale-down":return ui.IMAGE_RESIZE_SCALE_DOWN}}makeBlockSpacerSize(e){switch(e){case"xsmall":return gn.SPACER_XSMALL;case"small":return gn.SPACER_SMALL;case"medium":return gn.SPACER_MEDIUM;case"large":return gn.SPACER_LARGE}}makeBlockSpacerShape(e){switch(e){case"invisible":return ja.SPACER_INVISIBLE;case"thin":return ja.SPACER_THIN;case"square":return ja.SPACER_SQUARE}}makeBlockIconSize(e){switch(e){case"xsmall":return pn.ICON_SIZE_XSMALL;case"small":return pn.ICON_SIZE_SMALL;case"medium":return pn.ICON_SIZE_MEDIUM;case"large":return pn.ICON_SIZE_LARGE}}makeBlockAvatarSize(e){switch(e){case"xxsmall":return yt.AVATAR_SIZE_XXSMALL;case"xsmall":return yt.AVATAR_SIZE_XSMALL;case"small":return yt.AVATAR_SIZE_SMALL;case"medium":return yt.AVATAR_SIZE_MEDIUM;case"large":return yt.AVATAR_SIZE_LARGE;case"xlarge":return yt.AVATAR_SIZE_XXLARGE;case"xxlarge":return yt.AVATAR_SIZE_XXLARGE;case"xxxlarge":return yt.AVATAR_SIZE_XXXLARGE}}makeBlockAvatarFacing(e){switch(e){case"left":return el.AVATAR_FACING_LEFT;case"right":return el.AVATAR_FACING_RIGHT}}makeBlockAvatarBackground(e){switch(e){case"dark":return Yd.AVATAR_BG_DARK;case"light":return Yd.AVATAR_BG_LIGHT}}getDataSet(e){return Object.keys(e).filter(t=>t.startsWith(rl)).reduce((t,i)=>(t[i.substring(rl.length)]=e[i],t),{})}makeActions(e,t){let i=[],s=this.getDataSet(t);return xf.forEach(n=>{if(n in t){let o=t[n];i.push({type:Rf.get(n)??qa.UNRECOGNIZED,id:o.toString(),data:s})}}),i}blockColorToHex(e,t="light"){if(e)return e=e.toLowerCase(),$d(e)?e:zd(e)?Jd(e,t):Ua(e)?ln(e):Kd(e)?Zd(e):qd(e)?e:(console.warn(`Could not parse color: ${e}.`),ln("red"))}childrenToBlocks(e,t){return e.flatMap(i=>(typeof i!="string"?this.createBlocksElement(i,t):void 0)??[])}getThemedColors(e,t,i){let s=this.blockColorToHex(t,"light"),n=this.blockColorToHex(i,"dark"),o=[];if(e&&(!s||!n)){let c=Array.from(e?.matchAll(/[\w#-]+(?:\([\w\t ,.#-]+\))?/g)??[]);o.push(...c.map(l=>l[0]))}return s||(s=this.blockColorToHex(o?.at(0),"light")),n||(n=this.blockColorToHex(o?.at(1)??o?.at(0),"dark")),s||n?{light:s,dark:n}:void 0}parsePixels(e){return typeof e=="string"?Number(e.slice(0,-2)):e}resolveAssetUrl(e,t){return Sf(this,wn,"f").call(this)?.getURL(e,t)??e}childrenToString(e){return e.map(t=>t.toString()).join("")}makeRoot(e,...t){return this.wrapRoot(e,this.childrenToBlocks(t,Oa))}wrapRoot(e,t){return this.makeBlock(qe.BLOCK_ROOT,{},{},{rootConfig:{children:t,height:this.makeRootHeight(a.customPostType?.height??e?.height??"regular")}})}makeStackBlock(e,t,i,s){let n=this.getThemedColors(t?.backgroundColor,t?.lightBackgroundColor,t?.darkBackgroundColor),o=this.makeBlockAlignment(t?.alignment),c=La(t,i),l=Xd(t,i.stackParentLayout,c);return this.makeBlock(qe.BLOCK_STACK,t,i,{stackConfig:{alignment:o,backgroundColor:n?.light,backgroundColors:n,border:this.makeBlockBorder(t?.border,t?.borderColor,t?.lightBorderColor,t?.darkBorderColor),children:this.childrenToBlocks(s,{stackParentLayout:{...l,direction:e,alignment:o}}),cornerRadius:this.makeBlockRadius(t?.cornerRadius),direction:e,gap:this.makeBlockGap(t?.gap),padding:this.makeBlockPadding(t?.padding),reverse:t?.reverse}})}makeHStack(e,t,...i){return this.makeStackBlock(Ga.STACK_HORIZONTAL,e,t,i)}makeVStack(e,t,...i){return this.makeStackBlock(Ga.STACK_VERTICAL,e,t,i)}makeZStack(e,t,...i){return this.makeStackBlock(Ga.STACK_DEPTH,e,t,i)}makeText(e,t,...i){let s=this.getThemedColors(e?.color,e?.lightColor,e?.darkColor);return this.makeBlock(qe.BLOCK_TEXT,e,t,{textConfig:{alignment:this.makeBlockAlignment(e?.alignment),color:s?.light,colors:s,outline:this.makeBlockTextOutline(e?.outline),size:this.makeBlockTextSize(e?.size),style:this.makeBlockTextStyle(e?.style),text:this.childrenToString(i),weight:this.makeBlockTextWeight(e?.weight),selectable:e?.selectable,wrap:e?.wrap,overflow:this.makeBlockTextOverflow(e?.overflow)}})}makeButton(e,t,...i){let s=this.getThemedColors(e?.textColor,e?.lightTextColor,e?.darkTextColor);return this.makeBlock(qe.BLOCK_BUTTON,e,t,{buttonConfig:{buttonAppearance:this.makeBlockButtonAppearance(e?.appearance),icon:e?.icon,buttonSize:this.makeBlockButtonSize(e?.size),text:this.childrenToString(i),textColor:s?.light,textColors:s,disabled:e?.disabled}})}makeImage(e,t){return e&&this.makeBlock(qe.BLOCK_IMAGE,e,t,{imageConfig:{description:e?.description,resizeMode:this.makeBlockImageResizeMode(e.resizeMode),url:this.resolveAssetUrl(e.url),width:this.parsePixels(e.imageWidth),height:this.parsePixels(e.imageHeight)}})}makeSpacer(e,t){return this.makeBlock(qe.BLOCK_SPACER,e,t,{spacerConfig:{size:this.makeBlockSpacerSize(e?.size),shape:this.makeBlockSpacerShape(e?.shape)}})}makeIcon(e,t){let i=this.getThemedColors(e?.color,e?.lightColor,e?.darkColor);return e&&this.makeBlock(qe.BLOCK_ICON,e,t,{iconConfig:{icon:e.name,color:i?.light,colors:i,size:this.makeBlockIconSize(e.size)}})}makeAvatar(e,t){return e&&this.makeBlock(qe.BLOCK_AVATAR,e,t,{avatarConfig:{thingId:e.thingId,size:this.makeBlockAvatarSize(e.size),facing:this.makeBlockAvatarFacing(e.facing),background:this.makeBlockAvatarBackground(e.background)}})}makeWebView(e,t){return e&&this.makeBlock(qe.BLOCK_WEBVIEW,e,t,{webviewConfig:{url:this.resolveAssetUrl(e.url,{webView:!0})}})}makeBlock(e,t,i,s){return{type:e,sizes:La(t,i),config:s,actions:(t&&this.makeActions(e,t))??[],id:t?.id,key:t?.key}}ensureRootBlock(e){let t;if(e.type===qe.BLOCK_ROOT?(e.config?.rootConfig&&a.customPostType?.height&&(e.config.rootConfig.height=this.makeRootHeight(a.customPostType?.height)),t=e):t=this.wrapRoot(void 0,[e]),!t)throw new Error("Could not create root block");return t}};wn=new WeakMap;var vt=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Mf=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},nt,nl,mi,ol,yn;function sl(r){if(typeof r=="string")throw new Error("Root element cannot be a string")}var al=r=>{let e="",t=r.props?Object.keys(r.props).map(i=>i==="onPress"?"":`${i}="${r.props[i]}"`).join(" "):"";e+=`<${r.type}${t?" "+t:""}>`;for(let i of r.children)typeof i=="string"?e+=i:e+=al(i);return e+=`</${r.type}>`,e};function Nf(r){return"  ".repeat(r)}function Df(r){let e="",t=0,i=r.split(/>\s*</);for(let s=0;s<i.length;s++){let n=i[s];s===0&&(n=n.trim()),s===i.length-1&&(n=n.trim());let o=n.charAt(0)==="/";o&&t--,e+=Nf(t),s!==0&&(e+="<"),e+=n,s!==i.length-1&&(e+=`>
`),!o&&n.indexOf("</")===-1&&n.charAt(n.length-1)!=="/"&&t++}return e}var ot=class{emitEffect(e,t){this.effects.push(t)}constructor(e,t,i,s,n){nt.add(this),this.renderState={},this.currentComponentKey=[],this.currentHookIndex=0,this.actions=new Map,this.forms=new Map,this.realtimeChannels=[],this.realtimeUpdated=!1,this.pendingHooks=[],this.isRendering=!1,this.transformer=new Dr(()=>this.assets),this.effects=[],yn.set(this,!1),this.component=e,this.event=t,this.state={__renderState:{},...i},this.metadata=s,this.state.__realtimeChannels&&(this.realtimeChannels=this.state.__realtimeChannels);let o=be({reconciler:this,hooks:!0,ui:!0,metadata:s});this.cache=o.cache,this.reddit=o.reddit,this.kvStore=o.kvStore,this.redis=o.redis,this.settings=o.settings,this.scheduler=o.scheduler,this.media=o.media,this.assets=o.assets,this.realtime=o.realtime,this.dimensions=n,this.ui=o.ui,this.hooks={useState:o.useState,useInterval:o.useInterval,useForm:o.useForm,useChannel:o.useChannel}}async render(){await this.reconcile(),this.isRendering=!0;let e=await this.buildBlocksUI();return this.isRendering=!1,e}makeUniqueActionID(e){let t=e,i=1;for(;this.actions.has(t);)t=`${e}.${i++}`;return t}async reconcile(){let e=vt(this,nt,"m",mi).call(this),t={type:this.component,props:e,children:[]},i=await this.processBlock(t);if(sl(i),this.transformer.createBlocksElementOrThrow(i),this.isUserActionRender&&this.blockRenderEventId){let s=this.actions.get(this.blockRenderEventId);s&&await s(this.event.data)}for(let s of this.pendingHooks)await s();this.buildNextState(),vt(this,nt,"m",nl).call(this)}async buildBlocksUI(){let e=vt(this,nt,"m",mi).call(this),t={type:this.component,props:e,children:[]},i=await this.renderElement(e,t);return this.transformer.ensureRootBlock(i)}async renderElement(e,t){let i=await this.processBlock(t);return sl(i),(a.debug.emitSnapshots||e.debug.emitSnapshots)&&console.debug(Df(al(i))),(a.debug.emitState||e.debug.emitState)&&console.debug(JSON.stringify(this.state,void 0,2)),this.transformer.createBlocksElementOrThrow(i)}async processProps(e){let t=e.props??{},i=["onPress","onMessage"];for(let s of i)if(s in t){let n=t[s],o=n?.name,c=this.makeUniqueActionID(`${e.type}.${o??s}`);this.actions.set(c,n),t[s]=c}}async processBlock(e,t=Gd(),i=[]){let s=e;if(typeof s.type=="string"){let c=[];for(let y=0;y<s.children.length;y++){let P=s.children[y];P!=null&&c.push(await this.processBlock(P,t,[...i,`${s.type}.${y}`]))}let l=c.flat(),f=vt(this,nt,"m",ol).call(this,l);return await this.processProps(s),{type:s.type,props:s.props,children:f}}if(typeof s.type=="function"){let c=t(`${i.length?i.join("."):"root"}.${s.type.name.length?s.type.name:"anonymous"}`);this.currentComponentKey.push(c),this.renderState[c]||(this.renderState[c]={});let l=s.children.flatMap(y=>y),f={...vt(this,nt,"m",mi).call(this),...s.props,children:l},v;for(;v===void 0;)try{v=await s.type(f,vt(this,nt,"m",mi).call(this))}catch(y){if(y instanceof Promise)v=await y;else throw y}if(!this.isInitialRender){let y=this.getPreviousComponentState();if(Object.keys(y).length!==this.currentHookIndex)throw new Error("Invalid hook call. Hooks can only be called at the top-level of a function component. Make sure that you are not calling hooks inside loops, conditions, or nested functions.")}if(this.currentComponentKey.pop(),this.currentHookIndex=0,typeof v=="object")return this.processBlock(v,t,[...i,s.type.name])}if(typeof s=="string")return s;if(typeof s=="number")return`${s}`;let n=[],o="";return Array.isArray(s)?n=s:typeof s.type>"u"&&s.children&&(n=s.children,o="fragmentChild."),{type:"__fragment",props:void 0,children:await Promise.all(n.flatMap(async(c,l)=>await this.processBlock(c,t,[...i,`${o}${l}`])))}}getCurrentComponentKey(){if(!this.currentComponentKey.at(-1))throw new Error("Current component key is missing");return this.currentComponentKey}getCurrentComponentState(){let e=this.currentComponentKey.at(-1);if(!e)throw new Error("Current component key is missing");return this.renderState[e]}getPreviousComponentState(){let e=this.currentComponentKey.at(-1);if(!e)throw new Error("Current component key is missing");return this.state.__renderState[e]||(this.state.__renderState[e]={}),this.state.__renderState[e]}get isInitialRender(){return this.event?this.event.type===Ja.RENDER_INITIAL:!1}get isUserActionRender(){return this.event?this.event.type===Ja.RENDER_USER_ACTION:!1}get isEffectRender(){return this.event?this.event.type===Ja.RENDER_EFFECT_EVENT:!1}get formSubmittedEvent(){return this.event?this.event.formSubmitted:!1}get blockRenderEventId(){return this.event?this.event.id:!1}get realtimeEvent(){if(!this.event)return!1;let e=this.event.realtimeEvent;return e?.event?.channel?e:!1}runHook(e){this.pendingHooks.push(e)}rerenderIn(e){vt(this,yn,"f")||(Mf(this,yn,!0,"f"),this.effects.push({type:il.EFFECT_RERENDER_UI,rerenderUi:{delaySeconds:e/1e3}}))}addRealtimeChannel(e){this.realtimeChannels.push(e),this.realtimeUpdated=!0}removeRealtimeChannel(e){this.realtimeChannels=this.realtimeChannels.filter(t=>t!==e),this.realtimeUpdated=!0}get realtimeEffect(){return this.realtimeUpdated&&this.realtimeChannels.length>0?[{type:il.EFFECT_REALTIME_SUB,realtimeSubscriptions:{subscriptionIds:this.realtimeChannels}}]:[]}getEffects(){return[...Rr(this.ui),...this.effects,...this.realtimeEffect]}buildNextState(){for(let e of Object.keys(this.renderState))this.renderState[e]=Object.values(this.renderState[e]);this.state={__postData:this.state.__postData,__renderState:this.renderState,__cache:this.state.__cache,...this.realtimeChannels.length>0?{__realtimeChannels:this.realtimeChannels}:{}}}};yn=new WeakMap,nt=new WeakSet,nl=function(){this.actions.clear(),this.currentComponentKey=[],this.currentHookIndex=0,this.pendingHooks=[],this.realtimeChannels=[],this.realtimeUpdated=!1},mi=function(){let e={...ue(this.metadata,this.state.__postData?.thingId),reddit:this.reddit,cache:this.cache,kvStore:this.kvStore,redis:this.redis,settings:this.settings,scheduler:this.scheduler,media:this.media,assets:this.assets,realtime:this.realtime,ui:this.ui,dimensions:this.dimensions,uiEnvironment:{timezone:this.metadata[A.Timezone]?.values[0],locale:this.metadata[A.Language]?.values[0],dimensions:this.dimensions},...this.hooks};return e.debug.effects=this,e},ol=function r(e){let t=[];for(let i of e)typeof i=="string"?t.push(i):i.type==="__fragment"?t.push(...vt(this,nt,"m",r).call(this,i.children)):t.push(i);return t};async function Of(r,e){let t=a.customPostType;if(!t)throw new Error("Custom post type not registered");let i=new ot((n,o)=>t.render(o),r.blocks,r.state,e,r.dimensions),s=await i.render();return Uf.fromJSON({state:i.state,blocks:{ui:s},effects:i.getEffects()})}function cl(r){r.provides(Bf),O("RenderPost",Of)}import{GetFieldsResponse as Lf,InstallationSettingsDefinition as Wf}from"@devvit/protos";async function Hf(){return Lf.fromJSON({fields:{fields:it(a.installationSettings??[])}})}async function jf(r,e){return dn(r,a.installationSettings,e)}function dl(r){r.provides(Wf),O("GetSettingsFields",Hf),O("ValidateForm",jf)}import{ContextActionDefinition as Gf,ContextActionList as Vf,ContextActionResponse as $f}from"@devvit/protos";function Za(r){let e=r.metadata[A.User].values[0];if(!e)throw new Error("User missing from context");return e}function Qa(r){let e=r.metadata[A.Subreddit].values[0];if(!e)throw new Error("Subreddit missing from context");return e}async function ll(r,e){let t=Za(r),i=Qa(r);if(!t||!i)throw new Error("User or subreddit missing from context");let s=e.comment?.id&&`t1_${e.comment.id}`,n=e.post?.id&&`t3_${e.post.id}`,o=e.subreddit?.id&&`t5_${e.subreddit.id}`,c=s||n||o;if(!c)throw new Error("targetId is missing from ContextActionRequest");if(s){let y=await r.reddit.getCommentById(s);if(!y)throw new Error(`Comment ${s} not found`);if(y.subredditId!==i)throw new Error("Comment does not belong to the subreddit")}if(n){let y=await r.reddit.getPostById(n);if(!y)throw new Error(`Post ${n} not found`);if(y.subredditId!==i)throw new Error("Post does not belong to the subreddit")}if(o&&o!==i)throw new Error(`Subreddit ${o} ${i} not found`);let l=pi(e.actionId);if(!l)throw new Error("Action not found");let f=!!l.forUserType?.includes("moderator");if(f&&!ul(r))throw new Error("User is not a moderator");let v={needsModCheck:f};await r.redis.set(`${t}${i}${c}${e.actionId}`,JSON.stringify(v)),await r.redis.expire(`${t}${i}${c}${e.actionId}`,600)}async function ul(r){let e=Za(r),t=Qa(r),i=await r.reddit.getSubredditInfoById(t);return!!(await r.reddit.getModerators({subredditName:i.name}).all()).find(n=>n.id===e)}async function hl(r,e){let t=Za(r),i=Qa(r),{actionId:s,thingId:n}=e.state?.__contextAction??{},o=await r.redis.get(`${t}${i}${n}${s}`);if(!o)throw new Error("CSRF token not found");if(JSON.parse(o).needsModCheck&&!await ul(r))throw new Error("User is not a moderator: "+t+"; "+i)}var fl=r=>`menuItem.${r}`;function pi(r){return a.menuItems.find((e,t)=>fl(t)===r)}function Xa(r,e){return r?Array.isArray(r.location)?r.location.includes(e):r.location===e:!1}async function zf(r,e){let i=a.menuItems.map((s,n)=>({actionId:fl(n),name:s.label,description:s.description,contexts:{subreddit:s.location.includes("subreddit"),post:s.location.includes("post"),comment:s.location.includes("comment")},users:{loggedOut:s.forUserType?.includes("loggedOut"),moderator:s.forUserType?.includes("moderator")},postFilters:s.postFilter==="currentApp"?{currentApp:!0}:void 0}));return Vf.fromJSON({actions:i})}async function Kf(r,e){let t=pi(r.actionId);if(!t)throw new Error(`MenuItem ${r.actionId} not found`);let i=r.comment?.id&&`t1_${r.comment.id}`,s=r.post?.id&&`t3_${r.post.id}`,n=r.subreddit?.id&&`t5_${r.subreddit.id}`,o=i||s||n;u(o,"targetId is missing from ContextActionRequest");let c={targetId:o,location:r.comment?"comment":r.post?"post":"subreddit"},l=Object.assign(be({ui:!0,metadata:e}),ue(e,s,i),{uiEnvironment:{timezone:e[A.Timezone]?.values[0],locale:e[A.Language]?.values[0]}});return await ll(l,r),await t.onPress(c,l),$f.fromJSON({effects:Rr(l.ui)})}function ml(r){r.provides(Gf),O("GetActions",zf),O("OnAction",Kf)}function Je(r){return r?r===!0?!0:r.enabled:!1}import{SchedulerHandlerDefinition as qf}from"@devvit/protos";async function Jf(r,e){let t=r.type,i=a.scheduledJobHandlers?.get(t);if(!i)throw new Error(`Job ${t} not found`);let s={name:t,data:r.data},n=Object.assign(be({metadata:e}),ue(e));return await i(s,n),{}}function pl(r){r.provides(qf),O("HandleScheduledAction",Jf)}import{OnAppInstallDefinition as Zf,OnAppUpgradeDefinition as Qf,OnAutomoderatorFilterCommentDefinition as Xf,OnAutomoderatorFilterPostDefinition as Yf,OnCommentCreateDefinition as em,OnCommentDeleteDefinition as tm,OnCommentReportDefinition as rm,OnCommentSubmitDefinition as im,OnCommentUpdateDefinition as sm,OnModActionDefinition as nm,OnModMailDefinition as om,OnPostCreateDefinition as am,OnPostDeleteDefinition as cm,OnPostFlairUpdateDefinition as dm,OnPostNsfwUpdateDefinition as lm,OnPostReportDefinition as um,OnPostSpoilerUpdateDefinition as hm,OnPostSubmitDefinition as fm,OnPostUpdateDefinition as mm}from"@devvit/protos";var Ht;(function(r){function e(o,c){return o.length<=c?o:`${o.slice(0,c-1)}\u2026`}r.ellipsize=e;function t(o){return o[0]==null?o:`${o[0].toLocaleUpperCase()}${o.slice(1)}`}r.capitalize=t;function i(o){return o==null||/^\s*$/.test(o)}r.isBlank=i;function s(o,c="stack"){return o instanceof Error?`${o[c]||o.stack||o.message||o.name}`:String(o)}r.caughtToString=s;function n(o,c="stack"){return o instanceof Error?`${o[c]||o.stack||o.message||o.name}`:String(o)}r.caughtToStringUntyped=n})(Ht||(Ht={}));function re(r,e){return u(e),async(t,i)=>{let s={...t,type:r},n=Object.assign(be({metadata:i}),ue(i)),o=await Promise.allSettled(e.map(l=>l(s,n))),c=pm(o);if(c)throw c.err;return{}}}function gl(r){for(let e of a.triggerOnEventHandlers.keys())switch(e){case"PostSubmit":r.provides(fm),O("OnPostSubmit",re("PostSubmit",a.triggerOnEventHandlers.get(e)));break;case"PostCreate":r.provides(am),O("OnPostCreate",re("PostCreate",a.triggerOnEventHandlers.get(e)));break;case"PostUpdate":r.provides(mm),O("OnPostUpdate",re("PostUpdate",a.triggerOnEventHandlers.get(e)));break;case"PostReport":r.provides(um),O("OnPostReport",re("PostReport",a.triggerOnEventHandlers.get(e)));break;case"PostDelete":r.provides(cm),O("OnPostDelete",re("PostDelete",a.triggerOnEventHandlers.get(e)));break;case"PostFlairUpdate":r.provides(dm),O("OnPostFlairUpdate",re("PostFlairUpdate",a.triggerOnEventHandlers.get(e)));break;case"CommentSubmit":r.provides(im),O("OnCommentSubmit",re("CommentSubmit",a.triggerOnEventHandlers.get(e)));break;case"CommentCreate":r.provides(em),O("OnCommentCreate",re("CommentCreate",a.triggerOnEventHandlers.get(e)));break;case"CommentUpdate":r.provides(sm),O("OnCommentUpdate",re("CommentUpdate",a.triggerOnEventHandlers.get(e)));break;case"CommentReport":r.provides(rm),O("OnCommentReport",re("CommentReport",a.triggerOnEventHandlers.get(e)));break;case"CommentDelete":r.provides(tm),O("OnCommentDelete",re("CommentDelete",a.triggerOnEventHandlers.get(e)));break;case"AppInstall":r.provides(Zf),O("OnAppInstall",re("AppInstall",a.triggerOnEventHandlers.get(e)));break;case"AppUpgrade":r.provides(Qf),O("OnAppUpgrade",re("AppUpgrade",a.triggerOnEventHandlers.get(e)));break;case"ModAction":r.provides(nm),O("OnModAction",re("ModAction",a.triggerOnEventHandlers.get(e)));break;case"ModMail":r.provides(om),O("OnModMail",re("ModMail",a.triggerOnEventHandlers.get(e)));break;case"PostNsfwUpdate":r.provides(lm),O("OnPostNsfwUpdate",re("PostNsfwUpdate",a.triggerOnEventHandlers.get(e)));break;case"PostSpoilerUpdate":r.provides(hm),O("OnPostSpoilerUpdate",re("PostSpoilerUpdate",a.triggerOnEventHandlers.get(e)));break;case"AutomoderatorFilterPost":r.provides(Yf),O("OnAutomoderatorFilterPost",re("AutomoderatorFilterPost",a.triggerOnEventHandlers.get(e)));break;case"AutomoderatorFilterComment":r.provides(Xf),O("OnAutomoderatorFilterComment",re("AutomoderatorFilterComment",a.triggerOnEventHandlers.get(e)));break;default:throw new Error(`Unknown trigger event: ${e}`)}}function pm(r){let e=r.reduce((t,i)=>i.status==="rejected"?[...t,i.reason]:t,[]);if(e.length!==0)return e.length===1?{err:e[0]}:{err:new Error(e.map(t=>Ht.caughtToString(t)).join(`
`))}}import{EffectType as Lm,HandleUIEventResponse as tc,UIEventHandlerDefinition as Wm}from"@devvit/protos";var Ml=Zc(Il(),1);function Tl(r){return r?.constructor===Object}function jt(r,e){return Object.is(r,e)?!0:typeof r!=typeof e?!1:Array.isArray(r)&&Array.isArray(e)?Sl(r,e):r instanceof Date&&e instanceof Date?r.getTime()===e.getTime():r instanceof RegExp&&e instanceof RegExp?r.toString()===e.toString():Tl(r)&&Tl(e)?Om(r,e):r instanceof ArrayBuffer&&e instanceof ArrayBuffer?xl(new DataView(r),new DataView(e)):r instanceof DataView&&e instanceof DataView?xl(r,e):Rl(r)&&Rl(e)?r.byteLength!==e.byteLength?!1:Sl(r,e):!1}function Om(r,e){let t=Object.keys(r),i=Object.keys(e);if(!jt(t,i))return!1;for(let s of t)if(!jt(r[s],e[s]))return!1;return!0}function Sl(r,e){return r.length!==e.length?!1:r.every((t,i)=>jt(t,e[i]))}function xl(r,e){if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r.getUint8(t)!==e.getUint8(t))return!1;return!0}function Rl(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}async function Hm(r,e){let t=r.state??{},i=(0,Ml.default)(t),s=be({ui:!0,metadata:e});if(r.event?.formSubmitted&&r.event.formSubmitted.formId){let l=r.event.formSubmitted.formId;if(l.includes("form.hook.")&&a.customPostType){let T=new ot((ee,B)=>a.customPostType?.render(B)??null,r.event,r.state,e,void 0);return await T.reconcile(),tc.fromJSON({state:T.state,effects:T.getEffects()})}let f=a.formDefinitions?.get(l);if(!f)throw new Error(`Form with key ${l} not found`);let v,y;if(i.__contextAction){let{actionId:T,thingId:ee}=i.__contextAction,B=pi(T);Xa(B,"post")?v=ee:Xa(B,"comment")&&(y=ee)}let P=Object.assign(s,ue(e,v,y),{uiEnvironment:{timezone:e[A.Timezone]?.values[0],locale:e[A.Language]?.values[0]}});await hl(P,r),await f.onSubmit({values:gt(r.event.formSubmitted.results)},P)}else if(r.event?.realtimeEvent){if(a.customPostType){let l=new ot((f,v)=>a.customPostType?.render(v)??null,r.event,r.state,e,void 0);return await l.reconcile(),tc.fromJSON({state:l.state,effects:l.getEffects()})}}else if(r.event?.toastAction)throw new Error("Toast actions not yet implemented");let n=!jt(t,i),o=Rr(s.ui),c=n?[...o,{type:Lm.EFFECT_RERENDER_UI,rerenderUi:{delaySeconds:0}}]:o;return tc.fromJSON({state:i,effects:c})}function Nl(r){r.provides(Wm),O("HandleUIEvent",Hm)}import{CustomPostDefinition as Ln,UIResponse as cu}from"@devvit/protos";import{UIEventScope as Jm}from"@devvit/protos";var rc="ServerCallRequired";function bn(r){return r?.message===rc}var vn=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},z=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},We,Gt,Vt,$e,gi,Gl,Vl,Dl,Bl,Ul,Ol,sc,$l,nc={now(){return new Date}};function Ll(r){return`__autocache__${r}`}function Wl(r){return`__lock__${r}`}var jm=300,Gm=1e3,kn=5e3,ic=3,Hl=.1,jl=1e3,Vm=3e4;function zl(r){if(r.error)throw new Error(r.error);return r.value}var _n=class{constructor(e,t,i=nc){We.add(this),Gt.set(this,void 0),Vt.set(this,{}),$e.set(this,void 0),gi.set(this,void 0),vn(this,Gt,e,"f"),vn(this,gi,t,"f"),vn(this,$e,i,"f")}async cache(e,t){var i;(i=z(this,gi,"f")).__cache??(i.__cache={}),vn(this,Vt,z(this,gi,"f").__cache,"f"),z(this,We,"m",$l).call(this,t);let s=z(this,We,"m",Gl).call(this,t.key);if(s!==void 0)return s;let n=await z(this,We,"m",sc).call(this,t.key),o=await z(this,We,"m",Vl).call(this,t,n,e);return zl(o)}};Gt=new WeakMap,Vt=new WeakMap,$e=new WeakMap,gi=new WeakMap,We=new WeakSet,Gl=function(e){let t=z(this,Vt,"f")[e];if(t){let i=z(this,$e,"f").now().getTime(),s=t?.error&&t?.errorTime&&t.errorCount<ic&&Math.random()<Hl&&t.errorTime+jl<i;if(t?.expires&&t.expires<i&&t.checkedAt+jl<i||s){delete z(this,Vt,"f")[e];return}else return zl(t)}},Vl=async function(e,t,i){let s=t?.expires,n=s?z(this,We,"m",Ol).call(this,s):1;return!t||t?.error&&t.errorCount<ic&&Hl>Math.random()||n>Math.random()?z(this,We,"m",Dl).call(this,e,t,i):t},Dl=async function(e,t,i){let s=Wl(e.key),n=z(this,$e,"f").now().getTime(),o=new Date(n+e.ttl/2);if(await z(this,Gt,"f").set(s,"1",{expiration:o,nx:!0}))return z(this,We,"m",Ul).call(this,e.key,t,i,e.ttl);if(t)return t;{let l=z(this,$e,"f").now();return z(this,We,"m",Bl).call(this,l,e.key,e.ttl)}},Bl=async function r(e,t,i){let s=Math.min(i,Gm),n=await z(this,We,"m",sc).call(this,t);if(n)return n;if(z(this,$e,"f").now().getTime()-e.getTime()>=s)throw new Error(`Cache request timed out trying to get data at key: ${t}`);return await new Promise(o=>setTimeout(o,jm)),z(this,We,"m",r).call(this,e,t,i)},Ul=async function(e,t,i,s){let n=z(this,$e,"f").now().getTime()+s;t=t??{value:null,expires:n,errorCount:0,error:null,errorTime:null,checkedAt:0};try{t.value=await i(),t.error=null,t.errorCount=0,t.errorTime=null}catch(o){t.value=null,t.error=o.message??"Unknown error",t.errorTime=z(this,$e,"f").now().getTime(),t.errorCount++}return z(this,Vt,"f")[e]=t,await z(this,Gt,"f").set(Ll(e),JSON.stringify(t),{expiration:new Date(n+Vm)}),t.error&&t.errorCount<ic&&await z(this,Gt,"f").del(Wl(e)),t},Ol=function(e){let t=z(this,$e,"f").now().getTime(),i=e-t;return i<0?1:i<1e3?.1:i<2e3?.01:i<3e3?.001:0},sc=async function(e){let t=await z(this,Gt,"f").get(Ll(e));if(t){let i=JSON.parse(t);return i.checkedAt=z(this,$e,"f").now().getTime(),z(this,Vt,"f")[e]=i,i}},$l=function(e){e.ttl<kn&&(console.warn(`Cache TTL cannot be less than ${kn} milliseconds! Updating ttl value of ${e.ttl} to ${kn}.`),e.ttl=kn)};function Kl(r,e,t=nc){let i=new _n(r,e,t);return i.cache.bind(i)}import{EffectType as En,ToastAppearance as Zl}from"@devvit/protos";function ql(r){let e=r.match(/form\.hook\.(.+)\.0/);if(e?.[1])return e[1]}var oc=class{constructor(e,t,i){this.state=null,this.hookId=e.hookId,this.form=t,this.onSubmit=i,this.onUIEvent=async s=>{s.formSubmitted&&await i(gt(s.formSubmitted.results))}}};function ac(r,e){let t=Ce({namespace:"useForm",initializer:i=>new oc(i,r,e)});return $m({id:t.hookId})}function $m(r){return`form.hook.${r.id}.0`}function Jl(r,e){let t=ql(e);return r.getHook({id:t})}var cc=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},kt=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},_t,Cn,Fn,dc;var An=class{constructor(e){_t.set(this,void 0),Cn.set(this,0),Fn.set(this,void 0),dc.set(this,(t,i)=>{var s,n;let o=i!==void 0?t:"",c=i!==void 0?i:t;kt(this,_t,"f").emitEffect(`postMessage${cc(this,Cn,(n=kt(this,Cn,"f"),s=n++,n),"f"),s}`,{type:En.EFFECT_WEB_VIEW,webView:{postMessage:{webViewId:o,app:{message:c,jsonString:JSON.stringify(c)}}}})}),cc(this,_t,e,"f"),cc(this,Fn,{postMessage:kt(this,dc,"f")},"f")}get webView(){return kt(this,Fn,"f")}showForm(e,t){return this.showFormInternal(e,t)}showFormInternal(e,t,i){let s=Jl(kt(this,_t,"f"),e);if(!s)throw new Error("Form does not exist. Make sure you have added it using useForm.");let n=i??(s.form instanceof Function?s.form(t??{}):s.form),o={fields:[],id:e,title:n.title,acceptLabel:n.acceptLabel,cancelLabel:n.cancelLabel,shortDescription:n.description};Mt(n.fields),o.fields=it(n.fields),kt(this,_t,"f").emitEffect(e,{type:En.EFFECT_SHOW_FORM,showForm:{form:o}})}showToast(e){let t;e instanceof Object?t={text:e.text,appearance:e.appearance==="success"?Zl.SUCCESS:Zl.NEUTRAL}:t={text:e},kt(this,_t,"f").emitEffect(e.toString(),{type:En.EFFECT_SHOW_TOAST,showToast:{toast:t}})}navigateTo(e){let t=typeof e=="string"?e:e.url;if(!URL.canParse(t))throw new TypeError(`Invalid URL: ${t}`);let i=new URL(t).toString();kt(this,_t,"f").emitEffect(i,{type:En.EFFECT_NAVIGATE_TO_URL,navigateToUrl:{url:i}})}};_t=new WeakMap,Cn=new WeakMap,Fn=new WeakMap,dc=new WeakMap;import{EffectType as zm,RealtimeSubscriptionStatus as Ql}from"@devvit/protos";var Pn=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},ie=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},In,lc,zt,at,$t,Br,uc,Tn=class{constructor(e,t){In.add(this),zt.set(this,void 0),at.set(this,void 0),$t.set(this,void 0),Br.set(this,void 0),Pn(this,zt,t.context,"f"),Pn(this,at,!!t.context._devvitContext?.debug.realtime,"f"),Pn(this,Br,e,"f"),Pn(this,$t,t.invalidate,"f");let i=t.context.meta[A.App]?.values[0];if(!i)throw Error("useChannel missing app ID metadata");let s=t.context.meta[A.Installation]?.values[0];if(!s)throw Error("useChannel missing install ID from metadata");let n=`${i}:${s}:${e.name}`;if(Object.values(ie(this,zt,"f")._hooks).filter(c=>c instanceof lc).some(c=>c.state.channel===n))throw Error(`useChannel channel names must be unique; "${n}" duplicated`);this.state={channel:n,connected:!1,subscribed:!1}}async onUIEvent(e){let t=e.realtimeEvent;if(!(!t||!this.state.subscribed))switch(t.status){case Ql.REALTIME_SUBSCRIBED:ie(this,at,"f")&&console.debug(`[realtime] "${this.state.channel}" connected`),this.state.connected=!0,ie(this,$t,"f").call(this),await ie(this,Br,"f").onSubscribed?.();break;case Ql.REALTIME_UNSUBSCRIBED:ie(this,at,"f")&&console.debug(`[realtime] "${this.state.channel}" disconnected`),this.state.connected=!1,ie(this,$t,"f").call(this),await ie(this,Br,"f").onUnsubscribed?.();break;default:ie(this,at,"f")&&console.debug(`[realtime] "${this.state.channel}" received message: ${JSON.stringify(e,void 0,2)}`),ie(this,Br,"f").onMessage(t.event?.data?.msg);break}}async send(e){if(ie(this,at,"f")&&console.debug(`[realtime] "${this.state.channel}" send message: ${JSON.stringify(e,void 0,2)}`),!this.state.subscribed||!this.state.connected)throw console.debug(`[realtime] "${this.state.channel}" send failed; channel not connected`),Error(`useChannel send failed; "${this.state.channel}" channel not connected`);await ie(this,zt,"f").devvitContext.realtime.send(this.state.channel,e)}get status(){return this.state.subscribed&&this.state.connected?Ie.Connected:this.state.subscribed&&!this.state.connected?Ie.Connecting:!this.state.subscribed&&this.state.connected?Ie.Disconnecting:Ie.Disconnected}subscribe(){this.state.subscribed||(ie(this,at,"f")&&console.debug(`[realtime] "${this.state.channel}" subscribed`),this.state.subscribed=!0,ie(this,$t,"f").call(this),ie(this,In,"m",uc).call(this))}unsubscribe(){this.state.subscribed&&(ie(this,at,"f")&&console.debug(`[realtime] "${this.state.channel}" unsubscribed`),this.state.subscribed=!1,ie(this,$t,"f").call(this),ie(this,In,"m",uc).call(this))}};lc=Tn,zt=new WeakMap,at=new WeakMap,$t=new WeakMap,Br=new WeakMap,In=new WeakSet,uc=function(){let e=Object.values(ie(this,zt,"f")._hooks).filter(t=>t instanceof lc&&t.state.subscribed).map(t=>t.state.channel);ie(this,zt,"f").emitEffect(this.state.channel,{type:zm.EFFECT_REALTIME_SUB,realtimeSubscriptions:{subscriptionIds:e}})};function hc(r){if(!r.name||/[^a-zA-Z0-9_]/.test(r.name))throw Error(`useChannel error: The name "${r.name}" you provided for the hook is invalid. Valid names can only contain letters, numbers, and underscores (_).`);let e=`useChannel:${r.name}`;return Ce({id:e,namespace:e,initializer:t=>new Tn(r,t)})}import{EffectType as mc}from"@devvit/protos";var fc=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Ur=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Or,Kt;function Xl(r){return typeof r=="object"&&r!==null&&"__deleted"in r}var qt=class r{get devvitContext(){if(!this._devvitContext)throw new Error("Devvit context not available");return this._devvitContext}set devvitContext(e){this._devvitContext=e}constructor(e,t){Or.set(this,void 0),this._segments=[],Kt.set(this,{}),this._prevHooks={},this._prevHookId="",this._effects={},this._changed={},this._touched={},this._requeueEvents=[],this._rootProps={},this._generated={},this._undeliveredHandlers={},this.request=e,this.meta=t,fc(this,Or,e.state??{__cache:{}},"f"),this._rootProps=e.props??{}}get _changedState(){let e={__cache:Ur(this,Or,"f").__cache??{}};for(let i in this._changed)e[i]=this._state[i];let t=new Set(Object.keys(this._state));return Object.keys(Ur(this,Kt,"f")).forEach(i=>{i!=="__cache"&&t.delete(i)}),t.forEach(i=>{if(i==="__cache")return;let s={__deleted:!0};this._state[i]=e[i]=s}),e}get _hooks(){return Ur(this,Kt,"f")}set _hooks(e){this._prevHooks=Ur(this,Kt,"f"),fc(this,Kt,e,"f")}get _state(){return Ur(this,Or,"f")}set _state(e){fc(this,Or,e,"f")}push(e){this._segments.push({...e,next:0})}pop(){this._segments.pop()}addUndeliveredEventHandler(e,t){this._undeliveredHandlers[e]=t}addGlobalUndeliveredEventHandler(e,t){r.addGlobalUndeliveredEventHandler(e,t)}getHook(e){return Ur(this,Kt,"f")[e.id]}static addGlobalUndeliveredEventHandler(e,t){r._staticUndeliveredHandlers[e]=t}async handleUndeliveredEvent(e){let t={...r._staticUndeliveredHandlers,...this._undeliveredHandlers};for(let[i,s]of Object.entries(t))await s(e,this)}emitEffect(e,t){this._effects[e]=t}addToRequeueEvents(...e){this._devvitContext?.debug.blocks&&console.debug("[blocks] requeueing events",e);let t=e.reduce((i,s)=>(s.retry?i.retry.push(s):i.normal.push(s),i),{retry:[],normal:[]});this._requeueEvents=[...t.retry,...this._requeueEvents,...t.normal]}get effects(){return Object.values(this._effects)}nextHookId(e){e.key===void 0&&(e.key=this._segments[this._segments.length-1].next+++""),this.push(e);try{let t=[];for(let s=this._segments.length-1;s>=0;s--){let n=this._segments[s];if(n.id){t.unshift(n.id);break}let o=[];n.namespace&&o.push(n.namespace),n.key!==void 0&&n.key!==!1&&o.push(n.key),t.unshift(o.join("-"))}let i=t.join(".");if(this._generated[i]&&!e.shared)throw new Error(`Hook id ${i} already used, cannot register another hook with the same id`);return this._generated[i]=!0,this._prevHookId=i,i}finally{this.pop()}}};Or=new WeakMap,Kt=new WeakMap;qt._staticUndeliveredHandlers={};var Sn=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},ct=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Jt,wi,xn,yi,Et={};qt.addGlobalUndeliveredEventHandler("intervals",async(r,e)=>{r.timer&&r.hook&&(delete Et[r.hook],e.emitEffect("timers",{type:mc.EFFECT_SET_INTERVALS,interval:{intervals:Et}}))});var pc=class{constructor(e,t,i){Jt.set(this,void 0),wi.set(this,void 0),xn.set(this,void 0),yi.set(this,void 0),this.state={duration:{seconds:0,nanos:0},running:!1},Sn(this,wi,i.invalidate,"f"),Sn(this,Jt,i.hookId,"f"),Sn(this,xn,e,"f"),Sn(this,yi,i.context,"f");let s=Math.floor(t/1e3),n=t%1e3*1e6;this.state.duration={seconds:s,nanos:n}}onStateLoaded(){this.state.running?Et[ct(this,Jt,"f")]={duration:this.state.duration}:delete Et[ct(this,Jt,"f")]}async onUIEvent(e){await ct(this,xn,"f").call(this)}start(){Et[ct(this,Jt,"f")]={duration:this.state.duration},this.state.running=!0,ct(this,wi,"f").call(this),ct(this,yi,"f").emitEffect("timers",{type:mc.EFFECT_SET_INTERVALS,interval:{intervals:Et}})}stop(){delete Et[ct(this,Jt,"f")],this.state.running=!1,ct(this,wi,"f").call(this),ct(this,yi,"f").emitEffect("timers",{type:mc.EFFECT_SET_INTERVALS,interval:{intervals:Et}})}};Jt=new WeakMap,wi=new WeakMap,xn=new WeakMap,yi=new WeakMap;function gc(r,e){let t=Ce({namespace:"useInterval",initializer:i=>new pc(r,e,i)});return{start:()=>t.start(),stop:()=>t.stop()}}import{UIEventScope as Km}from"@devvit/protos";var Zt=class extends Error{};import{UIEventScope as Yl}from"@devvit/protos";var bi=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},oe=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Ze,dt,vi,Rn,ki;function yc(r){if(r instanceof Error){if(r.message===rc)throw r;return console.error(r),{message:r.message,details:r.stack??""}}else return console.error(r),{message:"Unknown error",details:Ht.caughtToString(r)}}var wc=class{constructor(e,t,i){Ze.set(this,void 0),dt.set(this,void 0),vi.set(this,void 0),Rn.set(this,void 0),ki.set(this,void 0),bi(this,Ze,!!i.context.devvitContext.debug.useAsync,"f"),oe(this,Ze,"f")&&console.debug("[useAsync] v1",t),this.state={data:null,load_state:"initial",error:null,depends:null},bi(this,dt,i.hookId,"f"),this.initializer=e,bi(this,vi,i.invalidate,"f"),bi(this,Rn,i.context,"f"),this.localDepends=t.depends??null,bi(this,ki,t,"f")}onStateLoaded(){if(oe(this,Ze,"f")&&console.debug("[useAsync] async onLoad ",oe(this,dt,"f"),this.state),oe(this,Ze,"f")&&console.debug("[useAsync] async onLoad have ",this.localDepends,"and",this.state.depends),!jt(this.localDepends,this.state.depends)||this.state.load_state==="initial"){oe(this,Ze,"f")&&console.debug("[useAsync] attempting to resolve for hookId",oe(this,dt,"f")),this.state.load_state="loading",this.state.depends=this.localDepends,oe(this,vi,"f").call(this);let e={scope:Yl.ALL,hook:oe(this,dt,"f"),async:!0,asyncRequest:{requestId:oe(this,dt,"f")+"-"+JSON.stringify(this.state.depends)}};oe(this,Ze,"f")&&console.debug("[useAsync] onLoad requeue"),oe(this,Rn,"f").addToRequeueEvents(e)}}async onUIEvent(e,t){if(e.asyncRequest){let i={requestId:e.asyncRequest.requestId};try{i.data={value:await this.initializer()}}catch(n){i.error=yc(n)}let s={scope:Yl.ALL,asyncResponse:i,hook:oe(this,dt,"f")};oe(this,Ze,"f")&&console.debug("[useAsync] onReq requeue"),t.addToRequeueEvents(s)}else if(e.asyncResponse){let i=oe(this,dt,"f")+"-"+JSON.stringify(this.state.depends);e.asyncResponse.requestId===i?(this.state={...this.state,data:e.asyncResponse.data?.value??null,error:e.asyncResponse.error??null,load_state:e.asyncResponse.error?"error":"loaded"},oe(this,ki,"f").finally&&await oe(this,ki,"f").finally(this.state.data,this.state.error?new Error(this.state.error?.message??"Unknown error"):null),oe(this,vi,"f").call(this)):oe(this,Ze,"f")&&console.debug("[useAsync] onResp skip, stale event",e.asyncResponse.requestId," !== ",i)}else throw new Error("Unknown event type")}};Ze=new WeakMap,dt=new WeakMap,vi=new WeakMap,Rn=new WeakMap,ki=new WeakMap;function _i(r,e={}){let t=Ce({namespace:"useAsync",initializer:i=>new wc(r,e,i)});return{data:t.state.data,error:t.state.error,loading:t.state.load_state==="loading"}}var Mn=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Fe=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Ct,Ei,Lr,Qt,bc=class{constructor(e,t){this.state={value:null,load_state:"initial",error:null},Ct.set(this,void 0),Ei.set(this,void 0),Lr.set(this,void 0),Qt.set(this,void 0),Mn(this,Lr,e,"f"),Mn(this,Qt,t.hookId,"f"),Mn(this,Ct,t.invalidate,"f"),Mn(this,Ei,t.context,"f")}async onUIEvent(){if(this.state.load_state==="loading"&&this._promise){try{this.state.value=await this._promise,this.state.load_state="loaded"}catch(e){this.state.load_state="error",this.state.error=yc(e)}Fe(this,Ct,"f").call(this)}else console.warn(`Invalid state for hook (${Fe(this,Qt,"f")}):`,this.state.load_state,this._promise)}setter(e){this.state.value=e instanceof Function?e(this.state.value):e,this.state.load_state="loaded",Fe(this,Ct,"f").call(this)}onStateLoaded(){if(this._promise=Fe(this,Ei,"f")._prevHooks[Fe(this,Qt,"f")]?._promise,this.state.load_state==="loading")throw new Zt;if(this.state.load_state==="error")throw new Error(this.state.error?.message??"Unknown error");if(this.state.load_state==="initial"){let e;try{e=Fe(this,Lr,"f")instanceof Function?Fe(this,Lr,"f").call(this):Fe(this,Lr,"f")}catch(t){console.log("error in loading async",t),this.state.load_state="error",Fe(this,Ct,"f").call(this);return}if(e instanceof Promise){this._promise=e,this.state.load_state="loading";let t={scope:Km.ALL,asyncRequest:{requestId:Fe(this,Qt,"f")},hook:Fe(this,Qt,"f")};throw Fe(this,Ei,"f").addToRequeueEvents(t),Fe(this,Ct,"f").call(this),new Zt}else this.state.value=e,this.state.load_state="loaded";Fe(this,Ct,"f").call(this)}}};Ct=new WeakMap,Ei=new WeakMap,Lr=new WeakMap,Qt=new WeakMap;function Xt(r){let e=Ce({namespace:"useState",initializer:t=>new bc(r,t)});return[e.state.value,e.setter.bind(e)]}var Nn=class{buildContext(e,t,i){let s=new Er(i),n=new Ir(i),o=new Pr(i),c=new Sr(i),l=new xr(i),f=new An(e),v=new Cr(i),y=new _r,P=new Fr(i),T=Kl(n,e._state),ee={kvStore:s,redis:n,reddit:o,scheduler:c,settings:l,media:v,assets:y,realtime:P,ui:f,useState:Xt,useChannel:hc,useInterval:gc,useForm:ac,cache:T,dimensions:t.env?.dimensions,uiEnvironment:{timezone:i[A.Timezone]?.values[0],locale:i[A.Language]?.values[0],dimensions:t.env?.dimensions,colorScheme:t.env?.colorScheme}},B=ue(i,t.props?.postId);return B.debug.effects=e,{...B,...ee}}};var H=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},qm=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},j,Ci,Ec,On,Ae,Dn,ru,vc,iu,Cc,kc,Bn,_c,eu,Me=null;function tu(r){return JSON.parse(JSON.stringify(r))}function Zm(r){if(!(r!==""&&!/[-.]/.test(r)))throw new Error(`Hook with namespace '${r}' is invalid. Hook namespaces cannot be empty string or contain dashes/dots because they are used as delimiters internally. Please update the hook namespace and try again.`)}function Ce({initializer:r,...e}){if(!Me)throw new Error("Hooks can only be declared at the top of a component.  You cannot declare hooks outside of components or inside of event handlers.  It's almost always a mistake to declare hooks inside of loops or conditionals.");Zm(e.namespace);let t=Me.nextHookId(e),i=Me,s={hookId:t,invalidate:()=>{i._changed[t]=!0,i._state[t]=i?._hooks[t]?.state},context:Me},n=Me._state[t]===void 0||Xl(Me._state[t]);Me._hooks[t]=Me._hooks[t]??r(s);let o=Me._hooks[t];return n||(o.state=Me._state[t]),o.onStateLoaded?.(),n&&o.state!==void 0&&o.state!==null&&s.invalidate(),o}var Qm=null,Un=128,Yt=class{constructor(e){j.add(this),Ci.set(this,void 0),Ec.set(this,new Nn),On.set(this,new Dr(()=>this._latestRenderContext?.devvitContext?.assets)),this._latestRenderContext=null,H(this,j,"a",Ae)&&console.debug("[blocks] BlocksHandler v1"),qm(this,Ci,e,"f"),Qm=this}async handle(e,t){let i=new qt(e,t),s=H(this,Ec,"f").buildContext(i,e,t);i.devvitContext=s;let n,o=e.events.length-Un,c=e.events;if(o>0){c=[];{let B=0;for(let te of e.events)B<o&&te.realtimeEvent?B++:c.push(te)}for(;c.length>Un;)c.shift();console.warn(`dropped ${o} events`)}let f=!c.length||c.some(B=>!B.async),v=c.some(B=>B.blocking),y,P,T=[...c];c.length===0&&c.push({scope:Jm.ALL}),H(this,j,"a",Ae)&&console.debug("[blocks] starting processing events");let ee=0;for(;c.length>0;){if(ee++>Un)throw new Error(`Exceeded maximum iterations of ${Un}`);H(this,j,"a",Ae)&&console.debug("[blocks] processing events loop iteration",c.length);let B=[];if(!c[0].async)B.push(c.shift());else for(;c[0]?.async;)B.push(c.shift());if(!B.length)throw Error("batch must have at least one event");try{if(B[0].async){let G=tu(i._state);await H(this,j,"m",ru).call(this,i,...B),i._state=G}else await H(this,j,"m",iu).call(this,i,...B)}catch(G){if(!bn(G))throw G;if(H(this,j,"a",Ae)&&console.debug("[blocks] caught in handler",G),i._latestRenderContent=void 0,P){i._state=P._state,i._changed=y,i._effects=P._effects;let Hs=T.map(zc=>{let Kc={...zc};return Kc.retry=!0,Kc});i.addToRequeueEvents(...Hs);break}else throw bn(G)||console.error("[blocks] unhandled error in handler",G),G}H(this,j,"a",Ae)&&console.debug("[blocks] remaining events",i._requeueEvents);let te=[];for(let G of i._requeueEvents){if(!f&&!G.async){H(this,j,"a",Ae)&&console.debug("[blocks] NOT reprocessing event in BlocksHandler, sync mismatch A",G),te.push(G);continue}if(f&&G.async&&!v){H(this,j,"a",Ae)&&console.debug("[blocks] NOT reprocessing event in BlocksHandler, sync mismatch B",G),te.push(G);continue}H(this,j,"a",Ae)&&console.debug("[blocks] reprocessing event in BlocksHandler",G),c.push(G)}i._requeueEvents=te,c.length>0&&(y={...i._changed},P={_state:tu(i._state),_effects:{...i._effects}},T=[...c])}if(f){i._latestRenderContent||(i._latestRenderContent=H(this,j,"m",Cc).call(this,H(this,Ci,"f"),i.request.props??{},i));let B=i._latestRenderContent;B&&(n=H(this,On,"f").createBlocksElementOrThrow(B),n=H(this,On,"f").ensureRootBlock(n))}return{state:i._changedState,effects:i.effects,blocks:n,events:i._requeueEvents}}};Ci=new WeakMap,Ec=new WeakMap,On=new WeakMap,j=new WeakSet,Ae=function(){return!!this._latestRenderContext?.devvitContext.debug.blocks},Dn=function(e,...t){e._hooks={},H(this,j,"m",Cc).call(this,H(this,Ci,"f"),e.request.props??{},e)},ru=async function(e,...t){H(this,j,"m",Dn).call(this,e,...t),await Promise.all(t.map(async i=>{if(!i.async)throw new Error("You can't mix main and other queues in one batch.  This is likely a platform bug.  Please file an issue in the Discord for someone to help! https://discord.com/channels/1050224141732687912/1115441897079574620");await H(this,j,"m",vc).call(this,e,i)}))},vc=async function(e,t){let i=e._hooks[t.hook];if(i?.onUIEvent)try{await i.onUIEvent(t,e)}catch(s){throw bn(s)?H(this,j,"a",Ae)&&console.error("Server call required",s):console.error("Error in event handler",s),s}else await e.handleUndeliveredEvent(t)},iu=async function(e,...t){for(let i of t)H(this,j,"a",Ae)&&console.log("[blocks] handling main queue event",i),H(this,j,"a",Ae)&&console.log("[blocks] before",e._state),H(this,j,"m",Dn).call(this,e,i),await H(this,j,"m",vc).call(this,e,i),H(this,j,"a",Ae)&&console.log("[blocks] after",e._state);H(this,j,"m",Dn).call(this,e)},Cc=function(e,t,i){H(this,j,"a",Ae)&&console.debug("[blocks] renderRoot"),i._generated={},Me=i,this._latestRenderContext=i;try{let s=H(this,j,"m",kc).call(this,e,t,i);if(s.length!==1)throw new Error(`There can only be one root element, received: ${s.length}. Please wrap these elements in a <vstack></vstack> or <hstack></hstack> to continue. Fragments cannot be used as a root element.`);let n=s[0];if(n==="[object Promise]")throw new Error('Root elements cannot be async. To use data from an async endpoint, please use "const [data] = useState(async () => {/** your async code */})".');if(typeof n=="string")throw new Error("The root element must return a valid block, not a string. Try wrapping the element in a <text>your content</text> tag to continue.");return i._latestRenderContent=n,n}catch(s){if(s instanceof Zt)return;throw s}finally{Me=null}},kc=function(e,t,i){i.push({namespace:e.name||"anonymous",...t});try{let s=e(t,i.devvitContext);if(s instanceof Promise)throw new Error(`Components (found: ${e.name??"unknown component"}) cannot be async. To use data from an async endpoint, please use "const [data] = useState(async () => {/** your async code */})".`);return H(this,j,"m",_c).call(this,s,i)}finally{i.pop()}},Bn=function(e,t){return e=e.flat(1/0),e.flatMap((i,s)=>(i&&typeof i=="object"&&"props"in i&&(i.props?.key||(i.props=i.props??{},i.props.key=`${s}`)),H(this,j,"m",_c).call(this,i,t)))},_c=function(e,t){if(Array.isArray(e))return H(this,j,"m",Bn).call(this,e,t);if(Xm(e))if(e.type===void 0)try{return t.push({namespace:"fragment",...e.props}),H(this,j,"m",Bn).call(this,e.children,t)}finally{t.pop()}else if(typeof e.type=="function"){let i={...e.props,children:e.children.flat(1/0)};return H(this,j,"m",kc).call(this,e.type,i,t)}else try{t.push({namespace:e.type,...e.props});let i=H(this,j,"m",Bn).call(this,e.children,t),s=H(this,j,"m",eu).call(this,e.props??{});return[{type:e.type,children:i,props:s}]}finally{t.pop()}else return[(e??"").toString()]},eu=function(e){let t={};for(let i in e)if(!(typeof e[i]>"u"))if(typeof e[i]=="function"){let s=Ce({namespace:i,key:!1,initializer:({hookId:n})=>({hookId:n,state:null,onUIEvent:o=>{if(o.userAction)return e[i](o.userAction.data);if(o.webView?.postMessage){let c=o.webView.postMessage.jsonString?JSON.parse(o.webView.postMessage.jsonString):o.webView.postMessage.message;return e[i](c)}}})});t[i]=s.hookId,"captureHookRef"in e[i]&&e[i].captureHookRef()}else{let s=JSON.parse(JSON.stringify(e[i]));s!=null&&(t[i]=s)}return t};function Xm(r){return typeof r=="object"&&r!=null&&"type"in r}var su=r=>{let e=Number(r.trim().split(".").pop());return isNaN(e)?void 0:e},nu=r=>{let[e,t,i]=r.trim().split(";");if(!e||!t||!i){console.warn(`Received a malformed devvit-user-agent! Received: '${r}'`);return}if(e!=="Reddit"){console.warn(`Received unknown company name in user agent! Received: '${r}'`);return}if(t==="iOS"){let s=su(i);if(s===void 0){console.warn(`Could not parse version number from user agent! Received: '${r}'`);return}return{company:"Reddit",platform:"iOS",rawVersion:i,versionNumber:s}}if(t==="Android"){let s=su(i);if(s===void 0){console.warn(`Could not parse version number from user agent! Received: '${r}'`);return}return{company:"Reddit",platform:"Android",rawVersion:i,versionNumber:s}}if(t==="Shreddit")return{company:"Reddit",platform:"Shreddit",rawVersion:i};console.warn("Received unknown platform:",t)},ou=r=>r?r.platform==="Android"?r.versionNumber<1875012:r.platform==="iOS"?r.versionNumber<614973:!1:(console.warn(`Could not parse devvit-user-agent! Received: '${JSON.stringify(r)}'`),!1),Ym=r=>{switch(r){case"Android":return"https://play.google.com/store/apps/details?id=com.reddit.frontpage";case"iOS":return"https://apps.apple.com/us/app/reddit/id1064216828";case"Shreddit":break;default:console.error(`No upgrade link for platform: ${r}`)}},ep=({platform:r},e)=>a.createElement("blocks",null,a.createElement("vstack",{alignment:"middle center",height:100,width:100},a.createElement("vstack",{maxWidth:"300px",gap:"large",alignment:"middle center"},a.createElement("vstack",{gap:"medium",alignment:"middle center"},a.createElement("image",{imageHeight:100,imageWidth:100,url:"https://i.redd.it/p1vmc5ulmpib1.png"}),a.createElement("text",{size:"large",weight:"bold",wrap:!0,alignment:"center"},"Uh oh, the app you're trying to use requires the latest version of Reddit. Please upgrade your app to continue.")),a.createElement("hstack",{alignment:"middle center"},a.createElement("button",{onPress:()=>{let t=Ym(r);t?e.ui.navigateTo(t):console.warn("No upgrade link found for platform:",r)}},"Upgrade"))))),au=r=>()=>a.createElement(ep,{platform:r});var tp=()=>a.createElement("vstack",{alignment:"center middle",width:"100%",height:"100%"},a.createElement("text",null,"This feature is not available yet")),rp=[[Ln,Ln.methods.renderPostContent,(r,e)=>a.customPostType?.render(e)??null],[Ln,Ln.methods.renderPostComposer,(r,e)=>a.createElement(tp,null)]];function ip(r){return async(e,t)=>{let i=nu(t["devvit-user-agent"]?.values?.[0]??"");if(i&&ou(i)){let n=new Yt(au(i.platform));return cu.fromJSON(await n.handle(e,t))}let s=new Yt(r);return cu.fromJSON(await s.handle(e,t))}}function du(r){for(let[e,t,i]of rp)r.provides(e),O(t.name,ip(i))}var b=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Qe=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},p,Ft,Fi,Ai,er,At,Wr,tr,Hr,Fc,Wn,jr,Ac,Pi,Y,lu,a=class extends Gs{static configure(e){Qe(this,p,{...b(this,p,"f",Fi),...e},"f",Fi);let t=e.http,i=typeof t=="object"&&"domains"in t;Je(i?{enabled:!0}:t)&&(i&&(td(t.domains),Qe(this,p,rd(t.domains),"f",Wn)),this.use(_.HTTPDefinition)),(e.redis===void 0||Je(e.kvStore)||Je(e.redis))&&(this.use(_.KVStoreDefinition),this.use(_.RedisAPIDefinition)),Je(e.media)&&this.use(_.MediaServiceDefinition),Je(e.redditAPI)&&(this.use(_.FlairDefinition),this.use(_.GraphQLDefinition),this.use(_.LinksAndCommentsDefinition),this.use(_.ListingsDefinition),this.use(_.ModerationDefinition),this.use(_.ModNoteDefinition),this.use(_.NewModmailDefinition),this.use(_.PrivateMessagesDefinition),this.use(_.SubredditsDefinition),this.use(_.UsersDefinition),this.use(_.WidgetsDefinition),this.use(_.WikiDefinition)),Je(e.realtime)&&this.use(_.RealtimeDefinition);let o=e.userActions,l=typeof o=="object"&&"scopes"in o?{enabled:!0}:o;Je(l)&&(this.use(_.UserActionsDefinition),Qe(this,p,b(this,p,"m",lu).call(this,e),"f",jr))}static addMenuItem(e){this._initMenu(),b(this,p,"f",Wr).push(e)}static addCustomPostType(e){Qe(this,p,e,"f",Ai)}static createForm(e,t){this._initForms();let i=`form.${b(this,p,"f",er).size}`;return b(this,p,"f",er).set(i,{form:e,onSubmit:t}),i}static addSchedulerJob(e){if(this._initScheduler(),b(this,p,"f",tr).has(e.name))throw new Error(`Job ${e.name} is already defined`);b(this,p,"f",tr).set(e.name,e.onRun)}static addSettings(e){var t;let i=Array.isArray(e)?e:[e],s=i.filter(o=>o.type==="group"||!o.scope||o.scope===ft.Installation),n=i.filter(o=>o.type!=="group"&&o.scope===ft.App);this._initSettings(n.length>0,s.length>0),s.length>0&&b(this,p,"f",At).push(...s),n.length>0&&b(this,p,"f",Ft).push(...n),Mt([...b(this,p,"f",At)??[],...b(this,p,"f",Ft)??[]]),b(this,p,"f",Y)[_.SettingsDefinition.fullName]||this.use(_.SettingsDefinition),globalThis.devvit??(globalThis.devvit={}),(t=globalThis.devvit).settings??(t.settings={}),globalThis.devvit.settings.app=b(this,p,"f",Ft),globalThis.devvit.settings.installation=b(this,p,"f",At)}static addTrigger(e){if("events"in e){for(let t of e.events)this.addTrigger({event:t,onEvent:(i,s)=>e.onEvent(i,s)});return this}return b(this,p,"f",Hr).has(e.event)?b(this,p,"f",Hr).get(e.event)?.push(e.onEvent):b(this,p,"f",Hr).set(e.event,[e.onEvent]),p}static provide(e){b(this,p,"f",Ac).push(e)}static use(e){b(this,p,"f",Pi)[e.fullName]={def:e,handler:void 0};let t={};for(let i of Object.values(e.methods))t[i.name]=(s,n)=>b(this,p,"f",Pi)[e.fullName].handler?.[i.name]?.(i.requestType?.fromPartial(s??{}),n);return b(this,p,"f",Y)[e.fullName]=t,t}static get redditAPIPlugins(){if(!Je(b(this,p,"f",Fi).redditAPI))throw new Error("Reddit API is not enabled. You can enable it by passing `redditAPI: true` to `Devvit.configure`.");return{Flair:b(this,p,"f",Y)[_.FlairDefinition.fullName],GraphQL:b(this,p,"f",Y)[_.GraphQLDefinition.fullName],LinksAndComments:b(this,p,"f",Y)[_.LinksAndCommentsDefinition.fullName],Listings:b(this,p,"f",Y)[_.ListingsDefinition.fullName],Moderation:b(this,p,"f",Y)[_.ModerationDefinition.fullName],ModNote:b(this,p,"f",Y)[_.ModNoteDefinition.fullName],NewModmail:b(this,p,"f",Y)[_.NewModmailDefinition.fullName],PrivateMessages:b(this,p,"f",Y)[_.PrivateMessagesDefinition.fullName],Subreddits:b(this,p,"f",Y)[_.SubredditsDefinition.fullName],Users:b(this,p,"f",Y)[_.UsersDefinition.fullName],Widgets:b(this,p,"f",Y)[_.WidgetsDefinition.fullName],Wiki:b(this,p,"f",Y)[_.WikiDefinition.fullName]}}static get schedulerPlugin(){let e=b(this,p,"f",Y)[_.SchedulerDefinition.fullName];if(!e)throw new Error("Scheduler is not enabled. You can enable it by calling `Devvit.addSchedulerJob` at the top level of your app.");return e}static get kvStorePlugin(){let e=b(this,p,"f",Y)[_.KVStoreDefinition.fullName];if(!e)throw new Error("Key Value Store is not enabled. You can enable it by passing `kvStore: true` to `Devvit.configure`");return e}static get redisPlugin(){let e=b(this,p,"f",Y)[_.RedisAPIDefinition.fullName];if(!e)throw new Error("Redis is not enabled. You can enable it by passing `redis: true` to `Devvit.configure`");return e}static get mediaPlugin(){let e=b(this,p,"f",Y)[_.MediaServiceDefinition.fullName];if(!e)throw new Error("MediaService is not enabled. You can enable it by passing `media: true` to `Devvit.configure`");return e}static get settingsPlugin(){let e=b(this,p,"f",Y)[_.SettingsDefinition.fullName];if(!e)throw new Error("Settings must first be configured with `Devvit.addSettings()` before they can be accessed");return e}static get realtimePlugin(){let e=b(this,p,"f",Y)[_.RealtimeDefinition.fullName];if(!e)throw new Error("Realtime is not enabled. You can enable it by passing `realtime: true` to `Devvit.configure`");return e}static get userActionsPlugin(){if(!(b(this,p,"f",jr).length>0&&Je(b(this,p,"f",Fi).redditAPI)))throw new Error("UserActions is not enabled. You can enable it by passing scopes in `userActions: { scopes: [...scopes] }` and `redditAPI: true` to `Devvit.configure`");return b(this,p,"f",Y)[_.UserActionsDefinition.fullName]}static get scopes(){return b(this,p,"f",jr)}static get menuItems(){return b(this,p,"f",Wr)??[]}static get customPostType(){return b(this,p,"f",Ai)}static get formDefinitions(){return b(this,p,"f",er)}static get scheduledJobHandlers(){return b(this,p,"f",tr)}static get installationSettings(){return b(this,p,"f",At)}static get appSettings(){return b(this,p,"f",Ft)}static get triggerOnEventHandlers(){return b(this,p,"f",Hr)}static get assets(){return globalThis.devvit?.assets??{}}static get webViewAssets(){return b(this,p,"f",Fc)}static _initForms(){Qe(this,p,b(this,p,"f",er)??new Map,"f",er)}static _initMenu(){Qe(this,p,b(this,p,"f",Wr)??[],"f",Wr)}static _initScheduler(){b(this,p,"f",Y)[_.SchedulerDefinition.fullName]||this.use(_.SchedulerDefinition),Qe(this,p,b(this,p,"f",tr)??new Map,"f",tr)}static _initSettings(e,t){e&&Qe(this,p,b(this,p,"f",Ft)??[],"f",Ft),t&&Qe(this,p,b(this,p,"f",At)??[],"f",At)}constructor(e){var t,i;super(e),globalThis.devvit??(globalThis.devvit={}),(t=globalThis.devvit).assets??(t.assets=e.assets),(i=globalThis.devvit).appConfig??(i.appConfig=globalThis.__devvit__?.config),Qe(p,p,e.webviewAssets??{},"f",Fc);for(let s in b(p,p,"f",Pi)){let n=b(p,p,"f",Pi)[s];n.handler=e.use(n.def)}b(p,p,"f",Wr)&&ml(e),b(p,p,"f",tr)&&pl(e),b(p,p,"f",Ai)&&(cl(e),du(e)),(b(p,p,"f",Ai)||b(p,p,"f",er))&&Nl(e),b(p,p,"f",At)&&dl(e),b(p,p,"f",Ft)&&jd(e),b(p,p,"f",Hr).size>0&&gl(e);for(let s of b(p,p,"f",Ac))e.provides(s);(b(p,p,"f",Wn).length>0||b(p,p,"f",jr).length>0)&&e.addPermissions?.({requestedFetchDomains:b(p,p,"f",Wn),asUserScopes:b(p,p,"f",jr)})}static assertUserScope(e){let t=Ii[e];if(!p.scopes.includes(e))throw Error(`To call this API with 'runAs: "USER"', set 'userActions: { scopes: [ Scope.${t} ] }' in your Devvit.configure().`)}};p=a,lu=function(e){let t=e.userActions;return t?typeof t=="boolean"&&t?[Ii.SUBMIT_POST,Ii.SUBMIT_COMMENT]:typeof t=="object"&&"enabled"in t&&t.enabled?"scopes"in t?t.scopes:[Ii.SUBMIT_POST,Ii.SUBMIT_COMMENT]:typeof t=="object"&&"scopes"in t?t.scopes:[]:[]};a.debug={};Ft={value:void 0};Fi={value:{}};Ai={value:void 0};er={value:void 0};At={value:void 0};Wr={value:void 0};tr={value:void 0};Hr={value:new Map};Fc={value:{}};Wn={value:[]};jr={value:[]};Ac={value:[]};Pi={value:{}};Y={value:{}};(function(r){function e(t,i,...s){return{type:t,props:i,children:s}}r.createElement=e})(a||(a={}));function ae(r){let e=Object.getOwnPropertyDescriptors(r.constructor.prototype);for(let[t,i]of Object.entries(e))i.get&&Object.defineProperty(r,t,{...i,enumerable:!0})}var Pc;(function(r){r[r.bold=1]="bold",r[r.italic=2]="italic",r[r.underline=4]="underline",r[r.strikethrough=8]="strikethrough",r[r.subscript=16]="subscript",r[r.superscript=32]="superscript",r[r.monospace=64]="monospace"})(Pc||(Pc={}));var uu="text",hu="raw",fu="br",mu="link",pu="c/",gu="p/",wu="r/",yu="u/",bu="@",vu="spoilertext",ku="par",_u="h",Eu="hr",Cu="blockquote",Fu="code",Au="li",Pu="list",Iu="L",Tu="R",Su="C",xu="table",Ru="embed",Mu="img",Nu="gif",Du="video";function Bu(r){return{e:Nu,id:r.mediaId,...r.caption&&{c:r.caption},...r.blur&&{o:r.blur}}}function Uu(r,e){let t={},i=[];return Object.assign(t,Ti(t,i),Si(t,i),xi(t,i),Ni(t,i),Di(t,i),Bi(t,i)),e(t),{e:Cu,c:i,...r.author&&{a:r.author}}}function Ou(r,e){let t={},i=[];return Object.assign(t,Sc(t,i)),e(t),{e:Fu,c:i,...r.language&&{l:r.language}}}function Lu(r){return{e:pu,t:r.permalink}}function Wu(r,e){let t={},i=[];return Object.assign(t,Sc(t,i),Mi(t,i)),e(t),{e:_u,l:r.level,c:i}}function Hu(r){return{e:Ru,u:r.sourceUrl,c:r.contentUrl,x:r.width,y:r.height}}function ju(){return{e:Eu}}function Gu(r){return{e:Mu,id:r.mediaId,...r.caption&&{c:r.caption},...r.blur&&{o:r.blur}}}function Ic(){return{e:fu}}function Vu(r){return{e:mu,t:r.text,u:r.url,...r.formatting&&{f:r.formatting},...r.tooltip&&{a:r.tooltip}}}function $u(r,e){let t={},i=[];return Object.assign(t,ah(t,i)),e(t),{e:Pu,o:r.ordered,c:i}}function zu(r){let e={},t=[];return Object.assign(e,Ti(e,t),Si(e,t),xi(e,t),Hn(e,t),Ni(e,t),Di(e,t),Bi(e,t)),r(e),{e:Au,c:t}}function Ku(r){let e={},t=[];return Object.assign(e,jn(e,t),Mi(e,t),Tc(e,t),xc(e,t),Ri(e,t)),r(e),{e:ku,c:t}}function qu(r){return{e:gu,t:r.permalink}}function Ju(r){return{e:hu,t:r}}function Zu(r){let e={},t=[];return Object.assign(e,jn(e,t),Mi(e,t),Tc(e,t)),r(e),{e:vu,c:t}}function Qu(r){return{e:wu,t:r.subredditName,l:r.showPrefix}}function Xu(r){let e={},t=[],i=[];return Object.assign(e,ch(e,t,i)),r(e),{e:xu,h:t,c:i}}function Yu(r){let[e,t]=oh();return r(e),{c:t}}function eh(r,e){let[t,i]=oh();e(t);let s;switch(r.columnAlignment){case"left":s=Iu;break;case"right":s=Tu;break;case"center":s=Su;break}return{...s&&{a:s},...i&&{c:i}}}function th(r){let e={},t=[];return Object.assign(e,dh(e,t)),r(e),t}function rh(r){return{e:uu,t:r.text,...r.formatting&&{f:r.formatting}}}function ih(r){return{e:yu,t:r.username,l:r.showPrefix}}function sh(r){return{e:bu,t:r.username,l:r.showPrefix}}function nh(r){return{e:Du,id:r.mediaId,...r.caption&&{c:r.caption},...r.blur&&{o:r.blur},...r.thumbnail&&{p:r.thumbnail},...r.convertToGif&&{gifify:r.convertToGif}}}function oh(){let r={},e=[];return Object.assign(r,jn(r,e),Mi(r,e),xc(r,e),Ri(r,e)),[r,e]}function Ti(r,e){return{blockQuote(t,i){return e.push(Uu(t,i)),r}}}function Si(r,e){return{codeBlock(t,i){return e.push(Ou(t,i)),r}}}function lh(r,e){return{embed(t){return e.push(Hu(t)),r}}}function xi(r,e){return{heading(t,i){return e.push(Wu(t,i)),r}}}function Hn(r,e){return{horizontalRule(){return e.push(ju()),r}}}function Ri(r,e){return{image(t){return e.push(Gu(t)),r},animatedImage(t){return e.push(Bu(t)),r}}}function Tc(r,e){return{linebreak(){return e.push(Ic()),r}}}function Mi(r,e){return{link(t){return e.push(Vu(t)),r},commentLink(t){return e.push(Lu(t)),r},postLink(t){return e.push(qu(t)),r},subredditLink(t){return e.push(Qu(t)),r},userLink(t){return e.push(ih(t)),r},userMention(t){return e.push(sh(t)),r}}}function Ni(r,e){return{list(t,i){return e.push($u(t,i)),r}}}function ah(r,e){return{item(t){return e.push(zu(t)),r}}}function Di(r,e){return{paragraph(t){return e.push(Ku(t)),r}}}function Sc(r,e){return{rawText(t){return e.push(Ju(t)),r}}}function xc(r,e){return{spoiler(t){return e.push(Zu(t)),r}}}function ch(r,e,t){return{headerCell(i,s){return e.push(eh(i,s)),r},row(i){return t.push(th(i)),r}}}function Bi(r,e){return{table(t){return e.push(Xu(t)),r}}}function dh(r,e){return{cell(t){return e.push(Yu(t)),r}}}function jn(r,e){return{text(t){let i=t.text.split(/\r?\n/);for(let[s,n]of i.entries())n.length>0&&e.push(rh({...t,text:n})),s<i.length-1&&e.push(Ic());return r}}}function uh(r,e){return{video(t){return e.push(nh(t)),r}}}var sp=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},np=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Gn,rr=class{constructor(){Gn.set(this,void 0);let e=[];Object.assign(this,Di(this,e),xi(this,e),Hn(this,e),Ti(this,e),Si(this,e),lh(this,e),Ni(this,e),Bi(this,e),Ri(this,e),uh(this,e)),sp(this,Gn,{document:e},"f")}build(){return JSON.stringify(np(this,Gn,"f"))}paragraph(e){return this}heading(e,t){return this}horizontalRule(){return this}blockQuote(e,t){return this}codeBlock(e,t){return this}embed(e){return this}list(e,t){return this}table(e){return this}image(e){return this}animatedImage(e){return this}video(e){return this}};Gn=new WeakMap;function Gr(r){let e;return r instanceof rr?e=r.build():typeof r=="object"?e=JSON.stringify(r):e=r,e}import"@devvit/protos";var Xe=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},V=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},ve,Vr,Ui,Oi,Li,Wi,Hi,ji,Gi,Vi,$i,Vn,me,Rc,hh,Mc,$n;(function(r){r.User="USER_FLAIR",r.Post="LINK_FLAIR"})($n||($n={}));var ye=class{constructor(e,t,i){Vr.set(this,void 0),Ui.set(this,void 0),Oi.set(this,void 0),Li.set(this,void 0),Wi.set(this,void 0),Hi.set(this,void 0),ji.set(this,void 0),Gi.set(this,void 0),Vi.set(this,void 0),$i.set(this,void 0),ae(this),u(e.id),u(e.text),Xe(this,Vr,e.id,"f"),Xe(this,Ui,t,"f"),Xe(this,Oi,e.text,"f"),Xe(this,Li,op(e.textColor),"f"),Xe(this,Wi,ap(e.backgroundColor),"f"),Xe(this,Hi,cp(e.allowableContent),"f"),Xe(this,ji,e.modOnly,"f"),Xe(this,Gi,e.maxEmojis,"f"),Xe(this,Vi,e.textEditable,"f"),Xe(this,$i,i,"f")}get id(){return V(this,Vr,"f")}get text(){return V(this,Oi,"f")}get textColor(){return V(this,Li,"f")}get backgroundColor(){return V(this,Wi,"f")}get allowableContent(){return V(this,Hi,"f")}get modOnly(){return V(this,ji,"f")}get maxEmojis(){return V(this,Gi,"f")}get allowUserEdits(){return V(this,Vi,"f")}async delete(){return ve.deleteFlairTemplate(V(this,Vr,"f"),V(this,Ui,"f"),V(this,$i,"f"))}async edit(e){return ve.editFlairTemplate({id:V(this,Vr,"f"),subredditName:V(this,Ui,"f"),text:e.text??V(this,Oi,"f"),allowableContent:e.allowableContent??V(this,Hi,"f"),backgroundColor:e.backgroundColor??V(this,Wi,"f"),maxEmojis:e.maxEmojis??V(this,Gi,"f"),modOnly:e.modOnly??V(this,ji,"f"),textColor:e.textColor??V(this,Li,"f"),allowUserEdits:e.allowUserEdits??V(this,Vi,"f")},V(this,$i,"f"))}static async createPostFlairTemplate(e,t){return V(ve,ve,"m",Vn).call(ve,{...e,flairType:$n.Post},t)}static async createUserFlairTemplate(e,t){return V(ve,ve,"m",Vn).call(ve,{...e,flairType:$n.User},t)}static async editFlairTemplate(e,t){return V(ve,ve,"m",Vn).call(ve,e,t)}static async getPostFlairTemplates(e,t){return(await a.redditAPIPlugins.Flair.LinkFlair({subreddit:e},t)).flair?.map(n=>new ve(n,e,t))||[]}static async getUserFlairTemplates(e,t){return(await a.redditAPIPlugins.Flair.UserFlair({subreddit:e},t)).flair?.map(n=>new ve(n,e,t))||[]}static async deleteFlairTemplate(e,t,i){await a.redditAPIPlugins.Flair.DeleteFlairTemplate({subreddit:e,flairTemplateId:t},i)}};ve=ye,Vr=new WeakMap,Ui=new WeakMap,Oi=new WeakMap,Li=new WeakMap,Wi=new WeakMap,Hi=new WeakMap,ji=new WeakMap,Gi=new WeakMap,Vi=new WeakMap,$i=new WeakMap,Vn=async function(e,t){let{subredditName:i,allowableContent:s="all",backgroundColor:n="transparent",flairType:o="",maxEmojis:c=10,modOnly:l=!1,text:f,textColor:v="dark",allowUserEdits:y=!1,id:P=""}=e;if(l&&y)throw new Error("Cannot have a mod only flair that is editable by users");let ee=await a.redditAPIPlugins.Flair.FlairTemplate({subreddit:i,allowableContent:s,backgroundColor:n,flairType:o,maxEmojis:c,modOnly:l,text:f,textColor:v,textEditable:y,flairTemplateId:P,cssClass:"",overrideCss:!1},t);return new ve(ee,i,t)};function zi(r){if(r.flairText||r.flairCssClass||r.flairTemplateId||r.flairRichtext?.length)return{backgroundColor:r.flairBackgroundColor,cssClass:r.flairCssClass,text:r.flairText,type:r.flairType,templateId:r.flairTemplateId,richtext:(r.flairRichtext??[]).map(({e,t,a:i,u:s})=>({elementType:e,text:t,emojiRef:i,url:s})),textColor:r.flairTextColor}}function Ki(r){return{flairCssClass:r.flairCssClass,user:r.user,flairText:r.flairText}}var Ee=class{static async getUserFlairBySubreddit(e,t){return a.redditAPIPlugins.Flair.FlairList(e,t)}static setUserFlair(e,t){return V(me,me,"m",Rc).call(me,e,t)}static setUserFlairBatch(e,t,i){return V(me,me,"m",hh).call(me,e,t,i)}static setPostFlair(e,t){return V(me,me,"m",Rc).call(me,{...e,postId:Te(e.postId)},t)}static async removePostFlair(e,t,i){return V(me,me,"m",Mc).call(me,e,t,void 0,i)}static async removeUserFlair(e,t,i){return V(me,me,"m",Mc).call(me,e,void 0,t,i)}};me=Ee,Rc=async function(e,t){await a.redditAPIPlugins.Flair.SelectFlair({subreddit:e.subredditName,flairTemplateId:e.flairTemplateId??"",text:e.text??"",name:e.username??"",link:e.postId??"",backgroundColor:e.backgroundColor??"",textColor:e.textColor??"dark",cssClass:e.cssClass??"",returnRtjson:"none"},t)},hh=async function(e,t,i){if(!t.length)return[];if(t.length>100)throw new Error("Unexpected input: flairs array cannot be longer than 100 entries.");let n=",",o=t.map(f=>{for(let v in f)if(f[v]?.includes(n))throw new Error(`Unexpected input: ${v} cannot contain the "," character`);return[f.username,f.text||"",f.cssClass||""].join(n)}).join(`
`);return(await a.redditAPIPlugins.Flair.FlairCsv({subreddit:e,flairCsv:o},i)).result},Mc=async function(e,t,i,s){await a.redditAPIPlugins.Flair.SelectFlair({subreddit:e,name:i??"",link:t??"",flairTemplateId:"",backgroundColor:"",text:"",textColor:"",cssClass:"",returnRtjson:"none"},s)};function op(r){if(u(r,"Flair text color is required"),r==="light"||r==="dark")return r;throw new Error(`Invalid flair text color: ${r}`)}function ap(r){if(!r||r.length===0||r==="transparent")return"transparent";if(/^#([A-Fa-f0-9]{6})$/.test(r))return r;throw new Error(`Invalid flair background color: ${r}`)}function cp(r){if(r==="all"||r==="text"||r==="emoji")return r;throw new Error(`Invalid allowable content: ${r}`)}var lt=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Ye=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},qi,$r,zr,ir,Ji,zn,fh=100,mh=1/0,J=class{constructor(e){qi.add(this),$r.set(this,void 0),zr.set(this,void 0),ir.set(this,void 0),Ji.set(this,!1),this.pageSize=fh,this.limit=mh,this.children=[],ae(this),this._fetch=e.fetch,this.pageSize=e.pageSize??fh,this.limit=e.limit??mh,lt(this,zr,e.after,"f"),lt(this,$r,e.before,"f"),lt(this,ir,e.more,"f"),e.children&&(this.children=e.children)}get hasMore(){return!Ye(this,Ji,"f")||!!(Ye(this,zr,"f")||Ye(this,$r,"f")||Ye(this,ir,"f"))}async*[($r=new WeakMap,zr=new WeakMap,ir=new WeakMap,Ji=new WeakMap,qi=new WeakSet,Symbol.asyncIterator)](){let e=0;for(;;){if(e===this.children.length)if(this.hasMore){if((await Ye(this,qi,"m",zn).call(this)).length===0)break}else break;if(yield this.children[e],e++,e===this.limit)break}}setMore(e){lt(this,ir,e,"f")}preventInitialFetch(){lt(this,Ji,!0,"f")}async all(){for(;this.hasMore&&this.children.length<this.limit;)await Ye(this,qi,"m",zn).call(this);return this.children.slice(0,this.limit)}async get(e){let t=e<=this.limit?e:this.limit;for(;this.hasMore&&this.children.length<t;)await Ye(this,qi,"m",zn).call(this);return this.children.slice(0,t)}};zn=async function(){if(!this.hasMore)throw new Error("This listing does not have any more items to load.");let{children:e,before:t,after:i,more:s}=await this._fetch({before:Ye(this,$r,"f"),after:Ye(this,zr,"f"),limit:this.pageSize,more:Ye(this,ir,"f")});return this.children.push(...e),lt(this,$r,t,"f"),lt(this,zr,i,"f"),lt(this,ir,s,"f"),lt(this,Ji,!0,"f"),e};var ph=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Nc,Dc,Le=class{constructor(){}static get(e,t){let i=a.redditAPIPlugins.ModNote;return new J({hasMore:!0,before:e.before,limit:e.limit,pageSize:e.limit,fetch:async s=>{let n=await i.GetNotes({subreddit:e.subreddit,user:e.user,filter:e.filter,before:s.before,limit:s.limit},t);return{children:n.modNotes?.map(o=>ph(this,Nc,"m",Dc).call(this,o))||[],before:n.hasNextPage?n.endCursor:void 0,hasMore:n.hasNextPage}}})}static async delete(e,t){let i=a.redditAPIPlugins.ModNote,{deleted:s}=await i.DeleteNotes(e,t);return!!s}static async add(e,t){let s=await a.redditAPIPlugins.ModNote.PostNotes(e,t);if(!s?.created)throw new Error("Failed to create mod note");return ph(this,Nc,"m",Dc).call(this,s.created)}static async addRemovalNote(e,t){await a.redditAPIPlugins.ModNote.PostRemovalNote(e,t)}};Nc=Le,Dc=function(e){return u(e.id,"Mod note ID is null or undefined"),u(e.createdAt,"Mod note createdAt is null or undefined"),u(e.type,"Mod note type is null or undefined"),u(e.subreddit,"Mod note subreddit is null or undefined"),u(e.subredditId,"Mod note subredditId is null or undefined"),u(e.operator,"Mod note operator is null or undefined"),u(e.operatorId,"Mod note operatorId is null or undefined"),u(e.user,"Mod note user is null or undefined"),u(e.userId,"Mod note userId is null or undefined"),u(e.userNoteData,"Mod note userNote is null or undefined"),u(e.modActionData,"Mod note modAction is null or undefined"),{id:e.id,user:{id:we(e.userId??""),name:e.user},subreddit:{id:se(e.subredditId??""),name:e.subreddit},operator:{id:we(e.operatorId??""),name:e.operator},createdAt:new Date(e.createdAt*1e3),userNote:{note:e.userNoteData?.note,redditId:e.userNoteData?.redditId?Oe(e.userNoteData?.redditId):void 0,label:e.userNoteData?.label},type:e.type}};var ce=class{static queryWithQueryString(e,t){return a.redditAPIPlugins.GraphQL.Query({query:e},t)}static query(e,t,i,s){return a.redditAPIPlugins.GraphQL.PersistedQuery({operationName:e,id:t,variables:i},s)}};var gh=["all","wiki","posts","access","mail","config","flair","channels","chat_config","chat_operator","community_chat"];function dp(r,e){return e.map(t=>(r.includes(t)?"+":"-")+t).join(",")}function Bc(r){return dp(r,gh)}function wh(r){return r.filter(e=>gh.includes(e))}import{Block as kh,UIResponse as bp}from"@devvit/protos";import{Scope as _h}from"@devvit/protos/json/reddit/devvit/app_permission/v1/app_permission.js";import"@devvit/protos/types/google/protobuf/any.js";import{StringValue as lp}from"@devvit/protos/types/google/protobuf/wrappers.js";function Zi(r){return r.map(e=>{try{return lp.decode(e.value).value}catch{}return JSON.stringify(e)})}var Lc=Zc(vh(),1);var Oc=r=>"text"in r?r.text:yp(r.richtext),yp=r=>r instanceof rr?r.build():typeof r=="object"?JSON.stringify(r):r;var k=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},g=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Xi,qn,Kr,Jn,Yi,Zn,Qn,Xn,qr,Yn,eo,to,ro,io,so,nr,no,oo,Jr,es,or,ts,rs,is,ar,cr,dr,ss,lr,ur,hr,Pt,ao,co,lo,ns,os,as,L,vp={NONE:0,BLOCKS:1,UNRECOGNIZED:-1};var X=class r{constructor(e,t){Xi.set(this,void 0),qn.set(this,void 0),Kr.set(this,void 0),Jn.set(this,void 0),Yi.set(this,void 0),Zn.set(this,void 0),Qn.set(this,void 0),Xn.set(this,void 0),qr.set(this,void 0),Yn.set(this,void 0),eo.set(this,void 0),to.set(this,void 0),ro.set(this,void 0),io.set(this,void 0),so.set(this,void 0),nr.set(this,void 0),no.set(this,void 0),oo.set(this,void 0),Jr.set(this,void 0),es.set(this,void 0),or.set(this,void 0),ts.set(this,void 0),rs.set(this,void 0),is.set(this,void 0),ar.set(this,void 0),cr.set(this,void 0),dr.set(this,void 0),ss.set(this,void 0),lr.set(this,void 0),ur.set(this,void 0),hr.set(this,void 0),Pt.set(this,void 0),ao.set(this,void 0),co.set(this,void 0),lo.set(this,void 0),ns.set(this,void 0),os.set(this,void 0),as.set(this,void 0),L.set(this,void 0),ae(this),u(e.id,"Post is missing id"),u(e.title,"Post is missing title"),u(e.createdUtc,"Post is missing created date"),u(e.author,"Post is missing author name"),u(e.subreddit,"Post is missing subreddit name"),u(e.subredditId,"Post is missing subreddit id"),u(e.url,"Post is missing url"),u(e.permalink,"Post is missing permalink"),k(this,Xi,Te(`t3_${e.id}`),"f"),k(this,Kr,e.author,"f"),k(this,qn,e.authorFullname?we(e.authorFullname):void 0,"f"),k(this,Yi,se(e.subredditId),"f"),k(this,Zn,e.subreddit,"f"),k(this,to,e.score??0,"f"),k(this,ro,e.numComments??0,"f"),k(this,io,e.numReports??0,"f");let i=new Date(0);i.setUTCSeconds(e.createdUtc),k(this,Jn,i,"f"),k(this,Xn,e.title,"f"),k(this,qr,e.selftext,"f"),k(this,Yn,e.selftextHtml,"f"),k(this,eo,e.url,"f"),k(this,Qn,e.permalink,"f"),e.thumbnail&&e.thumbnail!=="self"&&e.thumbnail!=="nsfw"&&e.thumbnailHeight!=null&&e.thumbnailWidth!=null&&k(this,so,{url:e.thumbnail,height:e.thumbnailHeight,width:e.thumbnailWidth},"f"),k(this,nr,e.approved??!1,"f"),k(this,no,e.approvedAtUtc??0,"f"),k(this,oo,e.bannedAtUtc??0,"f"),k(this,or,e.removed??!1,"f"),k(this,ts,e.removedBy,"f"),k(this,rs,e.removedByCategory,"f"),k(this,Jr,e.spam??!1,"f"),k(this,es,e.stickied??!1,"f"),k(this,is,e.archived??!1,"f"),k(this,ar,e.edited??!1,"f"),k(this,cr,e.locked??!1,"f"),k(this,dr,e.over18??!1,"f"),k(this,ss,e.quarantine??!1,"f"),k(this,lr,e.spoiler,"f"),k(this,ur,e.hidden??!1,"f"),k(this,hr,e.ignoreReports??!1,"f"),k(this,Pt,e.distinguished,"f"),k(this,lo,e.secureMedia,"f"),k(this,ns,(e.modReports??[]).map(([s])=>s),"f"),k(this,os,(e.userReports??[]).map(([s])=>s),"f"),k(this,L,t,"f"),k(this,ao,zi({flairBackgroundColor:e.linkFlairBackgroundColor,flairCssClass:e.linkFlairCssClass,flairText:e.linkFlairText,flairType:e.linkFlairType,flairTemplateId:e.linkFlairTemplateId,flairRichtext:e.linkFlairRichtext,flairTextColor:e.linkFlairTextColor}),"f"),k(this,co,zi({flairBackgroundColor:e.authorFlairBackgroundColor,flairCssClass:e.authorFlairCssClass,flairText:e.authorFlairText,flairType:e.authorFlairType,flairTemplateId:e.authorFlairTemplateId,flairRichtext:e.authorFlairRichtext,flairTextColor:e.authorFlairTextColor}),"f"),e.gallery?k(this,as,e.gallery.map(s=>({status:s.status,url:s.url,height:s.height,width:s.width})),"f"):k(this,as,[],"f")}get id(){return g(this,Xi,"f")}get authorId(){return g(this,qn,"f")}get authorName(){return g(this,Kr,"f")}get subredditId(){return g(this,Yi,"f")}get subredditName(){return g(this,Zn,"f")}get permalink(){return g(this,Qn,"f")}get title(){return g(this,Xn,"f")}get body(){return g(this,qr,"f")}get bodyHtml(){return g(this,Yn,"f")}get url(){return g(this,eo,"f")}get thumbnail(){return g(this,so,"f")}get createdAt(){return g(this,Jn,"f")}get score(){return g(this,to,"f")}get numberOfComments(){return g(this,ro,"f")}get numberOfReports(){return g(this,io,"f")}get approved(){return g(this,nr,"f")}get approvedAtUtc(){return g(this,no,"f")}get bannedAtUtc(){return g(this,oo,"f")}get spam(){return g(this,Jr,"f")}get stickied(){return g(this,es,"f")}get removed(){return g(this,or,"f")}get removedBy(){return g(this,ts,"f")}get removedByCategory(){return g(this,rs,"f")}get archived(){return g(this,is,"f")}get edited(){return g(this,ar,"f")}get locked(){return g(this,cr,"f")}get nsfw(){return g(this,dr,"f")}get quarantined(){return g(this,ss,"f")}get spoiler(){return g(this,lr,"f")}get hidden(){return g(this,ur,"f")}get ignoringReports(){return g(this,hr,"f")}get distinguishedBy(){return g(this,Pt,"f")}get comments(){return ne.getComments({postId:this.id},g(this,L,"f"))}get flair(){return g(this,ao,"f")}get authorFlair(){return g(this,co,"f")}get secureMedia(){return g(this,lo,"f")}get userReportReasons(){return g(this,os,"f")}get modReportReasons(){return g(this,ns,"f")}get gallery(){return g(this,as,"f")}toJSON(){return{id:this.id,authorId:this.authorId,authorName:this.authorName,subredditId:this.subredditId,subredditName:this.subredditName,permalink:this.permalink,title:this.title,body:this.body,bodyHtml:this.bodyHtml,url:this.url,thumbnail:this.thumbnail,score:this.score,numberOfComments:this.numberOfComments,numberOfReports:this.numberOfReports,createdAt:this.createdAt,approved:this.approved,spam:this.spam,stickied:this.stickied,removed:this.removed,removedBy:g(this,ts,"f"),removedByCategory:g(this,rs,"f"),archived:this.archived,edited:this.edited,locked:this.locked,nsfw:this.nsfw,quarantined:this.quarantined,spoiler:this.spoiler,hidden:this.hidden,ignoringReports:this.ignoringReports,distinguishedBy:this.distinguishedBy,flair:this.flair,authorFlair:this.authorFlair,secureMedia:this.secureMedia,modReportReasons:g(this,ns,"f"),userReportReasons:g(this,os,"f")}}isApproved(){return g(this,nr,"f")}isSpam(){return g(this,Jr,"f")}isStickied(){return g(this,es,"f")}isRemoved(){return g(this,or,"f")}isArchived(){return g(this,is,"f")}isEdited(){return g(this,ar,"f")}isLocked(){return g(this,cr,"f")}isNsfw(){return g(this,dr,"f")}isQuarantined(){return g(this,ss,"f")}isSpoiler(){return g(this,lr,"f")}isHidden(){return g(this,ur,"f")}isIgnoringReports(){return g(this,hr,"f")}isDistinguishedBy(){return g(this,Pt,"f")}async edit(e){let t=await r.edit({id:this.id,...e},g(this,L,"f"));k(this,qr,t.body,"f"),k(this,ar,t.edited,"f")}async setSuggestedCommentSort(e){await r.setSuggestedCommentSort({id:this.id,subredditId:g(this,Yi,"f"),suggestedSort:e},g(this,L,"f"))}async getPostData(){return(await r.getDevvitPostData(this.id,g(this,L,"f")))?.developerData}async setPostData(e){let t=await r.getDevvitPostData(this.id,g(this,L,"f"));await r.setPostData({postId:this.id,postData:{...t,developerData:e}},g(this,L,"f"))}async setCustomPostPreview(e){await r.setCustomPostPreview({id:this.id,ui:e},g(this,L,"f"))}async setTextFallback(e){let t=await r.setTextFallback(e,this.id,g(this,L,"f"));k(this,qr,t.body,"f"),k(this,ar,t.edited,"f")}async addComment(e){return ne.submit({id:this.id,...e},g(this,L,"f"))}async delete(){u(g(this,L,"f"));let e=g(this,L,"f")?.[A.App]?.values[0];if(e!==g(this,Kr,"f"))throw new Error(`App '${e}' is not the author of Post ${this.id}, delete not allowed.`);return r.delete(this.id,g(this,L,"f"))}async approve(){await r.approve(this.id,g(this,L,"f")),k(this,nr,!0,"f"),k(this,or,!1,"f")}async remove(e=!1){await r.remove(this.id,e,g(this,L,"f")),k(this,or,!0,"f"),k(this,Jr,e,"f"),k(this,nr,!1,"f")}async lock(){await r.lock(this.id,g(this,L,"f")),k(this,cr,!0,"f")}async unlock(){await r.unlock(this.id,g(this,L,"f")),k(this,cr,!1,"f")}async hide(){await r.hide(this.id,g(this,L,"f")),k(this,ur,!0,"f")}async unhide(){await r.unhide(this.id,g(this,L,"f")),k(this,ur,!1,"f")}async markAsNsfw(){await r.markAsNsfw(this.id,g(this,L,"f")),k(this,dr,!0,"f")}async unmarkAsNsfw(){await r.unmarkAsNsfw(this.id,g(this,L,"f")),k(this,dr,!1,"f")}async markAsSpoiler(){await r.markAsSpoiler(this.id,g(this,L,"f")),k(this,lr,!0,"f")}async unmarkAsSpoiler(){await r.unmarkAsSpoiler(this.id,g(this,L,"f")),k(this,lr,!1,"f")}async sticky(e){await r.sticky(this.id,e,g(this,L,"f"))}async unsticky(){await r.unsticky(this.id,g(this,L,"f"))}async distinguish(){let{distinguishedBy:e}=await r.distinguish(this.id,!1,g(this,L,"f"));k(this,Pt,e,"f")}async distinguishAsAdmin(){let{distinguishedBy:e}=await r.distinguish(this.id,!0,g(this,L,"f"));k(this,Pt,e,"f")}async undistinguish(){let{distinguishedBy:e}=await r.undistinguish(this.id,g(this,L,"f"));k(this,Pt,e,"f")}async ignoreReports(){await r.ignoreReports(this.id,g(this,L,"f")),k(this,hr,!0,"f")}async unignoreReports(){await r.unignoreReports(this.id,g(this,L,"f")),k(this,hr,!1,"f")}async getAuthor(){return C.getByUsername(g(this,Kr,"f"),g(this,L,"f"))}async crosspost(e){return r.crosspost({...e,postId:this.id},g(this,L,"f"))}addRemovalNote(e){return Le.addRemovalNote({itemIds:[g(this,Xi,"f")],...e},g(this,L,"f"))}async getEnrichedThumbnail(){return kp({id:this.id},g(this,L,"f"))}static async getById(e,t){let i=a.redditAPIPlugins.LinksAndComments,s=Ut(e)?e:`t3_${e}`,n=await i.Info({subreddits:[],thingIds:[s]},t);if(!n.data?.children?.length)throw new Error("could not find post");let o=n.data.children[0];if(!o?.data)throw new Error("could not find post");return new r(o.data,t)}static async submit(e,t){let{runAs:i="APP"}=e,s=pe[i],n=s===pe.USER?a.userActionsPlugin:a.redditAPIPlugins.LinksAndComments;s===pe.USER&&a.assertUserScope(_h.SUBMIT_POST);let o;if("preview"in e){u(t,"Missing metadata in `SubmitPostOptions`"),s===pe.USER&&u(e.userGeneratedContent,"userGeneratedContent must be set in `SubmitPostOptions` when RunAs=USER for experience posts");let f=await new ot(()=>e.preview,void 0,{},t,void 0).buildBlocksUI(),v=kh.encode(f).finish(),{textFallback:y,...P}=e,T=y?Oc(y):"",ee=e.userGeneratedContent?{text:e.userGeneratedContent.text??"",imageUrls:e.userGeneratedContent.imageUrls??[]}:void 0,B=e.postData?{developerData:e.postData}:void 0,te={kind:"custom",sr:e.subredditName,richtextJson:(0,Lc.fromByteArray)(v),richtextFallback:T,...P,userGeneratedContent:ee,runAs:s,postData:B};o=await n.SubmitCustomPost(te,t)}else o=await n.Submit({kind:"kind"in e?e.kind:"url"in e?"link":"self",sr:e.subredditName,richtextJson:"richtext"in e?Gr(e.richtext):void 0,...e,runAs:s},t);if("kind"in e&&["image","video","videogif"].includes(e.kind)&&!o.json?.data?.id){if(e.kind==="image"&&"imageUrls"in e)throw new Error(`Image post type with ${e.imageUrls} is being created asynchronously and should be updated in the subreddit soon.`);if("videoPosterUrl"in e)throw new Error(`Post of ${e.kind} type with ${e.videoPosterUrl} is being created asynchronously and should be updated in the subreddit soon.`)}if(o.json?.errors?.length){let l=Zi(o.json.errors),f=o.json?.data?.id?` ${o.json.data.id}`:"";throw new Error(`failed to submit post${f} - errors: ${l.join(", ")}`)}else if(!o.json?.data?.id)throw new Error("failed to submit post - no post ID returned but no error details found");return r.getById(`t3_${o.json.data.id}`,t)}static async crosspost(e,t){let{runAs:i="APP"}=e,s=pe[i],n=s===pe.USER?a.userActionsPlugin:a.redditAPIPlugins.LinksAndComments,{postId:o,subredditName:c,...l}=e;s===pe.USER&&a.assertUserScope(_h.SUBMIT_POST);let f=await n.Submit({kind:"crosspost",sr:c,crosspostFullname:Te(o),...l,runAs:s},t);if(!f.json?.data?.id||f.json?.errors?.length){let v=f.json?.errors?Zi(f.json.errors):[];throw new Error(`failed to crosspost post: ${v.join(", ")}`)}return r.getById(`t3_${f.json.data.id}`,t)}static async edit(e,t){let i=a.redditAPIPlugins.LinksAndComments,{id:s}=e,n;if("richtext"in e&&(n=Gr(e.richtext)),(await i.EditUserText({thingId:s,text:"text"in e?e.text:"",richtextJson:n,runAs:pe.APP},t)).json?.errors?.length)throw new Error("Failed to edit post");return r.getById(s,t)}static async setSuggestedCommentSort(e,t){if(!(await ce.query("SetSuggestedSort","cf6052acc7fefaa65b710625b81dba8041f258313aafe9730e2a3dc855e5d10d",{input:{subredditId:e.subredditId,postId:e.id,sort:e.suggestedSort}},t)).data?.setSuggestedSort?.ok)throw new Error("Failed to set suggested sort")}static async getDevvitPostData(e,t){let n=await ce.query("GetDevvitPostData","d349c9bee385336e44837c4a041d4b366fa32f16121cef7f12e1e3f230340696",{id:e},t);if(n.data?.postInfoById?.errors)throw new Error(`Failed to get devvit post data due to errors: ${n.data?.postInfoById?.errors.join(", ")}`);let o=n.data?.postInfoById?.devvit?.postData;if(o)return JSON.parse(o)}static async setPostData(e,t){let i=await a.redditAPIPlugins.LinksAndComments.EditCustomPost({thingId:e.postId,postData:e.postData},t);if(i.json?.errors?.length){let s=Zi(i.json.errors);throw new Error(`Failed to set post data, errors: ${s.join(", ")}`)}}static async setCustomPostPreview(e,t){if(!t)throw new Error("Failed to set custom post preview. Metadata not found");let i=a.redditAPIPlugins.LinksAndComments,s=new Yt(e.ui),o=bp.fromJSON(await s.handle({events:[]},t)).blocks,c=(0,Lc.fromByteArray)(kh.encode(o).finish());await i.SetCustomPostPreview({thingId:e.id,bodyType:vp.BLOCKS,blocksRenderContent:c},t)}static async setTextFallback(e,t,i){if(!("text"in e)&&!("richtext"in e))throw new Error(`No text fallback provided for post ${t}.`);let s=a.redditAPIPlugins.LinksAndComments,n=Oc(e),o=await s.EditCustomPost({thingId:t,richtextFallback:n},i);if(o.json?.errors?.length){let c=Zi(o.json.errors);throw Error(`set post ${t} text fallback failed: ${c.join(", ")}`)}return r.getById(t,i)}static async delete(e,t){await a.redditAPIPlugins.LinksAndComments.Del({id:e},t)}static async approve(e,t){await a.redditAPIPlugins.Moderation.Approve({id:e},t)}static async remove(e,t=!1,i){await a.redditAPIPlugins.Moderation.Remove({id:e,spam:t},i)}static async hide(e,t){await a.redditAPIPlugins.LinksAndComments.Hide({id:e},t)}static async unhide(e,t){await a.redditAPIPlugins.LinksAndComments.Unhide({id:e},t)}static async markAsNsfw(e,t){await a.redditAPIPlugins.LinksAndComments.MarkNSFW({id:e},t)}static async unmarkAsNsfw(e,t){await a.redditAPIPlugins.LinksAndComments.UnmarkNSFW({id:e},t)}static async markAsSpoiler(e,t){await a.redditAPIPlugins.LinksAndComments.Spoiler({id:e},t)}static async unmarkAsSpoiler(e,t){await a.redditAPIPlugins.LinksAndComments.Unspoiler({id:e},t)}static async sticky(e,t,i){await a.redditAPIPlugins.LinksAndComments.SetSubredditSticky({id:e,state:!0,num:t},i)}static async unsticky(e,t){await a.redditAPIPlugins.LinksAndComments.SetSubredditSticky({id:e,state:!1},t)}static async lock(e,t){await a.redditAPIPlugins.LinksAndComments.Lock({id:e},t)}static async unlock(e,t){await a.redditAPIPlugins.LinksAndComments.Unlock({id:e},t)}static async distinguish(e,t,i){let o=(await a.redditAPIPlugins.Moderation.Distinguish({id:e,how:t?"admin":"yes",sticky:!1},i)).json?.data?.things?.[0]?.data;return u(o),{distinguishedBy:o.distinguished}}static async undistinguish(e,t){let n=(await a.redditAPIPlugins.Moderation.Distinguish({id:e,how:"no",sticky:!1},t)).json?.data?.things?.[0]?.data;return u(n),{distinguishedBy:n.distinguished}}static async ignoreReports(e,t){await a.redditAPIPlugins.Moderation.IgnoreReports({id:e},t)}static async unignoreReports(e,t){await a.redditAPIPlugins.Moderation.UnignoreReports({id:e},t)}static getControversialPosts(e={},t){return this.getSortedPosts({...e,sort:"controversial"},t)}static getTopPosts(e={},t){return this.getSortedPosts({...e,sort:"top"},t)}static getSortedPosts(e,t){let i=a.redditAPIPlugins.Listings;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,fetch:async s=>{let n=await i.Sort({show:"all",sort:e.sort,t:e.timeframe,subreddit:e.subredditName,...s},t);return Qi(n,t)}})}static getHotPosts(e={location:"GLOBAL"},t){let i=a.redditAPIPlugins.Listings;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,fetch:async s=>{let n=await i.Hot({g:e.location,show:"all",subreddit:e.subredditName,...s},t);return Qi(n,t)}})}static getNewPosts(e,t){let i=a.redditAPIPlugins.Listings;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,fetch:async s=>{let n=await i.New({show:"all",subreddit:e.subredditName,...s},t);return Qi(n,t)}})}static getRisingPosts(e,t){let i=a.redditAPIPlugins.Listings;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,fetch:async s=>{let n=await i.Rising({show:"all",subreddit:e.subredditName,...s},t);return Qi(n,t)}})}static getPostsByUser(e,t){let i=a.redditAPIPlugins.Users;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,async fetch(s){let n=await i.UserWhere({username:e.username,where:"submitted",...s},t);return Qi(n,t)}})}};Xi=new WeakMap,qn=new WeakMap,Kr=new WeakMap,Jn=new WeakMap,Yi=new WeakMap,Zn=new WeakMap,Qn=new WeakMap,Xn=new WeakMap,qr=new WeakMap,Yn=new WeakMap,eo=new WeakMap,to=new WeakMap,ro=new WeakMap,io=new WeakMap,so=new WeakMap,nr=new WeakMap,no=new WeakMap,oo=new WeakMap,Jr=new WeakMap,es=new WeakMap,or=new WeakMap,ts=new WeakMap,rs=new WeakMap,is=new WeakMap,ar=new WeakMap,cr=new WeakMap,dr=new WeakMap,ss=new WeakMap,lr=new WeakMap,ur=new WeakMap,hr=new WeakMap,Pt=new WeakMap,ao=new WeakMap,co=new WeakMap,lo=new WeakMap,ns=new WeakMap,os=new WeakMap,as=new WeakMap,L=new WeakMap;function Qi(r,e){if(!r.data?.children)throw new Error("Listing response is missing children");return{children:r.data.children.map(i=>new X(i.data,e)),before:r.data.before,after:r.data.after}}async function kp(r,e){let n=(await ce.query("GetThumbnailV2","81580ce4e23d748c5a59a1618489b559bf4518b6a73af41f345d8d074c8b2ce9",{id:r.id},e)).data?.postInfoById?.thumbnailV2;if(n){if(!n.image)return}else throw new Error("Failed to get thumbnail");return{attribution:n.attribution,image:{url:n.image.url,width:n.image.dimensions.width,height:n.image.dimensions.height},isObfuscatedDefault:n.isObfuscatedDefault,...n.obfuscatedImage&&{obfuscatedImage:{url:n.obfuscatedImage.url,width:n.obfuscatedImage.dimensions.width,height:n.obfuscatedImage.dimensions.height}}}}var Ne=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},K=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},uo,Zr,ho,fo,mo,po,go,fr,wo,yo,bo,vo,ko,tt,Eh;(function(r){r.Custom="CUSTOM",r.Reddit="REDDIT",r.Instagram="INSTAGRAM",r.Twitter="TWITTER",r.Tiktok="TIKTOK",r.Twitch="TWITCH",r.Facebook="FACEBOOK",r.Youtube="YOUTUBE",r.Tumblr="TUMBLR",r.Spotify="SPOTIFY",r.Soundcloud="SOUNDCLOUD",r.Beacons="BEACONS",r.Linktree="LINKTREE",r.Discord="DISCORD",r.Venmo="VENMO",r.CashApp="CASH_APP",r.Patreon="PATREON",r.Kofi="KOFI",r.Paypal="PAYPAL",r.Cameo="CAMEO",r.Onlyfans="ONLYFANS",r.Substack="SUBSTACK",r.Kickstarter="KICKSTARTER",r.Indiegogo="INDIEGOGO",r.BuyMeACoffee="BUY_ME_A_COFFEE",r.Shopify="SHOPIFY"})(Eh||(Eh={}));var C=class r{constructor(e,t){uo.set(this,void 0),Zr.set(this,void 0),ho.set(this,void 0),fo.set(this,void 0),mo.set(this,void 0),po.set(this,void 0),go.set(this,void 0),fr.set(this,new Map),wo.set(this,void 0),yo.set(this,void 0),bo.set(this,void 0),vo.set(this,void 0),ko.set(this,void 0),tt.set(this,void 0),ae(this),u(e.id,"User ID is missing or undefined"),u(e.name,"Username is missing or undefined"),u(e.createdUtc,"User is missing created date"),Ne(this,uo,we(Xs(e.id)?e.id:`t2_${e.id}`),"f"),Ne(this,Zr,e.name,"f"),Ne(this,po,e.over18??!1,"f"),Ne(this,go,e.isEmployee??!1,"f");let i=new Date(0);if(i.setUTCSeconds(e.createdUtc),Ne(this,ho,i,"f"),Ne(this,fo,e.linkKarma??0,"f"),Ne(this,mo,e.commentKarma??0,"f"),e.modPermissions)for(let[s,n]of Object.entries(e.modPermissions))K(this,fr,"f").set(s,wh(n));Ne(this,wo,new URL(e.subreddit?.url??"","https://www.reddit.com").toString(),"f"),Ne(this,yo,e.subreddit?.url??"","f"),Ne(this,bo,e.hasVerifiedEmail??!1,"f"),Ne(this,vo,e.subreddit?.title??K(this,Zr,"f"),"f"),Ne(this,ko,e.subreddit?.publicDescription??"","f"),Ne(this,tt,t,"f")}get id(){return K(this,uo,"f")}get username(){return K(this,Zr,"f")}get createdAt(){return K(this,ho,"f")}get linkKarma(){return K(this,fo,"f")}get commentKarma(){return K(this,mo,"f")}get nsfw(){return K(this,po,"f")}get isAdmin(){return K(this,go,"f")}get modPermissions(){return K(this,fr,"f")}get url(){return K(this,wo,"f")}get permalink(){return K(this,yo,"f")}get hasVerifiedEmail(){return K(this,bo,"f")}get displayName(){return K(this,vo,"f")}get about(){return K(this,ko,"f")}toJSON(){return{id:this.id,username:this.username,createdAt:this.createdAt,linkKarma:this.linkKarma,commentKarma:this.commentKarma,nsfw:this.nsfw,modPermissionsBySubreddit:Object.fromEntries(this.modPermissions)}}async getModPermissionsForSubreddit(e){if(K(this,fr,"f").has(e))return K(this,fr,"f").get(e);let t=await r.getSubredditUsersByType({subredditName:e,type:"moderators",username:this.username},K(this,tt,"f")).all();if(t.length===0)return[];let i=t[0].modPermissions.get(e)??[];return i.length>0&&K(this,fr,"f").set(e,i),i}getComments(e){return ne.getCommentsByUser({username:this.username,...e},K(this,tt,"f"))}getPosts(e){return X.getPostsByUser({username:this.username,...e},K(this,tt,"f"))}async getUserFlairBySubreddit(e){let t=await Ee.getUserFlairBySubreddit({subreddit:e,name:K(this,Zr,"f")},K(this,tt,"f"));return t.users[0]?Ki(t.users[0]):void 0}getSnoovatarUrl(){return r.getSnoovatarUrl(this.username,K(this,tt,"f"))}async getSocialLinks(){let i=await ce.query("GetUserSocialLinks","2aca18ef5f4fc75fb91cdaace3e9aeeae2cb3843b5c26ad511e6f01b8521593a",{name:this.username},K(this,tt,"f"));return i.data?.user?.profile?.socialLinks?i.data.user.profile.socialLinks.map(s=>({...s,handle:s.handle??void 0})):[]}async getUserKarmaFromCurrentSubreddit(){return await r.getUserKarmaFromCurrentSubreddit(this.username,K(this,tt,"f"))}static async getById(e,t){let i=await Ch(e,t);return i==null?void 0:r.getByUsername(i,t)}static async getByUsername(e,t){let i=a.redditAPIPlugins.Users;try{let s=await i.UserAbout({username:e},t);if(s.data?.id)return new r(s.data,t)}catch(s){if(s instanceof Error&&s.message.includes("404 Not Found"))return;throw s}}static async getFromMetadata(e,t){u(t);let i=t?.[e]?.values[0];return i?r.getById(we(i),t):Promise.resolve(void 0)}static getSubredditUsersByType(e,t){let i=a.redditAPIPlugins.Subreddits;return new J({hasMore:!0,pageSize:e.pageSize,limit:e.limit,after:e.after,before:e.before,fetch:async s=>{let n=await i.AboutWhere({where:e.type,user:e.username,subreddit:e.subredditName,show:"all",...s},t);return Ep(n,e.subredditName,t)}})}static async createRelationship(e,t){let i=a.redditAPIPlugins.Users,{type:s,subredditName:n,username:o,permissions:c,...l}=e,f=await i.Friend({type:s,subreddit:n,name:o,permissions:c?Bc(c):void 0,...l},t);if(f.json?.errors?.length)throw new Error(f.json.errors.join(`
`))}static async removeRelationship(e,t){await a.redditAPIPlugins.Users.Unfriend({type:e.type,subreddit:e.subredditName,name:e.username},t)}static async setModeratorPermissions(e,t,i,s){let o=await a.redditAPIPlugins.Users.SetPermissions({subreddit:t,name:e,type:"moderator",permissions:Bc(i)},s);if(o.json?.errors?.length)throw new Error(o.json.errors.join(`
`))}static async getSnoovatarUrl(e,t){return(await ce.query("GetSnoovatarUrlByName","c47fd42345af268616d2d8904b56856acdc05cf61d3650380f539ad7d596ac0c",{username:e},t)).data?.redditorInfoByName?.snoovatarIcon?.url}static getOverview(e,t){let i=a.redditAPIPlugins.Users;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,async fetch(s){let n=await i.UserWhere({username:e.username,where:"overview",...s},t);return _p(n,t)}})}static async getUserKarmaFromCurrentSubreddit(e,t){u(t);let i=t?.[A.Subreddit]?.values[0];if(!i)throw new Error("Subreddit ID is missing from metadata");return await a.redditAPIPlugins.Users.GetUserKarmaForSubreddit({username:e,subredditId:i})}};uo=new WeakMap,Zr=new WeakMap,ho=new WeakMap,fo=new WeakMap,mo=new WeakMap,po=new WeakMap,go=new WeakMap,fr=new WeakMap,wo=new WeakMap,yo=new WeakMap,bo=new WeakMap,vo=new WeakMap,ko=new WeakMap,tt=new WeakMap;function _p(r,e){if(!r.data?.children)throw new Error("Listing response is missing children");return{children:r.data.children.map(i=>{if(i.kind==="t3")return new X(i.data,e);if(i.kind==="t1")return new ne(i.data,e);throw new Error(`Type ${i.kind} is not supported`)}),before:r.data.before,after:r.data.after}}async function Ep(r,e,t){let i=a.redditAPIPlugins.Users;if(!r.data?.children)throw new Error("Listing response is missing children");let s=r.data.children.map(v=>(u(v.data?.id,"User id is still from listing data"),v.data.id)),n=100,o=[];for(let v=0;v<s.length;v+=n)o.push(s.slice(v,v+n));let l=(await Promise.all(o.map(v=>i.UserDataByAccountIds({ids:v.join(",")},t)))).reduce((v,y)=>({...v,...y.users}),{});return{children:r.data.children.map(v=>{let y=v.data?.id;u(y,"User id is missing from listing");let P=l[y];return u(P,"User data is missing from response"),new C({id:y,name:P.name,linkKarma:P.linkKarma,commentKarma:P.commentKarma,createdUtc:P.createdUtc,over18:P.profileOver18,snoovatarSize:[],modPermissions:{[e]:v.data?.modPermissions??[]}},t)}),before:r.data.before,after:r.data.after}}async function Ch(r,e){return(await a.redditAPIPlugins.Users.UserDataByAccountIds({ids:r},e))?.users?.[r]?.name}async function Td(r){u(r);let e=r?.[A.Username]?.values[0];if(e)return e;let t=r?.[A.User]?.values[0];if(t)return Ch(t,r)}var I=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},E=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},W,Qr,_o,cs,ds,Eo,Co,ls,Fo,Ao,hs,mr,Po,Io,Xr,pr,gr,It,Yr,Tt,To,So,xo,Ro,Mo,No,Do,wr,us,he,Bo,Wc,ne=class{constructor(e,t){Qr.set(this,void 0),_o.set(this,void 0),cs.set(this,void 0),ds.set(this,void 0),Eo.set(this,void 0),Co.set(this,void 0),ls.set(this,void 0),Fo.set(this,void 0),Ao.set(this,void 0),hs.set(this,void 0),mr.set(this,void 0),Po.set(this,void 0),Io.set(this,void 0),Xr.set(this,void 0),pr.set(this,void 0),gr.set(this,void 0),It.set(this,void 0),Yr.set(this,void 0),Tt.set(this,void 0),To.set(this,void 0),So.set(this,void 0),xo.set(this,void 0),Ro.set(this,void 0),Mo.set(this,void 0),No.set(this,void 0),Do.set(this,void 0),wr.set(this,void 0),us.set(this,void 0),he.set(this,void 0),ae(this),u(e.id,"Comment id is null or undefined"),u(e.body,"Comment body is null or undefined"),u(e.createdUtc,"Comment is missing created date"),u(e.author,"Comment author is null or undefined"),u(e.parentId,"Comment parentId is null or undefined"),u(e.linkId,"Comment linkId is null or undefined"),u(e.permalink,"Comment permalink is null or undefined"),u(e.subreddit,"Comment is missing subreddit name"),u(e.subredditId,"Comment is missing subreddit id"),I(this,Qr,Ar(`t1_${e.id}`),"f"),I(this,_o,e.authorFullname?we(e.authorFullname):void 0,"f"),I(this,cs,e.author,"f"),I(this,ds,e.body,"f"),I(this,Fo,se(e.subredditId),"f"),I(this,Ao,e.subreddit,"f"),I(this,Co,Ta(e.parentId)?Ar(e.parentId):Te(e.parentId),"f"),I(this,ls,Te(e.linkId),"f"),I(this,Xr,e.edited??!1,"f"),I(this,pr,e.locked??!1,"f"),I(this,gr,e.removed??!1,"f"),I(this,It,e.stickied??!1,"f"),I(this,mr,e.approved??!1,"f"),I(this,Po,e.approvedAtUtc??0,"f"),I(this,Io,e.bannedAtUtc??0,"f"),I(this,Yr,e.spam??!1,"f"),I(this,Tt,e.distinguished,"f"),I(this,To,e.numReports??0,"f"),I(this,So,e.collapsedBecauseCrowdControl??!1,"f"),I(this,xo,e.score??0,"f"),I(this,Ro,e.permalink,"f"),I(this,Do,new URL(e.permalink??"","https://www.reddit.com/").toString(),"f"),I(this,wr,e.ignoreReports??!1,"f"),I(this,us,zi({flairBackgroundColor:e.authorFlairBackgroundColor,flairCssClass:e.authorFlairCssClass,flairText:e.authorFlairText,flairType:e.authorFlairType,flairTemplateId:e.authorFlairTemplateId,flairRichtext:e.authorFlairRichtext,flairTextColor:e.authorFlairTextColor}),"f"),I(this,Mo,(e.modReports??[]).map(([s])=>s),"f"),I(this,No,(e.userReports??[]).map(([s])=>s),"f");let i=new Date(0);i.setUTCSeconds(e.createdUtc),I(this,Eo,i,"f"),I(this,hs,E(W,W,"m",Bo).call(W,{postId:E(this,ls,"f"),commentId:E(this,Qr,"f")},t),"f"),I(this,he,t,"f")}get id(){return E(this,Qr,"f")}get authorId(){return E(this,_o,"f")}get authorName(){return E(this,cs,"f")}get subredditId(){return E(this,Fo,"f")}get subredditName(){return E(this,Ao,"f")}get body(){return E(this,ds,"f")}get createdAt(){return E(this,Eo,"f")}get parentId(){return E(this,Co,"f")}get postId(){return E(this,ls,"f")}get replies(){return E(this,hs,"f")}get distinguishedBy(){return E(this,Tt,"f")}get locked(){return E(this,pr,"f")}get stickied(){return E(this,It,"f")}get removed(){return E(this,gr,"f")}get approved(){return E(this,mr,"f")}get approvedAtUtc(){return E(this,Po,"f")}get bannedAtUtc(){return E(this,Io,"f")}get spam(){return E(this,Yr,"f")}get edited(){return E(this,Xr,"f")}get numReports(){return E(this,To,"f")}get collapsedBecauseCrowdControl(){return E(this,So,"f")}get score(){return E(this,xo,"f")}get permalink(){return E(this,Ro,"f")}get userReportReasons(){return E(this,No,"f")}get modReportReasons(){return E(this,Mo,"f")}get url(){return E(this,Do,"f")}get ignoringReports(){return E(this,wr,"f")}get authorFlair(){return E(this,us,"f")}toJSON(){return{id:this.id,authorName:this.authorName,subredditId:this.subredditId,subredditName:this.subredditName,body:this.body,createdAt:this.createdAt,parentId:this.parentId,postId:this.postId,replies:this.replies,approved:this.approved,locked:this.locked,removed:this.removed,stickied:this.stickied,spam:this.spam,edited:this.edited,distinguishedBy:this.distinguishedBy,numReports:this.numReports,collapsedBecauseCrowdControl:this.collapsedBecauseCrowdControl,score:this.score,permalink:this.permalink,modReportReasons:this.modReportReasons,userReportReasons:this.userReportReasons,url:this.url,ignoringReports:this.ignoringReports,authorFlair:E(this,us,"f")}}isLocked(){return E(this,pr,"f")}isApproved(){return E(this,mr,"f")}isRemoved(){return E(this,gr,"f")}isSpam(){return E(this,Yr,"f")}isStickied(){return E(this,It,"f")}isDistinguished(){return!!E(this,Tt,"f")}isEdited(){return E(this,Xr,"f")}isIgnoringReports(){return E(this,wr,"f")}async delete(){return W.delete(this.id,E(this,he,"f"))}async edit(e){let t=await W.edit({id:this.id,...e},E(this,he,"f"));return I(this,ds,t.body,"f"),I(this,Xr,t.edited,"f"),this}async approve(){await W.approve(this.id,E(this,he,"f")),I(this,mr,!0,"f"),I(this,gr,!1,"f")}async remove(e=!1){await W.remove(this.id,e,E(this,he,"f")),I(this,gr,!0,"f"),I(this,Yr,e,"f"),I(this,mr,!1,"f")}async lock(){await W.lock(this.id,E(this,he,"f")),I(this,pr,!0,"f")}async unlock(){await W.unlock(this.id,E(this,he,"f")),I(this,pr,!1,"f")}async reply(e){return W.submit({id:this.id,...e},E(this,he,"f"))}async getAuthor(){return C.getByUsername(E(this,cs,"f"),E(this,he,"f"))}async distinguish(e=!1){let{distinguishedBy:t,stickied:i}=await W.distinguish(this.id,e,!1,E(this,he,"f"));I(this,Tt,t,"f"),I(this,It,i,"f")}async distinguishAsAdmin(e=!1){let{distinguishedBy:t,stickied:i}=await W.distinguish(this.id,e,!0,E(this,he,"f"));I(this,Tt,t,"f"),I(this,It,i,"f")}async undistinguish(){let{distinguishedBy:e,stickied:t}=await W.undistinguish(this.id,E(this,he,"f"));I(this,Tt,e,"f"),I(this,It,t,"f")}async ignoreReports(){await W.ignoreReports(this.id,E(this,he,"f")),I(this,wr,!0,"f")}async unignoreReports(){await W.unignoreReports(this.id,E(this,he,"f")),I(this,wr,!1,"f")}addRemovalNote(e){return Le.addRemovalNote({itemIds:[E(this,Qr,"f")],...e},E(this,he,"f"))}static async getById(e,t){let i=a.redditAPIPlugins.LinksAndComments,s=wt(e)?e:`t1_${e}`,n=await i.Info({subreddits:[],thingIds:[s]},t);if(!n.data?.children?.[0]?.data)throw new Error("not found");return new W(n.data.children[0].data,t)}static getComments(e,t){let{postId:i,commentId:s,...n}=e;return E(W,W,"m",Bo).call(W,{postId:Te(i),commentId:s?Ar(s):void 0,...n},t)}static async edit(e,t){let i=a.redditAPIPlugins.LinksAndComments,{id:s}=e,n;"richtext"in e&&(n=Gr(e.richtext));let o=await i.EditUserText({thingId:s,text:"text"in e?e.text:"",richtextJson:n,runAs:pe.APP},t);if(o.json?.errors?.length)throw new Error("Failed to edit comment");let c=o.json?.data?.things?.[0]?.data;return u(c),new W(c,t)}static async delete(e,t){await a.redditAPIPlugins.LinksAndComments.Del({id:e},t)}static async approve(e,t){await a.redditAPIPlugins.Moderation.Approve({id:e},t)}static async remove(e,t=!1,i){await a.redditAPIPlugins.Moderation.Remove({id:e,spam:t},i)}static async lock(e,t){await a.redditAPIPlugins.LinksAndComments.Lock({id:e},t)}static async unlock(e,t){await a.redditAPIPlugins.LinksAndComments.Unlock({id:e},t)}static async submit(e,t){let{runAs:i="APP"}=e,s=pe[i],n=s===pe.USER?a.userActionsPlugin:a.redditAPIPlugins.LinksAndComments,{id:o}=e;s===pe.USER&&a.assertUserScope(Cp.SUBMIT_COMMENT);let c;"richtext"in e&&(c=Gr(e.richtext));let l=await n.Comment({thingId:o,text:"text"in e?e.text:"",richtextJson:c,runAs:s},t);if(l.json?.errors?.length)throw new Error("failed to reply to comment");let f=l.json?.data?.things?.[0]?.data;return u(f),new W(f,t)}static async distinguish(e,t,i,s){let c=(await a.redditAPIPlugins.Moderation.Distinguish({id:e,how:i?"admin":"yes",sticky:t},s)).json?.data?.things?.[0]?.data;return u(c),{distinguishedBy:c.distinguished,stickied:!!c.stickied}}static async undistinguish(e,t){let n=(await a.redditAPIPlugins.Moderation.Distinguish({id:e,how:"no",sticky:!1},t)).json?.data?.things?.[0]?.data;return u(n),{distinguishedBy:n.distinguished,stickied:!!n.stickied}}static getCommentsByUser(e,t){let i=a.redditAPIPlugins.Users;return new J({hasMore:!0,before:e.before,after:e.after,pageSize:e.pageSize,limit:e.limit,async fetch(s){let n=await i.UserWhere({username:e.username,where:"comments",...s},t);return u(n.data,"Failed to get comments for user"),{children:n.data.children?.map(c=>new W(c.data,t))||[],before:n.data.before,after:n.data.after}}})}static async ignoreReports(e,t){await a.redditAPIPlugins.Moderation.IgnoreReports({id:e},t)}static async unignoreReports(e,t){await a.redditAPIPlugins.Moderation.UnignoreReports({id:e},t)}};W=ne,Qr=new WeakMap,_o=new WeakMap,cs=new WeakMap,ds=new WeakMap,Eo=new WeakMap,Co=new WeakMap,ls=new WeakMap,Fo=new WeakMap,Ao=new WeakMap,hs=new WeakMap,mr=new WeakMap,Po=new WeakMap,Io=new WeakMap,Xr=new WeakMap,pr=new WeakMap,gr=new WeakMap,It=new WeakMap,Yr=new WeakMap,Tt=new WeakMap,To=new WeakMap,So=new WeakMap,xo=new WeakMap,Ro=new WeakMap,Mo=new WeakMap,No=new WeakMap,Do=new WeakMap,wr=new WeakMap,us=new WeakMap,he=new WeakMap,Bo=function(e,t,i=0){return new J({limit:e.limit,pageSize:e.pageSize,fetch:async s=>{let n=s.limit,o=a.redditAPIPlugins.Listings,c=a.redditAPIPlugins.LinksAndComments,l=e.commentId;if(s.more)if(s.more.children.length){let P=s.more;(!n||n>100)&&(n=100);let T=P.children.splice(0,n),ee=await c.MoreChildren({linkId:e.postId,children:T,sort:e.sort},t);if(!ee.json?.data?.things?.length)return{children:[]};let{children:B}=E(W,W,"m",Wc).call(W,ee.json.data.things,e.postId,e,t);return{children:B,more:P.children.length?P:void 0}}else l=s.more.parentId,i=i+s.more.depth;let v=(await o.Comments({article:e.postId.substring(3),comment:l?.substring(3),limit:n,depth:e.depth,sort:e.sort},t)).listings?.[1]?.data?.children??[],y=v[0];return l&&y?.data?.replyList?.data&&(v=y.data.replyList.data.children),E(W,W,"m",Wc).call(W,v,l??e.postId,e,t,i)}})},Wc=function r(e,t,i,s,n=0){let o=[],c,l={};for(let f of e){if(!f.data||(f.data.depth!=null&&(f.data.depth=f.data.depth+n),f.data.depth!=null&&i.depth!=null&&f.data.depth>=i.depth))continue;let v=f.data.parentId?l[f.data.parentId]:void 0;if(f.kind==="t1"){if(f.data.name===t)continue;let y=new W(f.data,s);if(l[y.id]=y,I(y,hs,E(W,W,"m",Bo).call(W,{...i,postId:y.postId,commentId:y.id},s,n),"f"),"replyList"in f.data&&f.data.replyList?.data){let{children:P,more:T}=E(W,W,"m",r).call(W,f.data.replyList.data.children,y.id,i,s,n);P.length&&y.replies.children.push(...P),T&&y.replies.setMore(T)}y.replies.preventInitialFetch(),v?v.replies.children.push(y):o.push(y)}else if(f.kind==="more"&&f.data.parentId&&f.data.depth!=null){let y={parentId:Ta(f.data.parentId)?Ar(f.data.parentId):Te(f.data.parentId),children:f.data.children??[],depth:f.data.depth};v?v.replies.setMore(y):y.parentId===t&&(c=y)}}return{children:o,more:c}};function tn(r,e){let t=a.redditAPIPlugins.Moderation;return new J({hasMore:!0,after:r.after,before:r.before,limit:r.limit,pageSize:r.pageSize,fetch:async i=>{let s=await t.AboutLog({subreddit:r.subredditName,mod:r.moderatorUsernames?r.moderatorUsernames.join(","):void 0,type:r.type,...i},e);return Fp(s)}})}function Fp(r){if(!r.data?.children)throw new Error("AboutLogResponse is missing children");return{children:r.data.children.map(t=>{if(!t.data)throw new Error("ModAction from AboutLogResponse is missing or invalid");let{id:i,mod:s,modId36:n,createdUtc:o,subreddit:c,subredditNamePrefixed:l,action:f,srId36:v,description:y,details:P,targetAuthor:T,targetBody:ee,targetFullname:B,targetPermalink:te,targetTitle:G}=t.data;u(i,"ModAction from AboutLogResponse is missing id"),u(s,"ModAction from AboutLogResponse is missing mod"),u(n,"ModAction from AboutLogResponse is missing modId36"),u(o,"ModAction from AboutLogResponse is missing createdUtc"),u(c,"ModAction from AboutLogResponse is missing subreddit"),u(l,"ModAction from AboutLogResponse is missing subredditNamePrefixed"),u(f,"ModAction from AboutLogResponse is missing action"),u(v,"ModAction from AboutLogResponse is missing srId36");let Hs=new Date(0);return Hs.setUTCSeconds(o),{id:i,type:f,moderatorName:s,moderatorId:`t2_${n}`,createdAt:Hs,subredditName:c,subredditId:`t5_${v}`,description:y,details:P,target:B?{id:B,author:T,body:ee,permalink:te,title:G}:void 0}}),after:r.data.after,before:r.data.before}}import"@devvit/protos";var Ap=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},U=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},de,q,ke,Fh,Ah,St;(function(r){r.New="New",r.InProgress="InProgress",r.Archived="Archived",r.Appeals="Appeals",r.JoinRequests="JoinRequests",r.Filtered="Filtered"})(St||(St={}));var Pp={0:St.New,1:St.InProgress,2:St.Archived,3:St.Appeals,4:St.JoinRequests,5:St.Filtered},_e;(function(r){r.Highlighted="Highlighted",r.Unhighlighted="Unhighlighted",r.Archived="Archived",r.Unarchived="Unarchived",r.ReportedToAdmins="ReportedToAdmins",r.Muted="Muted",r.Unmuted="Unmuted",r.Banned="Banned",r.Unbanned="Unbanned",r.Approved="Approved",r.Disapproved="Disapproved",r.Filtered="Filtered",r.Unfiltered="Unfiltered"})(_e||(_e={}));var Ip={0:_e.Highlighted,1:_e.Unhighlighted,2:_e.Archived,3:_e.Unarchived,4:_e.ReportedToAdmins,5:_e.Muted,6:_e.Unmuted,7:_e.Banned,8:_e.Unbanned,9:_e.Approved,10:_e.Disapproved,11:_e.Filtered,12:_e.Unfiltered},rn=class{constructor(e){de.add(this),q.set(this,void 0),this.notificationSubjectPrefix="[notification]",Ap(this,q,e,"f")}async bulkReadConversations(e,t){let i=a.redditAPIPlugins.NewModmail,{conversationIds:s}=await i.BulkReadConversations({entity:e.join(","),state:t},U(this,q,"f"));return s}async getConversations(e){let i=await a.redditAPIPlugins.NewModmail.GetConversations({after:e.after,entity:e.subreddits?e.subreddits.join(","):void 0,limit:e.limit,sort:e.sort,state:e.state},U(this,q,"f")),s={};for(let n in i.conversations)s[n]=U(this,de,"m",ke).call(this,{protoConversation:i.conversations[n],protoMessages:i.messages,protoModActions:{}});return{conversations:s,viewerId:i.viewerId,conversationIds:i.conversationIds}}async getConversation(e){let i=await a.redditAPIPlugins.NewModmail.GetConversation({...e,markRead:!!e.markRead},U(this,q,"f"));return{participantSubreddit:i.participantSubreddit,conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async getSubreddits(){let e=a.redditAPIPlugins.NewModmail,{subreddits:t}=await e.Subreddits({},U(this,q,"f"));return t}async createConversation(e){let i=await a.redditAPIPlugins.NewModmail.CreateConversation({body:e.body,isAuthorHidden:e.isAuthorHidden??!1,srName:e.subredditName,subject:e.subject,to:e.to?e.to:void 0},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async createModDiscussionConversation(e){return Hc({subject:e.subject,bodyMarkdown:e.bodyMarkdown,subredditId:se(e.subredditId),isInternal:!0,participantType:"MODERATOR",conversationType:"INTERNAL"},U(this,q,"f"))}async createModInboxConversation(e){return Hc({subject:e.subject,bodyMarkdown:e.bodyMarkdown,subredditId:se(e.subredditId),isInternal:!1,participantType:"PARTICIPANT_USER",conversationType:"SR_USER"},U(this,q,"f"))}async createModNotification(e){let t=e.subject;return e.subject.startsWith(this.notificationSubjectPrefix)||(t=`${this.notificationSubjectPrefix} ${e.subject}`),Hc({subject:t,bodyMarkdown:e.bodyMarkdown,subredditId:se(e.subredditId),isInternal:!1,participantType:"PARTICIPANT_USER",conversationType:"SR_USER"},U(this,q,"f"))}async reply(e){let i=await a.redditAPIPlugins.NewModmail.CreateConversationMessage({body:e.body,conversationId:e.conversationId,isAuthorHidden:e.isAuthorHidden??!1,isInternal:e.isInternal??!1},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:{}}),user:i.user}}async highlightConversation(e){let i=await a.redditAPIPlugins.NewModmail.HighlightConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:i.modActions})}}async unhighlightConversation(e){let i=await a.redditAPIPlugins.NewModmail.UnhighlightConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:i.modActions})}}async archiveConversation(e){let i=await a.redditAPIPlugins.NewModmail.ArchiveConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:i.modActions})}}async unarchiveConversation(e){let i=await a.redditAPIPlugins.NewModmail.UnarchiveConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversation,protoMessages:i.messages,protoModActions:i.modActions})}}async muteConversation(e){let i=await a.redditAPIPlugins.NewModmail.MuteConversation({conversationId:e.conversationId,numHours:e.numHours},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversations,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async unmuteConversation(e){let i=await a.redditAPIPlugins.NewModmail.UnmuteConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversations,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async readConversations(e){await a.redditAPIPlugins.NewModmail.Read({conversationIds:e.join(",")},U(this,q,"f"))}async unreadConversations(e){await a.redditAPIPlugins.NewModmail.Unread({conversationIds:e.join(",")},U(this,q,"f"))}async approveConversation(e){let i=await a.redditAPIPlugins.NewModmail.ApproveConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversations,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async disapproveConversation(e){let i=await a.redditAPIPlugins.NewModmail.DisapproveConversation({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversations,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async tempBanConversation(e){let i=await a.redditAPIPlugins.NewModmail.TempBan({...e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversations,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async unbanConversation(e){let i=await a.redditAPIPlugins.NewModmail.Unban({conversationId:e},U(this,q,"f"));return{conversation:U(this,de,"m",ke).call(this,{protoConversation:i.conversations,protoMessages:i.messages,protoModActions:i.modActions}),user:i.user}}async getUnreadCount(){return await a.redditAPIPlugins.NewModmail.UnreadCount({},U(this,q,"f"))}async getUserConversations(e){return await a.redditAPIPlugins.NewModmail.UserConversations({conversationId:e},U(this,q,"f"))}};q=new WeakMap,de=new WeakSet,ke=function({protoConversation:e,protoMessages:t,protoModActions:i}){return{...e,state:Pp[e.state],messages:U(this,de,"m",Fh).call(this,e,t),modActions:U(this,de,"m",Ah).call(this,e,i)}},Fh=function(e,t){let i={},s=e.objIds.filter(n=>n.key==="messages").map(({id:n})=>n);for(let n of s){let o=t[n];o&&(i[n]=o)}return i},Ah=function(e,t){let i={},s=e.objIds.filter(n=>n.key==="modActions").map(({id:n})=>n);for(let n of s){let o=t[n];o&&(i[n]={...o,actionType:Ip[o.actionTypeId]})}return i};async function Hc(r,e){let t=e[A.AppUser]?.values[0],n=await ce.query("CreateModmailConversation","5f9ae20b0c7bdffcafb80241728a72e67cd4239bc09f67284b79d4aa706ee0e5",{subject:r.subject,bodyMarkdown:r.bodyMarkdown,subredditId:r.subredditId,authorId:t,isInternal:r.isInternal,participantType:r.participantType,conversationType:r.conversationType},e);if(n.data?.createModmailConversationV2?.ok)return n.data?.createModmailConversationV2?.conversationId;throw new Error("modmail conversation creation failed; ${response.data?.createModmailConversationV2?.errors[0].message}")}var yr=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},br=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},fs,ms,Uo,Oo,Lo,Wo,Ot=class r{static async getMessages(e,t){let i=a.redditAPIPlugins.PrivateMessages;return new J({...e,fetch:async s=>{let n=await i.MessageWhere({...s,where:e.type??"inbox"},t);return{after:n.data?.after,before:n.data?.before,children:n.data?.children?.map(o=>new r(o.data,t)).filter(Boolean)||[]}}})}static async send({to:e,subject:t,text:i},s){await a.redditAPIPlugins.PrivateMessages.Compose({to:e,subject:t,text:i,fromSr:""},s)}static async sendAsSubreddit({to:e,fromSubredditName:t,subject:i,text:s},n){await a.redditAPIPlugins.PrivateMessages.Compose({to:e,fromSr:t,subject:i,text:s},n)}static async markAllAsRead(e){await a.redditAPIPlugins.PrivateMessages.ReadAllMessages({filterTypes:""},e)}constructor(e,t){if(fs.set(this,void 0),ms.set(this,void 0),Uo.set(this,void 0),Oo.set(this,void 0),Lo.set(this,void 0),Wo.set(this,void 0),ae(this),u(e.id,"PrivateMessage: Invalid data, no id"),u(e.name,"PrivateMessage: Invalid data, no name"),u(e.created,"PrivateMessage: Invalid data, no created date"),yr(this,fs,Oe(e.name),"f"),e.author!=null)yr(this,ms,{type:"user",username:e.author,id:e.authorFullname?we(e.authorFullname):void 0},"f");else if(e.subreddit!=null)yr(this,ms,{type:"subreddit",name:e.subreddit,id:e.subredditId?se(e.subredditId):void 0},"f");else throw new Error("PrivateMessage: Invalid data, no author or subreddit");yr(this,Uo,e.body??"","f"),yr(this,Oo,e.bodyHtml??"","f");let i=new Date(0);i.setUTCSeconds(e.createdUtc),yr(this,Lo,i,"f"),yr(this,Wo,t,"f")}get id(){return br(this,fs,"f")}get from(){return br(this,ms,"f")}get body(){return br(this,Uo,"f")}get bodyHtml(){return br(this,Oo,"f")}get created(){return br(this,Lo,"f")}async markAsRead(){await a.redditAPIPlugins.PrivateMessages.ReadMessage({id:br(this,fs,"f")},br(this,Wo,"f"))}};fs=new WeakMap,ms=new WeakMap,Uo=new WeakMap,Oo=new WeakMap,Lo=new WeakMap,Wo=new WeakMap;var De=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},w=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},ps,x,Ho,jo,Go,Vo,$o,zo,Ko,qo,Jo,gs,D,Re;(function(r){r.Reports="reports",r.Spam="spam",r.Modqueue="modqueue",r.Unmoderated="unmoderated",r.Edited="edited"})(Re||(Re={}));var Se=class r{constructor(e,t){ps.set(this,void 0),x.set(this,void 0),Ho.set(this,void 0),jo.set(this,void 0),Go.set(this,void 0),Vo.set(this,void 0),$o.set(this,void 0),zo.set(this,void 0),Ko.set(this,void 0),qo.set(this,void 0),Jo.set(this,void 0),gs.set(this,void 0),D.set(this,void 0),ae(this),u(e.id,"Subreddit id is missing or undefined"),u(e.displayName,"Subreddit name is missing or undefined"),De(this,ps,se(`t5_${e.id}`),"f"),De(this,x,e.displayName,"f"),u(e.createdUtc,"Subreddit is missing created date");let i=new Date(0);i.setUTCSeconds(e.createdUtc),De(this,Ho,i,"f"),De(this,jo,jc(e.subredditType),"f"),De(this,Go,e.title,"f"),De(this,Vo,e.description,"f"),u(e.lang,"Subreddit is missing language"),De(this,$o,e.lang,"f"),De(this,zo,e.subscribers??0,"f"),De(this,Ko,e.activeUserCount??0,"f"),De(this,qo,e.over18??!1,"f"),De(this,gs,e.url??"","f"),De(this,Jo,{acceptFollowers:e.acceptFollowers??!1,allOriginalContent:e.allOriginalContent??!1,allowChatPostCreation:e.allowChatPostCreation??!1,allowDiscovery:e.allowDiscovery??!1,allowGalleries:e.allowGalleries??!1,allowImages:e.allowImages??!1,allowPolls:e.allowPolls??!1,allowPredictionContributors:e.allowPredictionContributors??!1,allowPredictions:e.allowPredictions??!1,allowPredictionsTournament:e.allowPredictionsTournament??!1,allowTalks:e.allowTalks??!1,allowVideoGifs:e.allowVideogifs??!1,allowVideos:e.allowVideos??!1,chatPostEnabled:e.isChatPostFeatureEnabled??!1,collectionsEnabled:e.collectionsEnabled??!1,crosspostable:e.isCrosspostableSubreddit??!1,emojisEnabled:e.emojisEnabled??!1,eventPostsEnabled:e.eventPostsEnabled??!1,linkFlairEnabled:e.linkFlairEnabled??!1,originalContentTagEnabled:e.originalContentTagEnabled??!1,restrictCommenting:e.restrictCommenting??!1,restrictPosting:e.restrictPosting??!1,shouldArchivePosts:e.shouldArchivePosts??!1,spoilersEnabled:e.spoilersEnabled??!1,wikiEnabled:e.wikiEnabled??!1,allowedPostType:Tp(e.submissionType),allowedMediaInComments:(e.allowedMediaInComments??[]).map(Sp),bannerBackgroundColor:e.bannerBackgroundColor,bannerBackgroundImage:e.bannerBackgroundImage,bannerImage:e.bannerImg,communityIcon:e.communityIcon,headerTitle:e.headerTitle,keyColor:e.keyColor,mobileBannerImage:e.mobileBannerImage,primaryColor:e.primaryColor,userFlairs:{enabled:e.userFlairEnabledInSr??!1,usersCanAssign:e.canAssignUserFlair??!1,userFlairBackgroundColor:e.userFlairBackgroundColor,userFlairTextColor:e.userFlairTextColor},postFlairs:{enabled:e.linkFlairEnabled??!1,usersCanAssign:e.canAssignLinkFlair??!1},url:new URL(w(this,gs,"f"),"https://www.reddit.com").toString()},"f"),De(this,D,t,"f")}get id(){return w(this,ps,"f")}get name(){return w(this,x,"f")}get createdAt(){return w(this,Ho,"f")}get type(){return w(this,jo,"f")}get title(){return w(this,Go,"f")}get description(){return w(this,Vo,"f")}get language(){return w(this,$o,"f")}get numberOfSubscribers(){return w(this,zo,"f")}get numberOfActiveUsers(){return w(this,Ko,"f")}get nsfw(){return w(this,qo,"f")}get settings(){return w(this,Jo,"f")}get userFlairsEnabled(){return this.settings.userFlairs.enabled}get postFlairsEnabled(){return this.settings.postFlairs.enabled}get usersCanAssignUserFlairs(){return this.settings.userFlairs.usersCanAssign}get usersCanAssignPostFlairs(){return this.settings.postFlairs.usersCanAssign}get url(){return this.settings.url}get permalink(){return w(this,gs,"f")}toJSON(){return{id:this.id,name:this.name,createdAt:this.createdAt,type:this.type,title:this.title,description:this.description,language:this.language,nsfw:this.nsfw,numberOfSubscribers:this.numberOfSubscribers,numberOfActiveUsers:this.numberOfActiveUsers,settings:this.settings}}async submitPost(e){let t={...e,subredditName:w(this,x,"f")};return X.submit(t,w(this,D,"f"))}getControversialPosts(e={}){if(!w(this,x,"f"))throw new Error("subreddit missing displayName - it might not have been fetched");return X.getControversialPosts({...e,subredditName:w(this,x,"f")},w(this,D,"f"))}getTopPosts(e={}){if(!w(this,x,"f"))throw new Error("subreddit missing displayName - it might not have been fetched");return X.getTopPosts({...e,subredditName:w(this,x,"f")},w(this,D,"f"))}getApprovedUsers(e={}){return C.getSubredditUsersByType({type:"contributors",subredditName:w(this,x,"f"),...e},w(this,D,"f"))}approveUser(e){return C.createRelationship({username:e,subredditName:w(this,x,"f"),type:"contributor"},w(this,D,"f"))}removeUser(e){return C.removeRelationship({username:e,subredditName:w(this,x,"f"),type:"contributor"},w(this,D,"f"))}getWikiContributors(e={}){return C.getSubredditUsersByType({type:"wikicontributors",subredditName:w(this,x,"f"),...e},w(this,D,"f"))}addWikiContributor(e){return C.createRelationship({username:e,subredditName:w(this,x,"f"),type:"wikicontributor"},w(this,D,"f"))}removeWikiContributor(e){return C.removeRelationship({username:e,subredditName:w(this,x,"f"),type:"wikicontributor"},w(this,D,"f"))}getBannedUsers(e={}){return C.getSubredditUsersByType({type:"banned",subredditName:w(this,x,"f"),...e},w(this,D,"f"))}banUser(e){return C.createRelationship({username:e.username,subredditName:w(this,x,"f"),type:"banned",banReason:e.reason,banMessage:e.message,note:e.note,duration:e.duration,banContext:e.context},w(this,D,"f"))}unbanUser(e){return C.removeRelationship({username:e,subredditName:w(this,x,"f"),type:"banned"},w(this,D,"f"))}getBannedWikiContributors(e={}){return C.getSubredditUsersByType({type:"wikibanned",subredditName:w(this,x,"f"),...e},w(this,D,"f"))}banWikiContributor(e){return C.createRelationship({username:e.username,subredditName:w(this,x,"f"),type:"wikibanned",banReason:e.reason,note:e.note,duration:e.duration},w(this,D,"f"))}unbanWikiContributor(e){return C.removeRelationship({username:e,subredditName:w(this,x,"f"),type:"wikibanned"},w(this,D,"f"))}getModerators(e={}){return C.getSubredditUsersByType({type:"moderators",subredditName:w(this,x,"f"),...e},w(this,D,"f"))}inviteModerator(e,t){return C.createRelationship({type:"moderator_invite",subredditName:w(this,x,"f"),username:e,permissions:t??[]},w(this,D,"f"))}revokeModeratorInvite(e){return C.removeRelationship({username:e,subredditName:w(this,x,"f"),type:"moderator_invite"},w(this,D,"f"))}removeModerator(e){return C.removeRelationship({type:"moderator",subredditName:w(this,x,"f"),username:e},w(this,D,"f"))}setModeratorPermissions(e,t){return C.setModeratorPermissions(e,w(this,x,"f"),t,w(this,D,"f"))}getMutedUsers(e={}){return C.getSubredditUsersByType({type:"muted",subredditName:w(this,x,"f"),...e},w(this,D,"f"))}muteUser(e,t){return C.createRelationship({username:e,subredditName:w(this,x,"f"),type:"muted",note:t},w(this,D,"f"))}unmuteUser(e){return C.removeRelationship({username:e,subredditName:w(this,x,"f"),type:"muted"},w(this,D,"f"))}getModerationLog(e){return tn({subredditName:w(this,x,"f"),...e},w(this,D,"f"))}getUserFlairTemplates(){return ye.getUserFlairTemplates(w(this,x,"f"),w(this,D,"f"))}getPostFlairTemplates(){return ye.getPostFlairTemplates(w(this,x,"f"),w(this,D,"f"))}createPostFlairTemplate(e){return ye.createPostFlairTemplate({subredditName:w(this,x,"f"),...e},w(this,D,"f"))}createUserFlairTemplate(e){return ye.createUserFlairTemplate({subredditName:w(this,x,"f"),...e},w(this,D,"f"))}async getUserFlair(e){if(e?.usernames!==void 0)return{users:await Promise.all(e.usernames.map(async i=>{let s=await Ee.getUserFlairBySubreddit({subreddit:w(this,x,"f"),name:i},w(this,D,"f"));return Ki(s.users[0])}))};{let t=await Ee.getUserFlairBySubreddit({...e,subreddit:w(this,x,"f")},w(this,D,"f"));return{next:t.next,prev:t.prev,users:t.users.map(i=>Ki(i))}}}getModQueue(e={type:"all"}){return r.aboutLocation({...e,location:Re.Modqueue,subreddit:w(this,x,"f")},w(this,D,"f"))}getReports(e={type:"all"}){return r.aboutLocation({...e,location:Re.Reports,subreddit:w(this,x,"f")},w(this,D,"f"))}getSpam(e={type:"all"}){return r.aboutLocation({...e,location:Re.Spam,subreddit:w(this,x,"f")},w(this,D,"f"))}getUnmoderated(e={type:"all"}){return r.aboutLocation({...e,location:Re.Unmoderated,subreddit:w(this,x,"f")},w(this,D,"f"))}getEdited(e={type:"all"}){return r.aboutLocation({...e,location:Re.Edited,subreddit:w(this,x,"f")},w(this,D,"f"))}static aboutLocation(e,t){let i=a.redditAPIPlugins.Moderation,s;switch(e.type){case"post":s="links";break;case"comment":s="comments";break;default:s=void 0}return new J({...e,fetch:async n=>{let o=await i.AboutLocation({...n,...e,only:s},t);return Ph(o,t)}})}getCommentsAndPostsByIds(e){let t=a.redditAPIPlugins.LinksAndComments;return new J({fetch:async()=>{let i=await t.Info({thingIds:e,subreddits:[w(this,ps,"f")]},w(this,D,"f"));return Ph(i,w(this,D,"f"))}})}static async addRemovalReason(e,t,i,s){return(await a.redditAPIPlugins.Subreddits.SubredditAddRemovalReason({title:t,message:i,subreddit:e},s)).id}static async getRemovalReasons(e,t){let s=await a.redditAPIPlugins.Subreddits.SubredditGetRemovalReasons({subreddit:e},t);return s.order.map(n=>({...s.data[n]}))}static async getFromMetadata(e){u(e);let t=e?.[A.SubredditName]?.values[0];if(t)return r.getByName(t,e);let i=e?.[A.Subreddit]?.values[0];return u(i),r.getById(se(i),e)}static async getById(e,t){let i=await Sa(e,t);if(i)return r.getByName(i,t)}static async getByName(e,t){let s=await a.redditAPIPlugins.Subreddits.SubredditAbout({subreddit:e},t);if(!s?.data)throw new Error("not found");return new r(s.data,t)}};ps=new WeakMap,x=new WeakMap,Ho=new WeakMap,jo=new WeakMap,Go=new WeakMap,Vo=new WeakMap,$o=new WeakMap,zo=new WeakMap,Ko=new WeakMap,qo=new WeakMap,Jo=new WeakMap,gs=new WeakMap,D=new WeakMap;async function Sd(r,e){let n=(await ce.query("GetSubredditInfoById","315a9b75c22a017d526afdf2d274616946156451aacfd56dfb91e7ad3f7a2fde",{id:r},e)).data?.subredditInfoById;if(!n)throw new Error("subreddit info not found");return n.type&&(n.type=jc(n.type)),n}async function xd(r,e){let n=(await ce.query("GetSubredditInfoByName","4aa69726c7e3f5d33ab2bee22b3d74fce645824fddd5ea3ec6dfe30bdb4295cb",{name:r},e)).data?.subredditInfoByName;if(!n)throw new Error("subreddit info not found");return n.type&&(n.type=jc(n.type)),n}async function Rd(r,e){let n=(await ce.query("GetSubredditLeaderboard","18ead70c46b6446d45ecd8b679b16d9a929a933d6ef25d8262a459cb18b72848",{id:r},e)).data?.subredditInfoById?.leaderboard;if(!n)throw new Error("subreddit leaderboard not found");if(!n.summary)throw new Error("subreddit leaderboard summary not found");return{id:n.id,summary:n.summary}}async function Md(r,e){let n=(await ce.query("GetSubredditStyles","d491d17ea8858f563ea578b26b9595d64adecf4bf34557d567c7e53c470f5f22",{id:r},e)).data?.subredditInfoById?.styles;if(!n)throw new Error("subreddit styles not found");return n}function jc(r){let e=r?.toLowerCase();if(e==="public"||e==="private"||e==="restricted"||e==="employees_only"||e==="gold_only"||e==="gold_restricted"||e==="archived"||e==="user")return e;throw new Error(`invalid subreddit type: ${r}`)}function Tp(r){if(r==="any"||r==="link"||r==="self")return r;throw new Error(`invalid allowed post type: ${r}`)}function Sp(r){if(r==="animated"||r==="giphy"||r==="static"||r==="expression")return r;throw new Error(`invalid comment media type: ${r}`)}function Ph(r,e){let i=(r.data?.children??[]).map(o=>{let c=s(o);if(c!=null)return c;let l=n(o);return l??null}).filter(Boolean);return{after:r.data?.after,before:r.data?.before,children:i};function s(o){try{return new X(o.data,e)}catch{return null}}function n(o){try{return new ne(o.data,e)}catch{return null}}}async function Sa(r,e){return(await a.redditAPIPlugins.LinksAndComments.Info({thingIds:[r],subreddits:[]},e)).data?.children[0]?.data?.displayName}async function Nd(r,e){return Ih("GetVaultContactByAddress","3e2f7966a5c120e64fd2795d06a46595c52d988185be98d3ed71c3f81ae80d2e",{provider:"ethereum",address:r},e)}async function Dd(r,e){return Ih("GetVaultContactByUserId","a854ddc19d0e22c4f36ed917fdbd568f299f3571427e393aee5e2972080fffe9",{provider:"ethereum",userId:r},e)}async function Ih(r,e,t,i){let n=(await ce.query(r,e,t,i))?.data?.vault?.contact;return{provider:n?.provider,userId:we(n?.userId),address:n?.address,createdAt:n?.createdAt,isActive:n?.isActive}}import{CommunityListWidget_CommunityData as xp,GetWidgetsResponse_WidgetItem as Pe}from"@devvit/protos";var Z=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Q=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Zo,Qo,Xo,Yo,ea,ta,ra,ia,sa,na,oa,aa,ca,da,la,ua,ha,fa,ma,pa,ga,wa,ya,ba,fe=class r{constructor(e,t,i){Zo.set(this,void 0),Qo.set(this,void 0),Xo.set(this,void 0),Yo.set(this,void 0),ae(this),Z(this,Zo,e.id,"f"),Z(this,Qo,e.shortName,"f"),Z(this,Xo,t,"f"),Z(this,Yo,i,"f")}get id(){return Q(this,Zo,"f")}get name(){return Q(this,Qo,"f")}get subredditName(){return Q(this,Xo,"f")}toJSON(){return{id:this.id,name:this.name,subredditName:this.subredditName}}delete(){return r.delete(this.subredditName,this.id,Q(this,Yo,"f"))}static async getWidgets(e,t){let s=await a.redditAPIPlugins.Widgets.GetWidgets({subreddit:e},t);u(s.layout,"Failed to load widgets for subreddit");let n=s.items,o=[];for(let c of s.layout.sidebar?.order??[]){let l=n[c];switch(l?.kind){case"image":o.push(new ws(l,e,t));break;case"calendar":o.push(new ys(l,e,t));break;case"textarea":o.push(new bs(l,e,t));break;case"button":o.push(new vs(l,e,t));break;case"community-list":o.push(new ks(l,e,t));break;case"post-flair":o.push(new _s(l,e,t));break;case"custom":o.push(new Es(l,e,t));break;case"subreddit-rules":{let f=await a.redditAPIPlugins.Subreddits.SubredditAboutRules({subreddit:e},t);o.push(new Gc(f,l,e,t));break}default:throw new Error(`Unknown widget type: ${l.kind}`)}}return o}static async delete(e,t,i){await a.redditAPIPlugins.Widgets.DeleteWidget({subreddit:e,id:t},i)}static async reorder(e,t,i){await a.redditAPIPlugins.Widgets.OrderWidgets({subreddit:e,order:t},i)}static async add(e,t){switch(e.styles={backgroundColor:e.styles?.backgroundColor??"",headerColor:e.styles?.headerColor??""},e?.type){case"image":return ws.create(e,t);case"calendar":return ys.create(e,t);case"textarea":return bs.create(e,t);case"button":return vs.create(e,t);case"community-list":return ks.create(e,t);case"post-flair":return _s.create(e,t);case"custom":return Es.create(e,t);default:throw new Error(`Unknown widget type: ${e}`)}}static async patch(e,t){switch(e.styles={backgroundColor:e.styles?.backgroundColor??"",headerColor:e.styles?.headerColor??""},e?.type){case"image":return ws.update(e,t);case"calendar":return ys.update(e,t);case"textarea":return bs.update(e,t);case"button":return vs.update(e,t);case"community-list":return ks.update(e,t);case"post-flair":return _s.update(e,t);case"custom":return Es.update(e,t);default:throw new Error(`Unknown widget type: ${e}`)}}};Zo=new WeakMap,Qo=new WeakMap,Xo=new WeakMap,Yo=new WeakMap;var ws=class r extends fe{constructor(e,t,i){super(e,t,i),ea.set(this,void 0),Z(this,ea,e.data.map(s=>(u(s.url,"Image widget data is missing url"),u(s.height,"Image widget data is missing height"),u(s.width,"Image widget data is missing width"),{url:s.url,height:s.height,width:s.width,linkUrl:s.linkUrl??""})),"f")}get images(){return Q(this,ea,"f")}toJSON(){return{...super.toJSON(),images:this.images}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddImageWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdateImageWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};ea=new WeakMap;var ys=class r extends fe{constructor(e,t,i){super(e,t,i),ta.set(this,void 0),ra.set(this,void 0),ia.set(this,void 0),u(e.googleCalendarId,"Calendar widget data is missing googleCalendarId"),u(e.configuration,"Calendar widget data is missing configuration"),u(e.styles,"Calendar widget data is missing styles"),Z(this,ta,e.googleCalendarId,"f"),Z(this,ra,e.configuration,"f"),Z(this,ia,e.styles,"f")}get googleCalendarId(){return Q(this,ta,"f")}get configuration(){return Q(this,ra,"f")}get styles(){return Q(this,ia,"f")}toJSON(){return{...super.toJSON(),googleCalendarId:this.googleCalendarId,configuration:this.configuration,styles:this.styles}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddCalendarWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdateCalendarWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};ta=new WeakMap,ra=new WeakMap,ia=new WeakMap;var bs=class r extends fe{constructor(e,t,i){super(e,t,i),sa.set(this,void 0),na.set(this,void 0),u(e.text,"Textarea widget data is missing text"),u(e.styles,"Textarea widget data is missing styles"),Z(this,sa,e.text,"f"),Z(this,na,e.styles,"f")}get text(){return Q(this,sa,"f")}get styles(){return Q(this,na,"f")}toJSON(){return{...super.toJSON(),text:this.text,styles:this.styles}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddTextAreaWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdateTextAreaWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};sa=new WeakMap,na=new WeakMap;var vs=class r extends fe{constructor(e,t,i){super(e,t,i),oa.set(this,void 0),aa.set(this,void 0),ca.set(this,void 0),u(e.styles,"Button widget data is missing styles"),Z(this,oa,e.buttons,"f"),Z(this,aa,e.description??"","f"),Z(this,ca,e.styles,"f")}get buttons(){return Q(this,oa,"f")}get description(){return Q(this,aa,"f")}get styles(){return Q(this,ca,"f")}toJSON(){return{...super.toJSON(),buttons:this.buttons,description:this.description,styles:this.styles}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddButtonWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdateButtonWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};oa=new WeakMap,aa=new WeakMap,ca=new WeakMap;var ks=class r extends fe{constructor(e,t,i){super(e,t,i),da.set(this,void 0),la.set(this,void 0),Z(this,da,e.data.map(s=>xp.fromJSON(s)),"f"),u(e.styles,"Community list widget data is missing styles"),Z(this,la,e.styles,"f")}get communities(){return Q(this,da,"f")}get styles(){return Q(this,la,"f")}toJSON(){return{...super.toJSON(),communities:this.communities,styles:this.styles}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddCommunityListWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdateCommunityListWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};da=new WeakMap,la=new WeakMap;var _s=class r extends fe{constructor(e,t,i){if(super(e,t,i),ua.set(this,void 0),ha.set(this,void 0),fa.set(this,void 0),u(e.styles,"Post flair widget data is missing styles"),Z(this,ua,e.styles,"f"),Z(this,ha,e.order.map(s=>e.templates[s]),"f"),!(e.display&&e.display==="list"||e.display==="cloud"))throw new Error("Post flair widget data is missing display type");Z(this,fa,e.display,"f")}get styles(){return Q(this,ua,"f")}get templates(){return Q(this,ha,"f")}get display(){return Q(this,fa,"f")}toJSON(){return{...super.toJSON(),styles:this.styles,templates:this.templates,display:this.display}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddPostFlairWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdatePostFlairWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};ua=new WeakMap,ha=new WeakMap,fa=new WeakMap;var Es=class r extends fe{constructor(e,t,i){super(e,t,i),ma.set(this,void 0),pa.set(this,void 0),ga.set(this,void 0),wa.set(this,void 0),ya.set(this,void 0),u(e.stylesheetUrl,"Custom widget data is missing stylesheetUrl"),u(e.height,"Custom widget data is missing height"),u(e.css,"Custom widget data is missing css"),Z(this,ma,e.imageData??[],"f"),Z(this,pa,e.text??"","f"),Z(this,ga,e.stylesheetUrl,"f"),Z(this,wa,e.height,"f"),Z(this,ya,e.css,"f")}get images(){return Q(this,ma,"f")}get text(){return Q(this,pa,"f")}get stylesheetUrl(){return Q(this,ga,"f")}get height(){return Q(this,wa,"f")}get css(){return Q(this,ya,"f")}toJSON(){return{...super.toJSON(),images:this.images,text:this.text,stylesheetUrl:this.stylesheetUrl,height:this.height,css:this.css}}static async create(e,t){let s=await a.redditAPIPlugins.Widgets.AddCustomWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}static async update(e,t){let s=await a.redditAPIPlugins.Widgets.UpdateCustomWidget(e,t);return new r(Pe.fromJSON(s),e.subreddit,t)}};ma=new WeakMap,pa=new WeakMap,ga=new WeakMap,wa=new WeakMap,ya=new WeakMap;var Gc=class extends fe{constructor(e,t,i,s){super(t,i,s),ba.set(this,void 0);let n=e.rules.map(({description:o,priority:c,shortName:l,violationReason:f})=>(u(o,"Subreddit rule is missing description"),u(c,"Subreddit rule is missing priority"),u(l,"Subreddit rule is missing shortName"),u(f,"Subreddit rule is missing violationReason"),{description:o,priority:c,shortName:l,violationReason:f}));Z(this,ba,n,"f")}get rules(){return Q(this,ba,"f")}toJSON(){return{...super.toJSON(),rules:this.rules}}};ba=new WeakMap;var le=function(r,e,t,i,s){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},F=function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},je,Ge,Cs,Fs,As,Ps,Is,Ts,rt,Ss,xs,Rs,Ms,Ns,Ds,Bs,Us,Os,Th;(function(r){r[r.SUBREDDIT_PERMISSIONS=0]="SUBREDDIT_PERMISSIONS",r[r.APPROVED_CONTRIBUTORS_ONLY=1]="APPROVED_CONTRIBUTORS_ONLY",r[r.MODS_ONLY=2]="MODS_ONLY"})(Th||(Th={}));var Sh="WikiPageRevision_",xe=class r{constructor(e,t,i,s){je.set(this,void 0),Ge.set(this,void 0),Cs.set(this,void 0),Fs.set(this,void 0),As.set(this,void 0),Ps.set(this,void 0),Is.set(this,void 0),Ts.set(this,void 0),rt.set(this,void 0),ae(this),le(this,je,e,"f"),le(this,Ge,t,"f"),le(this,Cs,i.contentMd,"f"),le(this,Fs,i.contentHtml,"f"),le(this,As,i.revisionId,"f"),le(this,Ps,new Date(i.revisionDate*1e3),"f"),le(this,Is,i.reason??"","f"),le(this,Ts,i.revisionBy?.data?new C(i.revisionBy.data,s):void 0,"f"),le(this,rt,s,"f")}get name(){return F(this,je,"f")}get subredditName(){return F(this,Ge,"f")}get content(){return F(this,Cs,"f")}get contentHtml(){return F(this,Fs,"f")}get revisionId(){return F(this,As,"f")}get revisionDate(){return F(this,Ps,"f")}get revisionReason(){return F(this,Is,"f")}get revisionAuthor(){return F(this,Ts,"f")}toJSON(){return{name:F(this,je,"f"),subredditName:F(this,Ge,"f"),content:F(this,Cs,"f"),contentHtml:F(this,Fs,"f"),revisionId:F(this,As,"f"),revisionDate:F(this,Ps,"f"),revisionReason:F(this,Is,"f"),revisionAuthor:F(this,Ts,"f")?.toJSON()}}async update(e,t){return r.updatePage({subredditName:F(this,Ge,"f"),page:F(this,je,"f"),content:e,reason:t},F(this,rt,"f"))}async getRevisions(e){return r.getPageRevisions({subredditName:F(this,Ge,"f"),page:F(this,je,"f"),...e},F(this,rt,"f"))}async revertTo(e){return r.revertPage(F(this,Ge,"f"),F(this,je,"f"),e,F(this,rt,"f"))}async getSettings(){return r.getPageSettings(F(this,Ge,"f"),F(this,je,"f"),F(this,rt,"f"))}async updateSettings(e){return r.updatePageSettings({subredditName:F(this,Ge,"f"),page:F(this,je,"f"),listed:e.listed,permLevel:e.permLevel},F(this,rt,"f"))}async addEditor(e){return r.addEditor(F(this,Ge,"f"),F(this,je,"f"),e,F(this,rt,"f"))}async removeEditor(e){return r.removeEditor(F(this,Ge,"f"),F(this,je,"f"),e,F(this,rt,"f"))}static async getPage(e,t,i,s){let o=await a.redditAPIPlugins.Wiki.GetWikiPage({subreddit:e,page:t,revisionId:i},s);return u(o.data,"Failed to get wiki page"),new r(t,e,o.data,s)}static async getPages(e,t){return(await a.redditAPIPlugins.Wiki.GetWikiPages({subreddit:e},t)).data||[]}static async createPage(e,t){return r.updatePage(e,t)}static async updatePage(e,t){return await a.redditAPIPlugins.Wiki.EditWikiPage({subreddit:e.subredditName,page:e.page,content:e.content,reason:e.reason??""},t),r.getPage(e.subredditName,e.page,void 0,t)}static getPageRevisions(e,t){let i=a.redditAPIPlugins.Wiki,s=xh(e.after),n=xh(e.before);return new J({hasMore:!0,after:s,before:n,limit:e.limit,pageSize:e.pageSize,async fetch(o){let c=await i.GetWikiPageRevisions({subreddit:e.subredditName,page:e.page??"",limit:o.limit,after:o.after,before:o.before},t);return Rp(c,t)}})}static async revertPage(e,t,i,s){await a.redditAPIPlugins.Wiki.RevertWikiPage({subreddit:e,page:t,revision:i},s)}static async getPageSettings(e,t,i){let n=await a.redditAPIPlugins.Wiki.GetWikiPageSettings({subreddit:e,page:t},i);return u(n.data,"Failed to get wiki page settings"),new va(n.data,i)}static async updatePageSettings(e,t){let s=await a.redditAPIPlugins.Wiki.UpdateWikiPageSettings({subreddit:e.subredditName,page:e.page,listed:e.listed?"on":"",permlevel:e.permLevel},t);return u(s.data,"Failed to update wiki page settings"),new va(s.data,t)}static async addEditor(e,t,i,s){await a.redditAPIPlugins.Wiki.AllowEditor({act:"add",subreddit:e,page:t,username:i},s)}static async removeEditor(e,t,i,s){await a.redditAPIPlugins.Wiki.AllowEditor({act:"del",subreddit:e,page:t,username:i},s)}};je=new WeakMap,Ge=new WeakMap,Cs=new WeakMap,Fs=new WeakMap,As=new WeakMap,Ps=new WeakMap,Is=new WeakMap,Ts=new WeakMap,rt=new WeakMap;var Vc=class{constructor(e,t){Ss.set(this,void 0),xs.set(this,void 0),Rs.set(this,void 0),Ms.set(this,void 0),Ns.set(this,void 0),Ds.set(this,void 0),le(this,Ss,e.id,"f"),le(this,xs,e.page,"f"),le(this,Rs,new Date(e.timestamp),"f"),u(e.author?.data,"Wiki page revision author details are missing"),le(this,Ms,new C(e.author.data,t),"f"),le(this,Ns,e.reason??"","f"),le(this,Ds,e.revisionHidden??!1,"f")}get id(){return F(this,Ss,"f")}get page(){return F(this,xs,"f")}get date(){return F(this,Rs,"f")}get author(){return F(this,Ms,"f")}get reason(){return F(this,Ns,"f")}get hidden(){return F(this,Ds,"f")}toJSON(){return{id:F(this,Ss,"f"),page:F(this,xs,"f"),date:F(this,Rs,"f"),author:F(this,Ms,"f").toJSON(),reason:F(this,Ns,"f"),hidden:F(this,Ds,"f")}}};Ss=new WeakMap,xs=new WeakMap,Rs=new WeakMap,Ms=new WeakMap,Ns=new WeakMap,Ds=new WeakMap;var va=class{constructor(e,t){Bs.set(this,void 0),Us.set(this,void 0),Os.set(this,void 0),le(this,Bs,e.listed,"f"),le(this,Us,e.permLevel,"f"),le(this,Os,e.editors.map(i=>(u(i.data,"Wiki page editor details are missing"),new C(i.data,t))),"f")}get listed(){return F(this,Bs,"f")}get permLevel(){return F(this,Us,"f")}get editors(){return F(this,Os,"f")}toJSON(){return{listed:F(this,Bs,"f"),permLevel:F(this,Us,"f"),editors:F(this,Os,"f").map(e=>e.toJSON())}}};Bs=new WeakMap,Us=new WeakMap,Os=new WeakMap;function Rp(r,e){return u(r.data?.children,"Wiki page revision listing is missing children"),{children:r.data.children.map(i=>new Vc(i,e)),before:r.data.before,after:r.data.after}}function xh(r){if(r)return r.startsWith(Sh)?r:`${Sh}${r}`}import{EffectType as xE}from"@devvit/protos";import{WebViewVisibility as ME}from"@devvit/protos";var Mp,Np,Dp,Bp,Up,Op,Lp;Mp=new WeakMap,Np=new WeakMap,Dp=new WeakMap,Bp=new WeakMap,Up=new WeakMap,Op=new WeakMap,Lp=new WeakMap;import{OrderStatus as Rt}from"@devvit/protos/json/devvit/payments/v1alpha/order.js";var Wp="devvit-";function Hp(r){return r.startsWith(Wp)}function ka(r){return Object.fromEntries(Object.entries(r).filter(([e])=>!Hp(e)))}import{AccountingType as xt}from"@devvit/protos/json/devvit/payments/v1alpha/product.js";var ze;(function(r){r.INSTANT="INSTANT",r.DURABLE="DURABLE",r.CONSUMABLE="CONSUMABLE",r.VALID_FOR_1D="VALID_FOR_1D",r.VALID_FOR_7D="VALID_FOR_7D",r.VALID_FOR_30D="VALID_FOR_30D",r.VALID_FOR_1Y="VALID_FOR_1Y",r.UNRECOGNIZED="UNRECOGNIZED"})(ze||(ze={}));var jp={[ze.INSTANT]:xt.ACCOUNTING_TYPE_INSTANT,[ze.DURABLE]:xt.ACCOUNTING_TYPE_DURABLE,[ze.CONSUMABLE]:xt.ACCOUNTING_TYPE_CONSUMABLE,[ze.VALID_FOR_1D]:xt.ACCOUNTING_TYPE_VALID_FOR_1D,[ze.VALID_FOR_7D]:xt.ACCOUNTING_TYPE_VALID_FOR_7D,[ze.VALID_FOR_30D]:xt.ACCOUNTING_TYPE_VALID_FOR_30D,[ze.VALID_FOR_1Y]:xt.ACCOUNTING_TYPE_VALID_FOR_1Y,[ze.UNRECOGNIZED]:xt.UNRECOGNIZED};function Gp(r){let e=Object.entries(jp).find(([t,i])=>i===r);return e?e[0]:ze.UNRECOGNIZED}function _a(r){u(r.price,"Product price is null or undefined");let e=r.images.icon;return{sku:r.sku,price:r.price.amount,accountingType:Gp(r.accountingType),displayName:r.name,description:r.description,metadata:ka(r.productMetadata),...e?{images:{icon:e}}:{}}}var ut;(function(r){r.NEW="NEW",r.CREATED="CREATED",r.PAID="PAID",r.DELIVERED="DELIVERED",r.CANCELED="CANCELED",r.REVERTED="REVERTED",r.UNRECOGNIZED="UNRECOGNIZED"})(ut||(ut={}));function Vp(r){switch(r){case Rt.ORDER_STATUS_NEW:return ut.NEW;case Rt.ORDER_STATUS_CREATED:return ut.CREATED;case Rt.ORDER_STATUS_PAID:return ut.PAID;case Rt.ORDER_STATUS_DELIVERED:return ut.DELIVERED;case Rt.ORDER_STATUS_CANCELED:return ut.CANCELED;case Rt.ORDER_STATUS_REVERTED:return ut.REVERTED;case Rt.ORDER_STATUS_UNSPECIFIED:case Rt.UNRECOGNIZED:return ut.UNRECOGNIZED}}function Ea(r){return{id:r.id,status:Vp(r.status),createdAt:r.createdAt??null,updatedAt:r.updatedAt??null,products:r.products.map(_a),metadata:ka(r.metadata)}}import{PaymentsServiceDefinition as $p}from"@devvit/protos/payments.js";var Rh={location:"post",label:"Get Payments Help",postFilter:"currentApp",onPress:async(r,e)=>{let t=new URL("https://support.reddithelp.com/hc/en-us/requests/new?ticket_form_id=29770197409428&tf_29764567374740=devvit_product_not_working"),i=await e.reddit.getCurrentUsername();i&&t.searchParams.append("tf_360026362751",i);let s=e.postId;if(s){let n=s.replace("t3_","");if(n){let o=`https://www.reddit.com/r/${e.subredditName}/comments/${n}`;t.searchParams.append("tf_29770117862932",o)}}t.searchParams.append("tf_subject",`[${e.appName} v${e.appVersion}] Payments Help`),e.ui.navigateTo(t.toString())}};var Ca=a.use($p);a.addMenuItem(Rh);async function Mh(r={}){let e={sku:"",buyer:"",metadata:{},status:0,...r,limit:r.limit||100,cursor:r.nextPageToken||""},t=await Ca.GetOrders(e),i={orders:t.orders.map(Ea)};return t.pageInfo?.hasNextPage&&(i.nextPage=t.pageInfo?.endCursor),i}function zp(r){return{...r,createdAt:r.createdAt?.toISOString()??null,updatedAt:r.updatedAt?.toISOString()??null}}function Kp(r){return{...r,createdAt:r.createdAt?new Date(r.createdAt):null,updatedAt:r.updatedAt?new Date(r.updatedAt):null}}function qp(r,e={}){let[t,i]=Xt(e.nextPageToken??""),{loading:s,data:n,error:o}=_i(async()=>{let l=await Mh({...e,nextPageToken:t});return{orders:l.orders.map(zp),nextPageToken:l.nextPage||""}},{depends:t}),c={orders:(n?.orders??[]).map(Kp)};return n?.nextPageToken&&(c=Object.assign(c,{nextPage:async()=>{i(n?.nextPageToken)}})),s?{...c,loading:!0,error:null}:o?{...c,loading:s,error:o}:{...c,loading:s,error:null}}import{EffectType as Jp}from"@devvit/protos/types/devvit/ui/effects/v1alpha/effect.js";var ei,Ls,Ws,ti,$c=class{constructor(e,t){ri(this,ei);ri(this,Ls);ri(this,Ws);this.state={};ri(this,ti,e=>{ht(this,Ws)&&console.debug(`[payments] ${e}`)});js(this,Ws,!!t.context._devvitContext?.debug.payments),js(this,ei,t.context),js(this,Ls,e),this.hookId=t.hookId,ht(this,ti).call(this,`usePurchase hook created (${this.hookId})`)}async onUIEvent(e){if(e.orderResult&&e.hook===this.hookId){ht(this,ti).call(this,`Received an order result: hookId: ${this.hookId}; Status: ${e.orderResult.status}; Order ID: ${e.orderResult.orderId}; Error Code: ${e.orderResult.errorCode}; Error Message: ${e.orderResult.errorMessage}`);let{status:t,errorCode:i,errorMessage:s,order:n,orderId:o}=e.orderResult;if(!n)throw new Error("Invalid response: missing original order");await ht(this,Ls).call(this,{status:ed(t),errorCode:i,errorMessage:s,orderId:o,sku:n.skus[0],metadata:n.metadata})}}purchase(e,t={}){if(!e.trim())throw new Error("Invalid purchase; no SKU provided");ht(this,ti).call(this,`Requesting a purchase for product: ${e}`);let i={[A.Post]:ht(this,ei)._devvitContext?.postId??""};ht(this,ei).emitEffect("createOrder",{type:Jp.EFFECT_CREATE_ORDER,createOrder:{id:this.hookId,skus:[e],metadata:{...t,...i}}})}};ei=new WeakMap,Ls=new WeakMap,Ws=new WeakMap,ti=new WeakMap;function Zp(r){return Ce({namespace:"payments",initializer:e=>new $c(r,e)})}async function Nh(r={}){let e={skus:r.skus||[],metadata:r.metadata||{}};return(await Ca.GetProducts(e)).products.map(_a)}function Qp(r,e={}){let[t,i]=Xt(0),{loading:s,data:n,error:o}=_i(async()=>Nh(e),{depends:t}),f={products:n??[],refetch:async()=>{i(v=>~v)}};return s?{...f,loading:!0,error:null}:o!=null?{...f,loading:!1,error:o}:{...f,loading:!1,error:null}}import{PaymentProcessorDefinition as Xp}from"@devvit/protos/payments.js";function Yp(r){a.provide(Xp),Object.assign(a.prototype,eg(r))}function eg(r){return{async FulfillOrder(e,t){if(e.order==null||e.order.products.length===0)return{};let i=Object.assign(be({metadata:t}),ue(t,e.order.metadata[A.Post])),s=Dh(e.order),n=await r.fulfillOrder(s,i);return!n||n.success?{acknowledged:!0}:{rejectionReason:n.reason}},async RefundOrder(e,t){if(e.order==null||!r.refundOrder)return{};let i=Object.assign(be({metadata:t}),ue(t)),s=Dh(e.order);return await r.refundOrder(s,i),{}}}}function Dh(r){let e=Ea(r);if(e.products.length>1)throw new Error("Multi-product orders not supported");if(e.products.length===0)throw new Error("No products in order");return e}export{Yc as OrderResultStatus,Yp as addPaymentHandler,Mh as getOrders,Nh as getProducts,qp as useOrders,Zp as usePayments,Qp as useProducts};
/*! Bundled license information:

shallow-clone/index.js:
  (*!
   * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
   *
   * Copyright (c) 2015-present, Jon Schlinkert.
   * Released under the MIT License.
   *)

isobject/index.js:
  (*!
   * isobject <https://github.com/jonschlinkert/isobject>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   *)

is-plain-object/index.js:
  (*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
//# sourceMappingURL=payments.min.js.map
